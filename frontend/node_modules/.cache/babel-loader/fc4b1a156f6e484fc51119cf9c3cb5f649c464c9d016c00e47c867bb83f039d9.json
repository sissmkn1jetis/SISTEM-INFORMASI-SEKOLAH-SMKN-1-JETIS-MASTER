{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.unshift.js\";\n/*!\r\n * HTML5 export buttons for Buttons and DataTables.\r\n * 2016 SpryMedia Ltd - datatables.net/license\r\n *\r\n * FileSaver.js (1.3.3) - MIT license\r\n * Copyright © 2016 Eli Grey - http://eligrey.com\r\n */\n\nimport $ from 'jquery';\nimport DataTable from 'datatables.net';\nimport Buttons from 'datatables.net-buttons';\n\n// Allow the constructor to pass in JSZip and PDFMake from external requires.\n// Otherwise, use globally defined variables, if they are available.\nvar useJszip;\nvar usePdfmake;\nfunction _jsZip() {\n  return useJszip || window.JSZip;\n}\nfunction _pdfMake() {\n  return usePdfmake || window.pdfMake;\n}\nDataTable.Buttons.pdfMake = function (_) {\n  if (!_) {\n    return _pdfMake();\n  }\n  usePdfmake = _;\n};\nDataTable.Buttons.jszip = function (_) {\n  if (!_) {\n    return _jsZip();\n  }\n  useJszip = _;\n};\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * FileSaver.js dependency\r\n */\n\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\nvar _saveAs = function (view) {\n  \"use strict\";\n\n  // IE <10 is explicitly unsupported\n  if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n    return;\n  }\n  var doc = view.document\n    // only get URL when necessary in case Blob.js hasn't overridden it yet\n    ,\n    get_URL = function () {\n      return view.URL || view.webkitURL || view;\n    },\n    save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\"),\n    can_use_save_link = (\"download\" in save_link),\n    click = function (node) {\n      var event = new MouseEvent(\"click\");\n      node.dispatchEvent(event);\n    },\n    is_safari = /constructor/i.test(view.HTMLElement) || view.safari,\n    is_chrome_ios = /CriOS\\/[\\d]+/.test(navigator.userAgent),\n    throw_outside = function (ex) {\n      (view.setImmediate || view.setTimeout)(function () {\n        throw ex;\n      }, 0);\n    },\n    force_saveable_type = \"application/octet-stream\"\n    // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n    ,\n    arbitrary_revoke_timeout = 1000 * 40 // in ms\n    ,\n    revoke = function (file) {\n      var revoker = function () {\n        if (typeof file === \"string\") {\n          // file is an object URL\n          get_URL().revokeObjectURL(file);\n        } else {\n          // file is a File\n          file.remove();\n        }\n      };\n      setTimeout(revoker, arbitrary_revoke_timeout);\n    },\n    dispatch = function (filesaver, event_types, event) {\n      event_types = [].concat(event_types);\n      var i = event_types.length;\n      while (i--) {\n        var listener = filesaver[\"on\" + event_types[i]];\n        if (typeof listener === \"function\") {\n          try {\n            listener.call(filesaver, event || filesaver);\n          } catch (ex) {\n            throw_outside(ex);\n          }\n        }\n      }\n    },\n    auto_bom = function (blob) {\n      // prepend BOM for UTF-8 XML and text/* types (including HTML)\n      // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n      if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n        return new Blob([String.fromCharCode(0xFEFF), blob], {\n          type: blob.type\n        });\n      }\n      return blob;\n    },\n    FileSaver = function (blob, name, no_auto_bom) {\n      if (!no_auto_bom) {\n        blob = auto_bom(blob);\n      }\n      // First try a.download, then web filesystem, then object URLs\n      var filesaver = this,\n        type = blob.type,\n        force = type === force_saveable_type,\n        object_url,\n        dispatch_all = function () {\n          dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n        }\n        // on any filesys errors revert to saving with object URLs\n        ,\n        fs_error = function () {\n          if ((is_chrome_ios || force && is_safari) && view.FileReader) {\n            // Safari doesn't allow downloading of blob urls\n            var reader = new FileReader();\n            reader.onloadend = function () {\n              var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n              var popup = view.open(url, '_blank');\n              if (!popup) view.location.href = url;\n              url = undefined; // release reference before dispatching\n              filesaver.readyState = filesaver.DONE;\n              dispatch_all();\n            };\n            reader.readAsDataURL(blob);\n            filesaver.readyState = filesaver.INIT;\n            return;\n          }\n          // don't create more object URLs than needed\n          if (!object_url) {\n            object_url = get_URL().createObjectURL(blob);\n          }\n          if (force) {\n            view.location.href = object_url;\n          } else {\n            var opened = view.open(object_url, \"_blank\");\n            if (!opened) {\n              // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n              view.location.href = object_url;\n            }\n          }\n          filesaver.readyState = filesaver.DONE;\n          dispatch_all();\n          revoke(object_url);\n        };\n      filesaver.readyState = filesaver.INIT;\n      if (can_use_save_link) {\n        object_url = get_URL().createObjectURL(blob);\n        setTimeout(function () {\n          save_link.href = object_url;\n          save_link.download = name;\n          click(save_link);\n          dispatch_all();\n          revoke(object_url);\n          filesaver.readyState = filesaver.DONE;\n        });\n        return;\n      }\n      fs_error();\n    },\n    FS_proto = FileSaver.prototype,\n    saveAs = function (blob, name, no_auto_bom) {\n      return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n    };\n  // IE 10+ (native saveAs)\n  if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n    return function (blob, name, no_auto_bom) {\n      name = name || blob.name || \"download\";\n      if (!no_auto_bom) {\n        blob = auto_bom(blob);\n      }\n      return navigator.msSaveOrOpenBlob(blob, name);\n    };\n  }\n  FS_proto.abort = function () {};\n  FS_proto.readyState = FS_proto.INIT = 0;\n  FS_proto.WRITING = 1;\n  FS_proto.DONE = 2;\n  FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;\n  return saveAs;\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content);\n\n// Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\n// since this file can be loaded before Button's core!\nDataTable.fileSave = _saveAs;\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Local (private) functions\r\n */\n\n/**\r\n * Get the sheet name for Excel exports.\r\n *\r\n * @param {object}\tconfig Button configuration\r\n */\nvar _sheetname = function (config) {\n  var sheetName = 'Sheet1';\n  if (config.sheetName) {\n    sheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n  }\n  return sheetName;\n};\n\n/**\r\n * Get the newline character(s)\r\n *\r\n * @param {object}\tconfig Button configuration\r\n * @return {string}\t\t\t\tNewline character\r\n */\nvar _newLine = function (config) {\n  return config.newline ? config.newline : navigator.userAgent.match(/Windows/) ? '\\r\\n' : '\\n';\n};\n\n/**\r\n * Combine the data from the `buttons.exportData` method into a string that\r\n * will be used in the export file.\r\n *\r\n * @param\t{DataTable.Api} dt\t\t DataTables API instance\r\n * @param\t{object}\t\t\t\tconfig Button configuration\r\n * @return {object}\t\t\t\t\t\t\t The data to export\r\n */\nvar _exportData = function (dt, config) {\n  var newLine = _newLine(config);\n  var data = dt.buttons.exportData(config.exportOptions);\n  var boundary = config.fieldBoundary;\n  var separator = config.fieldSeparator;\n  var reBoundary = new RegExp(boundary, 'g');\n  var escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\n  var join = function (a) {\n    var s = '';\n\n    // If there is a field boundary, then we might need to escape it in\n    // the source data\n    for (var i = 0, ien = a.length; i < ien; i++) {\n      if (i > 0) {\n        s += separator;\n      }\n      s += boundary ? boundary + ('' + a[i]).replace(reBoundary, escapeChar + boundary) + boundary : a[i];\n    }\n    return s;\n  };\n  var header = config.header ? join(data.header) + newLine : '';\n  var footer = config.footer && data.footer ? newLine + join(data.footer) : '';\n  var body = [];\n  for (var i = 0, ien = data.body.length; i < ien; i++) {\n    body.push(join(data.body[i]));\n  }\n  return {\n    str: header + body.join(newLine) + footer,\n    rows: body.length\n  };\n};\n\n/**\r\n * Older versions of Safari (prior to tech preview 18) don't support the\r\n * download option required.\r\n *\r\n * @return {Boolean} `true` if old Safari\r\n */\nvar _isDuffSafari = function () {\n  var safari = navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1 && navigator.userAgent.indexOf('Opera') === -1;\n  if (!safari) {\n    return false;\n  }\n  var version = navigator.userAgent.match(/AppleWebKit\\/(\\d+\\.\\d+)/);\n  if (version && version.length > 1 && version[1] * 1 < 603.1) {\n    return true;\n  }\n  return false;\n};\n\n/**\r\n * Convert from numeric position to letter for column names in Excel\r\n * @param  {int} n Column number\r\n * @return {string} Column letter(s) name\r\n */\nfunction createCellPos(n) {\n  var ordA = 'A'.charCodeAt(0);\n  var ordZ = 'Z'.charCodeAt(0);\n  var len = ordZ - ordA + 1;\n  var s = \"\";\n  while (n >= 0) {\n    s = String.fromCharCode(n % len + ordA) + s;\n    n = Math.floor(n / len) - 1;\n  }\n  return s;\n}\ntry {\n  var _serialiser = new XMLSerializer();\n  var _ieExcel;\n} catch (t) {}\n\n/**\r\n * Recursively add XML files from an object's structure to a ZIP file. This\r\n * allows the XSLX file to be easily defined with an object's structure matching\r\n * the files structure.\r\n *\r\n * @param {JSZip} zip ZIP package\r\n * @param {object} obj Object to add (recursive)\r\n */\nfunction _addToZip(zip, obj) {\n  if (_ieExcel === undefined) {\n    // Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n    // drop attributes\n    _ieExcel = _serialiser.serializeToString(new window.DOMParser().parseFromString(excelStrings['xl/worksheets/sheet1.xml'], 'text/xml')).indexOf('xmlns:r') === -1;\n  }\n  $.each(obj, function (name, val) {\n    if ($.isPlainObject(val)) {\n      var newDir = zip.folder(name);\n      _addToZip(newDir, val);\n    } else {\n      if (_ieExcel) {\n        // IE's XML serialiser will drop some name space attributes from\n        // from the root node, so we need to save them. Do this by\n        // replacing the namespace nodes with a regular attribute that\n        // we convert back when serialised. Edge does not have this\n        // issue\n        var worksheet = val.childNodes[0];\n        var i, ien;\n        var attrs = [];\n        for (i = worksheet.attributes.length - 1; i >= 0; i--) {\n          var attrName = worksheet.attributes[i].nodeName;\n          var attrValue = worksheet.attributes[i].nodeValue;\n          if (attrName.indexOf(':') !== -1) {\n            attrs.push({\n              name: attrName,\n              value: attrValue\n            });\n            worksheet.removeAttribute(attrName);\n          }\n        }\n        for (i = 0, ien = attrs.length; i < ien; i++) {\n          var attr = val.createAttribute(attrs[i].name.replace(':', '_dt_b_namespace_token_'));\n          attr.value = attrs[i].value;\n          worksheet.setAttributeNode(attr);\n        }\n      }\n      var str = _serialiser.serializeToString(val);\n\n      // Fix IE's XML\n      if (_ieExcel) {\n        // IE doesn't include the XML declaration\n        if (str.indexOf('<?xml') === -1) {\n          str = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + str;\n        }\n\n        // Return namespace attributes to being as such\n        str = str.replace(/_dt_b_namespace_token_/g, ':');\n\n        // Remove testing name space that IE puts into the space preserve attr\n        str = str.replace(/xmlns:NS[\\d]+=\"\" NS[\\d]+:/g, '');\n      }\n\n      // Safari, IE and Edge will put empty name space attributes onto\n      // various elements making them useless. This strips them out\n      str = str.replace(/<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>');\n      zip.file(name, str);\n    }\n  });\n}\n\n/**\r\n * Create an XML node and add any children, attributes, etc without needing to\r\n * be verbose in the DOM.\r\n *\r\n * @param  {object} doc      XML document\r\n * @param  {string} nodeName Node name\r\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\r\n *   (child nodes) and `text` (text content)\r\n * @return {node}            Created node\r\n */\nfunction _createNode(doc, nodeName, opts) {\n  var tempNode = doc.createElement(nodeName);\n  if (opts) {\n    if (opts.attr) {\n      $(tempNode).attr(opts.attr);\n    }\n    if (opts.children) {\n      $.each(opts.children, function (key, value) {\n        tempNode.appendChild(value);\n      });\n    }\n    if (opts.text !== null && opts.text !== undefined) {\n      tempNode.appendChild(doc.createTextNode(opts.text));\n    }\n  }\n  return tempNode;\n}\n\n/**\r\n * Get the width for an Excel column based on the contents of that column\r\n * @param  {object} data Data for export\r\n * @param  {int}    col  Column index\r\n * @return {int}         Column width\r\n */\nfunction _excelColWidth(data, col) {\n  var max = data.header[col].length;\n  var len, lineSplit, str;\n  if (data.footer && data.footer[col].length > max) {\n    max = data.footer[col].length;\n  }\n  for (var i = 0, ien = data.body.length; i < ien; i++) {\n    var point = data.body[i][col];\n    str = point !== null && point !== undefined ? point.toString() : '';\n\n    // If there is a newline character, workout the width of the column\n    // based on the longest line in the string\n    if (str.indexOf('\\n') !== -1) {\n      lineSplit = str.split('\\n');\n      lineSplit.sort(function (a, b) {\n        return b.length - a.length;\n      });\n      len = lineSplit[0].length;\n    } else {\n      len = str.length;\n    }\n    if (len > max) {\n      max = len;\n    }\n\n    // Max width rather than having potentially massive column widths\n    if (max > 40) {\n      return 54; // 40 * 1.35\n    }\n  }\n\n  max *= 1.35;\n\n  // And a min width\n  return max > 6 ? max : 6;\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n  \"_rels/.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' + '</Relationships>',\n  \"xl/_rels/workbook.xml.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' + '</Relationships>',\n  \"[Content_Types].xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' + '<Default Extension=\"xml\" ContentType=\"application/xml\" />' + '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' + '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' + '<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' + '<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' + '<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' + '</Types>',\n  \"xl/workbook.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' + '<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' + '<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' + '<bookViews>' + '<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' + '</bookViews>' + '<sheets>' + '<sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/>' + '</sheets>' + '<definedNames/>' + '</workbook>',\n  \"xl/worksheets/sheet1.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<sheetData/>' + '<mergeCells count=\"0\"/>' + '</worksheet>',\n  \"xl/styles.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<numFmts count=\"6\">' + '<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>' + '<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>' + '<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>' + '<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>' + '<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>' + '<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>' + '</numFmts>' + '<fonts count=\"5\" x14ac:knownFonts=\"1\">' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<color rgb=\"FFFFFFFF\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<b />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<i />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<u />' + '</font>' + '</fonts>' + '<fills count=\"6\">' + '<fill>' + '<patternFill patternType=\"none\" />' + '</fill>' + '<fill>' +\n  // Excel appears to use this as a dotted background regardless of values but\n  '<patternFill patternType=\"none\" />' +\n  // to be valid to the schema, use a patternFill\n  '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD9D9D9\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD99795\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6efce\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6cfef\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '</fills>' + '<borders count=\"2\">' + '<border>' + '<left />' + '<right />' + '<top />' + '<bottom />' + '<diagonal />' + '</border>' + '<border diagonalUp=\"false\" diagonalDown=\"false\">' + '<left style=\"thin\">' + '<color auto=\"1\" />' + '</left>' + '<right style=\"thin\">' + '<color auto=\"1\" />' + '</right>' + '<top style=\"thin\">' + '<color auto=\"1\" />' + '</top>' + '<bottom style=\"thin\">' + '<color auto=\"1\" />' + '</bottom>' + '<diagonal />' + '</border>' + '</borders>' + '<cellStyleXfs count=\"1\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' + '</cellStyleXfs>' + '<cellXfs count=\"68\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"left\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"center\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"right\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"fill\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment textRotation=\"90\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment wrapText=\"1\"/>' + '</xf>' + '<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"1\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"2\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"14\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '</cellXfs>' + '<cellStyles count=\"1\">' + '<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' + '</cellStyles>' + '<dxfs count=\"0\" />' + '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' + '</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n// Pattern matching for special number formats. Perhaps this should be exposed\n// via an API in future?\n// Ref: section 3.8.30 - built in formatters in open spreadsheet\n//   https://www.ecma-international.org/news/TC45_current_work/Office%20Open%20XML%20Part%204%20-%20Markup%20Language%20Reference.pdf\nvar _excelSpecials = [{\n  match: /^\\-?\\d+\\.\\d%$/,\n  style: 60,\n  fmt: function (d) {\n    return d / 100;\n  }\n},\n// Percent with d.p.\n{\n  match: /^\\-?\\d+\\.?\\d*%$/,\n  style: 56,\n  fmt: function (d) {\n    return d / 100;\n  }\n},\n// Percent\n{\n  match: /^\\-?\\$[\\d,]+.?\\d*$/,\n  style: 57\n},\n// Dollars\n{\n  match: /^\\-?£[\\d,]+.?\\d*$/,\n  style: 58\n},\n// Pounds\n{\n  match: /^\\-?€[\\d,]+.?\\d*$/,\n  style: 59\n},\n// Euros\n{\n  match: /^\\-?\\d+$/,\n  style: 65\n},\n// Numbers without thousand separators\n{\n  match: /^\\-?\\d+\\.\\d{2}$/,\n  style: 66\n},\n// Numbers 2 d.p. without thousands separators\n{\n  match: /^\\([\\d,]+\\)$/,\n  style: 61,\n  fmt: function (d) {\n    return -1 * d.replace(/[\\(\\)]/g, '');\n  }\n},\n// Negative numbers indicated by brackets\n{\n  match: /^\\([\\d,]+\\.\\d{2}\\)$/,\n  style: 62,\n  fmt: function (d) {\n    return -1 * d.replace(/[\\(\\)]/g, '');\n  }\n},\n// Negative numbers indicated by brackets - 2d.p.\n{\n  match: /^\\-?[\\d,]+$/,\n  style: 63\n},\n// Numbers with thousand separators\n{\n  match: /^\\-?[\\d,]+\\.\\d{2}$/,\n  style: 64\n}, {\n  match: /^[\\d]{4}\\-[01][\\d]\\-[0123][\\d]$/,\n  style: 67,\n  fmt: function (d) {\n    return Math.round(25569 + Date.parse(d) / (86400 * 1000));\n  }\n} //Date yyyy-mm-dd\n];\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Buttons\r\n */\n\n//\n// Copy to clipboard\n//\nDataTable.ext.buttons.copyHtml5 = {\n  className: 'buttons-copy buttons-html5',\n  text: function (dt) {\n    return dt.i18n('buttons.copy', 'Copy');\n  },\n  action: function (e, dt, button, config) {\n    this.processing(true);\n    var that = this;\n    var exportData = _exportData(dt, config);\n    var info = dt.buttons.exportInfo(config);\n    var newline = _newLine(config);\n    var output = exportData.str;\n    var hiddenDiv = $('<div/>').css({\n      height: 1,\n      width: 1,\n      overflow: 'hidden',\n      position: 'fixed',\n      top: 0,\n      left: 0\n    });\n    if (info.title) {\n      output = info.title + newline + newline + output;\n    }\n    if (info.messageTop) {\n      output = info.messageTop + newline + newline + output;\n    }\n    if (info.messageBottom) {\n      output = output + newline + newline + info.messageBottom;\n    }\n    if (config.customize) {\n      output = config.customize(output, config, dt);\n    }\n    var textarea = $('<textarea readonly/>').val(output).appendTo(hiddenDiv);\n\n    // For browsers that support the copy execCommand, try to use it\n    if (document.queryCommandSupported('copy')) {\n      hiddenDiv.appendTo(dt.table().container());\n      textarea[0].focus();\n      textarea[0].select();\n      try {\n        var successful = document.execCommand('copy');\n        hiddenDiv.remove();\n        if (successful) {\n          dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), dt.i18n('buttons.copySuccess', {\n            1: 'Copied one row to clipboard',\n            _: 'Copied %d rows to clipboard'\n          }, exportData.rows), 2000);\n          this.processing(false);\n          return;\n        }\n      } catch (t) {}\n    }\n\n    // Otherwise we show the text box and instruct the user to use it\n    var message = $('<span>' + dt.i18n('buttons.copyKeys', 'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>' + 'To cancel, click this message or press escape.') + '</span>').append(hiddenDiv);\n    dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), message, 0);\n\n    // Select the text so when the user activates their system clipboard\n    // it will copy that text\n    textarea[0].focus();\n    textarea[0].select();\n\n    // Event to hide the message when the user is done\n    var container = $(message).closest('.dt-button-info');\n    var close = function () {\n      container.off('click.buttons-copy');\n      $(document).off('.buttons-copy');\n      dt.buttons.info(false);\n    };\n    container.on('click.buttons-copy', close);\n    $(document).on('keydown.buttons-copy', function (e) {\n      if (e.keyCode === 27) {\n        // esc\n        close();\n        that.processing(false);\n      }\n    }).on('copy.buttons-copy cut.buttons-copy', function () {\n      close();\n      that.processing(false);\n    });\n  },\n  exportOptions: {},\n  fieldSeparator: '\\t',\n  fieldBoundary: '',\n  header: true,\n  footer: false,\n  title: '*',\n  messageTop: '*',\n  messageBottom: '*'\n};\n\n//\n// CSV export\n//\nDataTable.ext.buttons.csvHtml5 = {\n  bom: false,\n  className: 'buttons-csv buttons-html5',\n  available: function () {\n    return window.FileReader !== undefined && window.Blob;\n  },\n  text: function (dt) {\n    return dt.i18n('buttons.csv', 'CSV');\n  },\n  action: function (e, dt, button, config) {\n    this.processing(true);\n\n    // Set the text\n    var output = _exportData(dt, config).str;\n    var info = dt.buttons.exportInfo(config);\n    var charset = config.charset;\n    if (config.customize) {\n      output = config.customize(output, config, dt);\n    }\n    if (charset !== false) {\n      if (!charset) {\n        charset = document.characterSet || document.charset;\n      }\n      if (charset) {\n        charset = ';charset=' + charset;\n      }\n    } else {\n      charset = '';\n    }\n    if (config.bom) {\n      output = String.fromCharCode(0xFEFF) + output;\n    }\n    _saveAs(new Blob([output], {\n      type: 'text/csv' + charset\n    }), info.filename, true);\n    this.processing(false);\n  },\n  filename: '*',\n  extension: '.csv',\n  exportOptions: {},\n  fieldSeparator: ',',\n  fieldBoundary: '\"',\n  escapeChar: '\"',\n  charset: null,\n  header: true,\n  footer: false\n};\n\n//\n// Excel (xlsx) export\n//\nDataTable.ext.buttons.excelHtml5 = {\n  className: 'buttons-excel buttons-html5',\n  available: function () {\n    return window.FileReader !== undefined && _jsZip() !== undefined && !_isDuffSafari() && _serialiser;\n  },\n  text: function (dt) {\n    return dt.i18n('buttons.excel', 'Excel');\n  },\n  action: function (e, dt, button, config) {\n    this.processing(true);\n    var that = this;\n    var rowPos = 0;\n    var dataStartRow, dataEndRow;\n    var getXml = function (type) {\n      var str = excelStrings[type];\n\n      //str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\n\n      return $.parseXML(str);\n    };\n    var rels = getXml('xl/worksheets/sheet1.xml');\n    var relsGet = rels.getElementsByTagName(\"sheetData\")[0];\n    var xlsx = {\n      _rels: {\n        \".rels\": getXml('_rels/.rels')\n      },\n      xl: {\n        _rels: {\n          \"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\n        },\n        \"workbook.xml\": getXml('xl/workbook.xml'),\n        \"styles.xml\": getXml('xl/styles.xml'),\n        \"worksheets\": {\n          \"sheet1.xml\": rels\n        }\n      },\n      \"[Content_Types].xml\": getXml('[Content_Types].xml')\n    };\n    var data = dt.buttons.exportData(config.exportOptions);\n    var currentRow, rowNode;\n    var addRow = function (row) {\n      currentRow = rowPos + 1;\n      rowNode = _createNode(rels, \"row\", {\n        attr: {\n          r: currentRow\n        }\n      });\n      for (var i = 0, ien = row.length; i < ien; i++) {\n        // Concat both the Cell Columns as a letter and the Row of the cell.\n        var cellId = createCellPos(i) + '' + currentRow;\n        var cell = null;\n\n        // For null, undefined of blank cell, continue so it doesn't create the _createNode\n        if (row[i] === null || row[i] === undefined || row[i] === '') {\n          if (config.createEmptyCells === true) {\n            row[i] = '';\n          } else {\n            continue;\n          }\n        }\n        var originalContent = row[i];\n        row[i] = typeof row[i].trim === 'function' ? row[i].trim() : row[i];\n\n        // Special number formatting options\n        for (var j = 0, jen = _excelSpecials.length; j < jen; j++) {\n          var special = _excelSpecials[j];\n\n          // TODO Need to provide the ability for the specials to say\n          // if they are returning a string, since at the moment it is\n          // assumed to be a number\n          if (row[i].match && !row[i].match(/^0\\d+/) && row[i].match(special.match)) {\n            var val = row[i].replace(/[^\\d\\.\\-]/g, '');\n            if (special.fmt) {\n              val = special.fmt(val);\n            }\n            cell = _createNode(rels, 'c', {\n              attr: {\n                r: cellId,\n                s: special.style\n              },\n              children: [_createNode(rels, 'v', {\n                text: val\n              })]\n            });\n            break;\n          }\n        }\n        if (!cell) {\n          if (typeof row[i] === 'number' || row[i].match && row[i].match(/^-?\\d+(\\.\\d+)?([eE]\\-?\\d+)?$/) &&\n          // Includes exponential format\n          !row[i].match(/^0\\d+/)) {\n            // Detect numbers - don't match numbers with leading zeros\n            // or a negative anywhere but the start\n            cell = _createNode(rels, 'c', {\n              attr: {\n                t: 'n',\n                r: cellId\n              },\n              children: [_createNode(rels, 'v', {\n                text: row[i]\n              })]\n            });\n          } else {\n            // String output - replace non standard characters for text output\n            var text = !originalContent.replace ? originalContent : originalContent.replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n            cell = _createNode(rels, 'c', {\n              attr: {\n                t: 'inlineStr',\n                r: cellId\n              },\n              children: {\n                row: _createNode(rels, 'is', {\n                  children: {\n                    row: _createNode(rels, 't', {\n                      text: text,\n                      attr: {\n                        'xml:space': 'preserve'\n                      }\n                    })\n                  }\n                })\n              }\n            });\n          }\n        }\n        rowNode.appendChild(cell);\n      }\n      relsGet.appendChild(rowNode);\n      rowPos++;\n    };\n    if (config.customizeData) {\n      config.customizeData(data);\n    }\n    var mergeCells = function (row, colspan) {\n      var mergeCells = $('mergeCells', rels);\n      mergeCells[0].appendChild(_createNode(rels, 'mergeCell', {\n        attr: {\n          ref: 'A' + row + ':' + createCellPos(colspan) + row\n        }\n      }));\n      mergeCells.attr('count', parseFloat(mergeCells.attr('count')) + 1);\n      $('row:eq(' + (row - 1) + ') c', rels).attr('s', '51'); // centre\n    };\n\n    // Title and top messages\n    var exportInfo = dt.buttons.exportInfo(config);\n    if (exportInfo.title) {\n      addRow([exportInfo.title], rowPos);\n      mergeCells(rowPos, data.header.length - 1);\n    }\n    if (exportInfo.messageTop) {\n      addRow([exportInfo.messageTop], rowPos);\n      mergeCells(rowPos, data.header.length - 1);\n    }\n\n    // Table itself\n    if (config.header) {\n      addRow(data.header, rowPos);\n      $('row:last c', rels).attr('s', '2'); // bold\n    }\n\n    dataStartRow = rowPos;\n    for (var n = 0, ie = data.body.length; n < ie; n++) {\n      addRow(data.body[n], rowPos);\n    }\n    dataEndRow = rowPos;\n    if (config.footer && data.footer) {\n      addRow(data.footer, rowPos);\n      $('row:last c', rels).attr('s', '2'); // bold\n    }\n\n    // Below the table\n    if (exportInfo.messageBottom) {\n      addRow([exportInfo.messageBottom], rowPos);\n      mergeCells(rowPos, data.header.length - 1);\n    }\n\n    // Set column widths\n    var cols = _createNode(rels, 'cols');\n    $('worksheet', rels).prepend(cols);\n    for (var i = 0, ien = data.header.length; i < ien; i++) {\n      cols.appendChild(_createNode(rels, 'col', {\n        attr: {\n          min: i + 1,\n          max: i + 1,\n          width: _excelColWidth(data, i),\n          customWidth: 1\n        }\n      }));\n    }\n\n    // Workbook modifications\n    var workbook = xlsx.xl['workbook.xml'];\n    $('sheets sheet', workbook).attr('name', _sheetname(config));\n\n    // Auto filter for columns\n    if (config.autoFilter) {\n      $('mergeCells', rels).before(_createNode(rels, 'autoFilter', {\n        attr: {\n          ref: 'A' + dataStartRow + ':' + createCellPos(data.header.length - 1) + dataEndRow\n        }\n      }));\n      $('definedNames', workbook).append(_createNode(workbook, 'definedName', {\n        attr: {\n          name: '_xlnm._FilterDatabase',\n          localSheetId: '0',\n          hidden: 1\n        },\n        text: _sheetname(config) + '!$A$' + dataStartRow + ':' + createCellPos(data.header.length - 1) + dataEndRow\n      }));\n    }\n\n    // Let the developer customise the document if they want to\n    if (config.customize) {\n      config.customize(xlsx, config, dt);\n    }\n\n    // Excel doesn't like an empty mergeCells tag\n    if ($('mergeCells', rels).children().length === 0) {\n      $('mergeCells', rels).remove();\n    }\n    var jszip = _jsZip();\n    var zip = new jszip();\n    var zipConfig = {\n      compression: \"DEFLATE\",\n      type: 'blob',\n      mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n    };\n    _addToZip(zip, xlsx);\n\n    // Modern Excel has a 218 character limit on the file name + path of the file (why!?)\n    // https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\n    // So we truncate to allow for this.\n    var filename = exportInfo.filename;\n    if (filename > 175) {\n      filename = filename.substr(0, 175);\n    }\n    if (zip.generateAsync) {\n      // JSZip 3+\n      zip.generateAsync(zipConfig).then(function (blob) {\n        _saveAs(blob, filename);\n        that.processing(false);\n      });\n    } else {\n      // JSZip 2.5\n      _saveAs(zip.generate(zipConfig), filename);\n      this.processing(false);\n    }\n  },\n  filename: '*',\n  extension: '.xlsx',\n  exportOptions: {},\n  header: true,\n  footer: false,\n  title: '*',\n  messageTop: '*',\n  messageBottom: '*',\n  createEmptyCells: false,\n  autoFilter: false,\n  sheetName: ''\n};\n\n//\n// PDF export - using pdfMake - http://pdfmake.org\n//\nDataTable.ext.buttons.pdfHtml5 = {\n  className: 'buttons-pdf buttons-html5',\n  available: function () {\n    return window.FileReader !== undefined && _pdfMake();\n  },\n  text: function (dt) {\n    return dt.i18n('buttons.pdf', 'PDF');\n  },\n  action: function (e, dt, button, config) {\n    this.processing(true);\n    var that = this;\n    var data = dt.buttons.exportData(config.exportOptions);\n    var info = dt.buttons.exportInfo(config);\n    var rows = [];\n    if (config.header) {\n      rows.push($.map(data.header, function (d) {\n        return {\n          text: typeof d === 'string' ? d : d + '',\n          style: 'tableHeader'\n        };\n      }));\n    }\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      rows.push($.map(data.body[i], function (d) {\n        if (d === null || d === undefined) {\n          d = '';\n        }\n        return {\n          text: typeof d === 'string' ? d : d + '',\n          style: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\n        };\n      }));\n    }\n    if (config.footer && data.footer) {\n      rows.push($.map(data.footer, function (d) {\n        return {\n          text: typeof d === 'string' ? d : d + '',\n          style: 'tableFooter'\n        };\n      }));\n    }\n    var doc = {\n      pageSize: config.pageSize,\n      pageOrientation: config.orientation,\n      content: [{\n        table: {\n          headerRows: 1,\n          body: rows\n        },\n        layout: 'noBorders'\n      }],\n      styles: {\n        tableHeader: {\n          bold: true,\n          fontSize: 11,\n          color: 'white',\n          fillColor: '#2d4154',\n          alignment: 'center'\n        },\n        tableBodyEven: {},\n        tableBodyOdd: {\n          fillColor: '#f3f3f3'\n        },\n        tableFooter: {\n          bold: true,\n          fontSize: 11,\n          color: 'white',\n          fillColor: '#2d4154'\n        },\n        title: {\n          alignment: 'center',\n          fontSize: 15\n        },\n        message: {}\n      },\n      defaultStyle: {\n        fontSize: 10\n      }\n    };\n    if (info.messageTop) {\n      doc.content.unshift({\n        text: info.messageTop,\n        style: 'message',\n        margin: [0, 0, 0, 12]\n      });\n    }\n    if (info.messageBottom) {\n      doc.content.push({\n        text: info.messageBottom,\n        style: 'message',\n        margin: [0, 0, 0, 12]\n      });\n    }\n    if (info.title) {\n      doc.content.unshift({\n        text: info.title,\n        style: 'title',\n        margin: [0, 0, 0, 12]\n      });\n    }\n    if (config.customize) {\n      config.customize(doc, config, dt);\n    }\n    var pdf = _pdfMake().createPdf(doc);\n    if (config.download === 'open' && !_isDuffSafari()) {\n      pdf.open();\n    } else {\n      pdf.download(info.filename);\n    }\n    this.processing(false);\n  },\n  title: '*',\n  filename: '*',\n  extension: '.pdf',\n  exportOptions: {},\n  orientation: 'portrait',\n  pageSize: 'A4',\n  header: true,\n  footer: false,\n  messageTop: '*',\n  messageBottom: '*',\n  customize: null,\n  download: 'download'\n};\nexport default DataTable;","map":{"version":3,"names":["$","DataTable","Buttons","useJszip","usePdfmake","_jsZip","window","JSZip","_pdfMake","pdfMake","_","jszip","_saveAs","view","navigator","test","userAgent","doc","document","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","click","node","event","MouseEvent","dispatchEvent","is_safari","HTMLElement","safari","is_chrome_ios","throw_outside","ex","setImmediate","setTimeout","force_saveable_type","arbitrary_revoke_timeout","revoke","file","revoker","revokeObjectURL","remove","dispatch","filesaver","event_types","concat","i","length","listener","call","auto_bom","blob","type","Blob","String","fromCharCode","FileSaver","name","no_auto_bom","force","object_url","dispatch_all","split","fs_error","FileReader","reader","onloadend","url","result","replace","popup","open","location","href","undefined","readyState","DONE","readAsDataURL","INIT","createObjectURL","opened","download","FS_proto","prototype","saveAs","msSaveOrOpenBlob","abort","WRITING","error","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","content","fileSave","_sheetname","config","sheetName","_newLine","newline","match","_exportData","dt","newLine","data","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","RegExp","escapeChar","join","a","s","ien","header","footer","body","push","str","rows","_isDuffSafari","indexOf","version","createCellPos","n","ordA","charCodeAt","ordZ","len","Math","floor","_serialiser","XMLSerializer","_ieExcel","t","_addToZip","zip","obj","serializeToString","DOMParser","parseFromString","excelStrings","each","val","isPlainObject","newDir","folder","worksheet","childNodes","attrs","attributes","attrName","nodeName","attrValue","nodeValue","value","removeAttribute","attr","createAttribute","setAttributeNode","_createNode","opts","tempNode","createElement","children","key","appendChild","text","createTextNode","_excelColWidth","col","max","lineSplit","point","toString","sort","b","_excelSpecials","style","fmt","d","round","Date","parse","ext","copyHtml5","className","i18n","action","e","button","processing","that","info","exportInfo","output","hiddenDiv","css","height","width","overflow","position","top","left","title","messageTop","messageBottom","customize","textarea","appendTo","queryCommandSupported","table","container","focus","select","successful","execCommand","message","append","closest","close","off","on","keyCode","csvHtml5","bom","available","charset","characterSet","filename","extension","excelHtml5","rowPos","dataStartRow","dataEndRow","getXml","parseXML","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","createEmptyCells","originalContent","trim","j","jen","special","customizeData","mergeCells","colspan","ref","parseFloat","ie","cols","prepend","min","customWidth","workbook","autoFilter","before","localSheetId","hidden","zipConfig","compression","mimeType","substr","generateAsync","then","generate","pdfHtml5","map","pageSize","pageOrientation","orientation","headerRows","layout","styles","tableHeader","bold","fontSize","color","fillColor","alignment","tableBodyEven","tableBodyOdd","tableFooter","defaultStyle","unshift","margin","pdf","createPdf"],"sources":["D:/filee/SISTEM-INFORMASI-SEKOLAH-SMKN-1-JETIS-MASTER/frontend/node_modules/datatables.net-buttons/js/buttons.html5.mjs"],"sourcesContent":["/*!\r\n * HTML5 export buttons for Buttons and DataTables.\r\n * 2016 SpryMedia Ltd - datatables.net/license\r\n *\r\n * FileSaver.js (1.3.3) - MIT license\r\n * Copyright © 2016 Eli Grey - http://eligrey.com\r\n */\r\n\r\nimport $ from 'jquery';\r\nimport DataTable from 'datatables.net';\r\nimport Buttons from 'datatables.net-buttons';\r\n\r\n\r\n// Allow the constructor to pass in JSZip and PDFMake from external requires.\r\n// Otherwise, use globally defined variables, if they are available.\r\nvar useJszip;\r\nvar usePdfmake;\r\n\r\nfunction _jsZip () {\r\n\treturn useJszip || window.JSZip;\r\n}\r\nfunction _pdfMake () {\r\n\treturn usePdfmake || window.pdfMake;\r\n}\r\n\r\nDataTable.Buttons.pdfMake = function (_) {\r\n\tif ( ! _ ) {\r\n\t\treturn _pdfMake();\r\n\t}\r\n\tusePdfmake = _;\r\n}\r\n\r\nDataTable.Buttons.jszip = function (_) {\r\n\tif ( ! _ ) {\r\n\t\treturn _jsZip();\r\n\t}\r\n\tuseJszip = _;\r\n}\r\n\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * FileSaver.js dependency\r\n */\r\n\r\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\r\n\r\nvar _saveAs = (function(view) {\r\n\t\"use strict\";\r\n\t// IE <10 is explicitly unsupported\r\n\tif (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\r\n\t\treturn;\r\n\t}\r\n\tvar\r\n\t\t  doc = view.document\r\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\r\n\t\t, get_URL = function() {\r\n\t\t\treturn view.URL || view.webkitURL || view;\r\n\t\t}\r\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\r\n\t\t, can_use_save_link = \"download\" in save_link\r\n\t\t, click = function(node) {\r\n\t\t\tvar event = new MouseEvent(\"click\");\r\n\t\t\tnode.dispatchEvent(event);\r\n\t\t}\r\n\t\t, is_safari = /constructor/i.test(view.HTMLElement) || view.safari\r\n\t\t, is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\r\n\t\t, throw_outside = function(ex) {\r\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\r\n\t\t\t\tthrow ex;\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t\t, force_saveable_type = \"application/octet-stream\"\r\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\r\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\r\n\t\t, revoke = function(file) {\r\n\t\t\tvar revoker = function() {\r\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\r\n\t\t\t\t\tget_URL().revokeObjectURL(file);\r\n\t\t\t\t} else { // file is a File\r\n\t\t\t\t\tfile.remove();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\r\n\t\t}\r\n\t\t, dispatch = function(filesaver, event_types, event) {\r\n\t\t\tevent_types = [].concat(event_types);\r\n\t\t\tvar i = event_types.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\r\n\t\t\t\tif (typeof listener === \"function\") {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\r\n\t\t\t\t\t} catch (ex) {\r\n\t\t\t\t\t\tthrow_outside(ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t, auto_bom = function(blob) {\r\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\r\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\r\n\t\t\t\treturn new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\r\n\t\t\t}\r\n\t\t\treturn blob;\r\n\t\t}\r\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\t// First try a.download, then web filesystem, then object URLs\r\n\t\t\tvar\r\n\t\t\t\t  filesaver = this\r\n\t\t\t\t, type = blob.type\r\n\t\t\t\t, force = type === force_saveable_type\r\n\t\t\t\t, object_url\r\n\t\t\t\t, dispatch_all = function() {\r\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\r\n\t\t\t\t}\r\n\t\t\t\t// on any filesys errors revert to saving with object URLs\r\n\t\t\t\t, fs_error = function() {\r\n\t\t\t\t\tif ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\r\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\r\n\t\t\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\t\t\treader.onloadend = function() {\r\n\t\t\t\t\t\t\tvar url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\r\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\r\n\t\t\t\t\t\t\tif(!popup) view.location.href = url;\r\n\t\t\t\t\t\t\turl=undefined; // release reference before dispatching\r\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// don't create more object URLs than needed\r\n\t\t\t\t\tif (!object_url) {\r\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (force) {\r\n\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar opened = view.open(object_url, \"_blank\");\r\n\t\t\t\t\t\tif (!opened) {\r\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\r\n\t\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t}\r\n\t\t\t;\r\n\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\r\n\t\t\tif (can_use_save_link) {\r\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tsave_link.href = object_url;\r\n\t\t\t\t\tsave_link.download = name;\r\n\t\t\t\t\tclick(save_link);\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfs_error();\r\n\t\t}\r\n\t\t, FS_proto = FileSaver.prototype\r\n\t\t, saveAs = function(blob, name, no_auto_bom) {\r\n\t\t\treturn new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\r\n\t\t}\r\n\t;\r\n\t// IE 10+ (native saveAs)\r\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\r\n\t\treturn function(blob, name, no_auto_bom) {\r\n\t\t\tname = name || blob.name || \"download\";\r\n\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\r\n\t\t};\r\n\t}\r\n\r\n\tFS_proto.abort = function(){};\r\n\tFS_proto.readyState = FS_proto.INIT = 0;\r\n\tFS_proto.WRITING = 1;\r\n\tFS_proto.DONE = 2;\r\n\r\n\tFS_proto.error =\r\n\tFS_proto.onwritestart =\r\n\tFS_proto.onprogress =\r\n\tFS_proto.onwrite =\r\n\tFS_proto.onabort =\r\n\tFS_proto.onerror =\r\n\tFS_proto.onwriteend =\r\n\t\tnull;\r\n\r\n\treturn saveAs;\r\n}(\r\n\t   typeof self !== \"undefined\" && self\r\n\t|| typeof window !== \"undefined\" && window\r\n\t|| this.content\r\n));\r\n\r\n\r\n// Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\r\n// since this file can be loaded before Button's core!\r\nDataTable.fileSave = _saveAs;\r\n\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Local (private) functions\r\n */\r\n\r\n/**\r\n * Get the sheet name for Excel exports.\r\n *\r\n * @param {object}\tconfig Button configuration\r\n */\r\nvar _sheetname = function ( config )\r\n{\r\n\tvar sheetName = 'Sheet1';\r\n\r\n\tif ( config.sheetName ) {\r\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\r\n\t}\r\n\r\n\treturn sheetName;\r\n};\r\n\r\n/**\r\n * Get the newline character(s)\r\n *\r\n * @param {object}\tconfig Button configuration\r\n * @return {string}\t\t\t\tNewline character\r\n */\r\nvar _newLine = function ( config )\r\n{\r\n\treturn config.newline ?\r\n\t\tconfig.newline :\r\n\t\tnavigator.userAgent.match(/Windows/) ?\r\n\t\t\t'\\r\\n' :\r\n\t\t\t'\\n';\r\n};\r\n\r\n/**\r\n * Combine the data from the `buttons.exportData` method into a string that\r\n * will be used in the export file.\r\n *\r\n * @param\t{DataTable.Api} dt\t\t DataTables API instance\r\n * @param\t{object}\t\t\t\tconfig Button configuration\r\n * @return {object}\t\t\t\t\t\t\t The data to export\r\n */\r\nvar _exportData = function ( dt, config )\r\n{\r\n\tvar newLine = _newLine( config );\r\n\tvar data = dt.buttons.exportData( config.exportOptions );\r\n\tvar boundary = config.fieldBoundary;\r\n\tvar separator = config.fieldSeparator;\r\n\tvar reBoundary = new RegExp( boundary, 'g' );\r\n\tvar escapeChar = config.escapeChar !== undefined ?\r\n\t\tconfig.escapeChar :\r\n\t\t'\\\\';\r\n\tvar join = function ( a ) {\r\n\t\tvar s = '';\r\n\r\n\t\t// If there is a field boundary, then we might need to escape it in\r\n\t\t// the source data\r\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\r\n\t\t\tif ( i > 0 ) {\r\n\t\t\t\ts += separator;\r\n\t\t\t}\r\n\r\n\t\t\ts += boundary ?\r\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\r\n\t\t\t\ta[i];\r\n\t\t}\r\n\r\n\t\treturn s;\r\n\t};\r\n\r\n\tvar header = config.header ? join( data.header )+newLine : '';\r\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\r\n\tvar body = [];\r\n\r\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\r\n\t\tbody.push( join( data.body[i] ) );\r\n\t}\r\n\r\n\treturn {\r\n\t\tstr: header + body.join( newLine ) + footer,\r\n\t\trows: body.length\r\n\t};\r\n};\r\n\r\n/**\r\n * Older versions of Safari (prior to tech preview 18) don't support the\r\n * download option required.\r\n *\r\n * @return {Boolean} `true` if old Safari\r\n */\r\nvar _isDuffSafari = function ()\r\n{\r\n\tvar safari = navigator.userAgent.indexOf('Safari') !== -1 &&\r\n\t\tnavigator.userAgent.indexOf('Chrome') === -1 &&\r\n\t\tnavigator.userAgent.indexOf('Opera') === -1;\r\n\r\n\tif ( ! safari ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar version = navigator.userAgent.match( /AppleWebKit\\/(\\d+\\.\\d+)/ );\r\n\tif ( version && version.length > 1 && version[1]*1 < 603.1 ) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * Convert from numeric position to letter for column names in Excel\r\n * @param  {int} n Column number\r\n * @return {string} Column letter(s) name\r\n */\r\nfunction createCellPos( n ){\r\n\tvar ordA = 'A'.charCodeAt(0);\r\n\tvar ordZ = 'Z'.charCodeAt(0);\r\n\tvar len = ordZ - ordA + 1;\r\n\tvar s = \"\";\r\n\r\n\twhile( n >= 0 ) {\r\n\t\ts = String.fromCharCode(n % len + ordA) + s;\r\n\t\tn = Math.floor(n / len) - 1;\r\n\t}\r\n\r\n\treturn s;\r\n}\r\n\r\ntry {\r\n\tvar _serialiser = new XMLSerializer();\r\n\tvar _ieExcel;\r\n}\r\ncatch (t) {}\r\n\r\n/**\r\n * Recursively add XML files from an object's structure to a ZIP file. This\r\n * allows the XSLX file to be easily defined with an object's structure matching\r\n * the files structure.\r\n *\r\n * @param {JSZip} zip ZIP package\r\n * @param {object} obj Object to add (recursive)\r\n */\r\nfunction _addToZip( zip, obj ) {\r\n\tif ( _ieExcel === undefined ) {\r\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\r\n\t\t// drop attributes\r\n\t\t_ieExcel = _serialiser\r\n\t\t\t.serializeToString(\r\n\t\t\t\t( new window.DOMParser() ).parseFromString( excelStrings['xl/worksheets/sheet1.xml'], 'text/xml' )\r\n\t\t\t)\r\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\r\n\t}\r\n\r\n\t$.each( obj, function ( name, val ) {\r\n\t\tif ( $.isPlainObject( val ) ) {\r\n\t\t\tvar newDir = zip.folder( name );\r\n\t\t\t_addToZip( newDir, val );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ( _ieExcel ) {\r\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\r\n\t\t\t\t// from the root node, so we need to save them. Do this by\r\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\r\n\t\t\t\t// we convert back when serialised. Edge does not have this\r\n\t\t\t\t// issue\r\n\t\t\t\tvar worksheet = val.childNodes[0];\r\n\t\t\t\tvar i, ien;\r\n\t\t\t\tvar attrs = [];\r\n\r\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\r\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\r\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\r\n\r\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\r\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\r\n\r\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\r\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\r\n\t\t\t\t\tattr.value = attrs[i].value;\r\n\t\t\t\t\tworksheet.setAttributeNode( attr );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar str = _serialiser.serializeToString(val);\r\n\r\n\t\t\t// Fix IE's XML\r\n\t\t\tif ( _ieExcel ) {\r\n\t\t\t\t// IE doesn't include the XML declaration\r\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\r\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Return namespace attributes to being as such\r\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\r\n\r\n\t\t\t\t// Remove testing name space that IE puts into the space preserve attr\r\n\t\t\t\tstr = str.replace( /xmlns:NS[\\d]+=\"\" NS[\\d]+:/g, '' );\r\n\t\t\t}\r\n\r\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\r\n\t\t\t// various elements making them useless. This strips them out\r\n\t\t\tstr = str.replace( /<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>' );\r\n\r\n\t\t\tzip.file( name, str );\r\n\t\t}\r\n\t} );\r\n}\r\n\r\n/**\r\n * Create an XML node and add any children, attributes, etc without needing to\r\n * be verbose in the DOM.\r\n *\r\n * @param  {object} doc      XML document\r\n * @param  {string} nodeName Node name\r\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\r\n *   (child nodes) and `text` (text content)\r\n * @return {node}            Created node\r\n */\r\nfunction _createNode( doc, nodeName, opts ) {\r\n\tvar tempNode = doc.createElement( nodeName );\r\n\r\n\tif ( opts ) {\r\n\t\tif ( opts.attr ) {\r\n\t\t\t$(tempNode).attr( opts.attr );\r\n\t\t}\r\n\r\n\t\tif ( opts.children ) {\r\n\t\t\t$.each( opts.children, function ( key, value ) {\r\n\t\t\t\ttempNode.appendChild( value );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tif ( opts.text !== null && opts.text !== undefined ) {\r\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\r\n\t\t}\r\n\t}\r\n\r\n\treturn tempNode;\r\n}\r\n\r\n/**\r\n * Get the width for an Excel column based on the contents of that column\r\n * @param  {object} data Data for export\r\n * @param  {int}    col  Column index\r\n * @return {int}         Column width\r\n */\r\nfunction _excelColWidth( data, col ) {\r\n\tvar max = data.header[col].length;\r\n\tvar len, lineSplit, str;\r\n\r\n\tif ( data.footer && data.footer[col].length > max ) {\r\n\t\tmax = data.footer[col].length;\r\n\t}\r\n\r\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\r\n\t\tvar point = data.body[i][col];\r\n\t\tstr = point !== null && point !== undefined ?\r\n\t\t\tpoint.toString() :\r\n\t\t\t'';\r\n\r\n\t\t// If there is a newline character, workout the width of the column\r\n\t\t// based on the longest line in the string\r\n\t\tif ( str.indexOf('\\n') !== -1 ) {\r\n\t\t\tlineSplit = str.split('\\n');\r\n\t\t\tlineSplit.sort( function (a, b) {\r\n\t\t\t\treturn b.length - a.length;\r\n\t\t\t} );\r\n\r\n\t\t\tlen = lineSplit[0].length;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlen = str.length;\r\n\t\t}\r\n\r\n\t\tif ( len > max ) {\r\n\t\t\tmax = len;\r\n\t\t}\r\n\r\n\t\t// Max width rather than having potentially massive column widths\r\n\t\tif ( max > 40 ) {\r\n\t\t\treturn 54; // 40 * 1.35\r\n\t\t}\r\n\t}\r\n\r\n\tmax *= 1.35;\r\n\r\n\t// And a min width\r\n\treturn max > 6 ? max : 6;\r\n}\r\n\r\n// Excel - Pre-defined strings to build a basic XLSX file\r\nvar excelStrings = {\r\n\t\"_rels/.rels\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\r\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\r\n\t\t'</Relationships>',\r\n\r\n\t\"xl/_rels/workbook.xml.rels\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\r\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\r\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\r\n\t\t'</Relationships>',\r\n\r\n\t\"[Content_Types].xml\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\r\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\r\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\r\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\r\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\r\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\r\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\r\n\t\t'</Types>',\r\n\r\n\t\"xl/workbook.xml\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\r\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\r\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\r\n\t\t\t'<bookViews>'+\r\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\r\n\t\t\t'</bookViews>'+\r\n\t\t\t'<sheets>'+\r\n\t\t\t\t'<sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/>'+\r\n\t\t\t'</sheets>'+\r\n\t\t\t'<definedNames/>'+\r\n\t\t'</workbook>',\r\n\r\n\t\"xl/worksheets/sheet1.xml\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\r\n\t\t\t'<sheetData/>'+\r\n\t\t\t'<mergeCells count=\"0\"/>'+\r\n\t\t'</worksheet>',\r\n\r\n\t\"xl/styles.xml\":\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\r\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\r\n\t\t\t'<numFmts count=\"6\">'+\r\n\t\t\t\t'<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>'+\r\n\t\t\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>'+\r\n\t\t\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>'+\r\n\t\t\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>'+\r\n\t\t\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>'+\r\n\t\t\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>'+\r\n\t\t\t'</numFmts>'+\r\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\r\n\t\t\t\t'<font>'+\r\n\t\t\t\t\t'<sz val=\"11\" />'+\r\n\t\t\t\t\t'<name val=\"Calibri\" />'+\r\n\t\t\t\t'</font>'+\r\n\t\t\t\t'<font>'+\r\n\t\t\t\t\t'<sz val=\"11\" />'+\r\n\t\t\t\t\t'<name val=\"Calibri\" />'+\r\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\r\n\t\t\t\t'</font>'+\r\n\t\t\t\t'<font>'+\r\n\t\t\t\t\t'<sz val=\"11\" />'+\r\n\t\t\t\t\t'<name val=\"Calibri\" />'+\r\n\t\t\t\t\t'<b />'+\r\n\t\t\t\t'</font>'+\r\n\t\t\t\t'<font>'+\r\n\t\t\t\t\t'<sz val=\"11\" />'+\r\n\t\t\t\t\t'<name val=\"Calibri\" />'+\r\n\t\t\t\t\t'<i />'+\r\n\t\t\t\t'</font>'+\r\n\t\t\t\t'<font>'+\r\n\t\t\t\t\t'<sz val=\"11\" />'+\r\n\t\t\t\t\t'<name val=\"Calibri\" />'+\r\n\t\t\t\t\t'<u />'+\r\n\t\t\t\t'</font>'+\r\n\t\t\t'</fonts>'+\r\n\t\t\t'<fills count=\"6\">'+\r\n\t\t\t\t'<fill>'+\r\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\r\n\t\t\t\t'</fill>'+\r\n\t\t\t\t'<fill>'+ // Excel appears to use this as a dotted background regardless of values but\r\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+ // to be valid to the schema, use a patternFill\r\n\t\t\t\t'</fill>'+\r\n\t\t\t\t'<fill>'+\r\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\r\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\r\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\r\n\t\t\t\t\t'</patternFill>'+\r\n\t\t\t\t'</fill>'+\r\n\t\t\t\t'<fill>'+\r\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\r\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\r\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\r\n\t\t\t\t\t'</patternFill>'+\r\n\t\t\t\t'</fill>'+\r\n\t\t\t\t'<fill>'+\r\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\r\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\r\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\r\n\t\t\t\t\t'</patternFill>'+\r\n\t\t\t\t'</fill>'+\r\n\t\t\t\t'<fill>'+\r\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\r\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\r\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\r\n\t\t\t\t\t'</patternFill>'+\r\n\t\t\t\t'</fill>'+\r\n\t\t\t'</fills>'+\r\n\t\t\t'<borders count=\"2\">'+\r\n\t\t\t\t'<border>'+\r\n\t\t\t\t\t'<left />'+\r\n\t\t\t\t\t'<right />'+\r\n\t\t\t\t\t'<top />'+\r\n\t\t\t\t\t'<bottom />'+\r\n\t\t\t\t\t'<diagonal />'+\r\n\t\t\t\t'</border>'+\r\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\r\n\t\t\t\t\t'<left style=\"thin\">'+\r\n\t\t\t\t\t\t'<color auto=\"1\" />'+\r\n\t\t\t\t\t'</left>'+\r\n\t\t\t\t\t'<right style=\"thin\">'+\r\n\t\t\t\t\t\t'<color auto=\"1\" />'+\r\n\t\t\t\t\t'</right>'+\r\n\t\t\t\t\t'<top style=\"thin\">'+\r\n\t\t\t\t\t\t'<color auto=\"1\" />'+\r\n\t\t\t\t\t'</top>'+\r\n\t\t\t\t\t'<bottom style=\"thin\">'+\r\n\t\t\t\t\t\t'<color auto=\"1\" />'+\r\n\t\t\t\t\t'</bottom>'+\r\n\t\t\t\t\t'<diagonal />'+\r\n\t\t\t\t'</border>'+\r\n\t\t\t'</borders>'+\r\n\t\t\t'<cellStyleXfs count=\"1\">'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\r\n\t\t\t'</cellStyleXfs>'+\r\n\t\t\t'<cellXfs count=\"68\">'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\r\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\r\n\t\t\t\t'</xf>'+\r\n\t\t\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"1\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"2\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t\t'<xf numFmtId=\"14\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\r\n\t\t\t'</cellXfs>'+\r\n\t\t\t'<cellStyles count=\"1\">'+\r\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\r\n\t\t\t'</cellStyles>'+\r\n\t\t\t'<dxfs count=\"0\" />'+\r\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\r\n\t\t'</styleSheet>'\r\n};\r\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\r\n// virtually no difference in size, since the above can be easily compressed\r\n\r\n// Pattern matching for special number formats. Perhaps this should be exposed\r\n// via an API in future?\r\n// Ref: section 3.8.30 - built in formatters in open spreadsheet\r\n//   https://www.ecma-international.org/news/TC45_current_work/Office%20Open%20XML%20Part%204%20-%20Markup%20Language%20Reference.pdf\r\nvar _excelSpecials = [\r\n\t{ match: /^\\-?\\d+\\.\\d%$/,               style: 60, fmt: function (d) { return d/100; } }, // Percent with d.p.\r\n\t{ match: /^\\-?\\d+\\.?\\d*%$/,             style: 56, fmt: function (d) { return d/100; } }, // Percent\r\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/,          style: 57 }, // Dollars\r\n\t{ match: /^\\-?£[\\d,]+.?\\d*$/,           style: 58 }, // Pounds\r\n\t{ match: /^\\-?€[\\d,]+.?\\d*$/,           style: 59 }, // Euros\r\n\t{ match: /^\\-?\\d+$/,                    style: 65 }, // Numbers without thousand separators\r\n\t{ match: /^\\-?\\d+\\.\\d{2}$/,             style: 66 }, // Numbers 2 d.p. without thousands separators\r\n\t{ match: /^\\([\\d,]+\\)$/,                style: 61, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets\r\n\t{ match: /^\\([\\d,]+\\.\\d{2}\\)$/,         style: 62, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets - 2d.p.\r\n\t{ match: /^\\-?[\\d,]+$/,                 style: 63 }, // Numbers with thousand separators\r\n\t{ match: /^\\-?[\\d,]+\\.\\d{2}$/,          style: 64 },\r\n\t{ match: /^[\\d]{4}\\-[01][\\d]\\-[0123][\\d]$/, style: 67, fmt: function (d) {return Math.round(25569 + (Date.parse(d) / (86400 * 1000)));}} //Date yyyy-mm-dd\r\n];\r\n\r\n\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Buttons\r\n */\r\n\r\n//\r\n// Copy to clipboard\r\n//\r\nDataTable.ext.buttons.copyHtml5 = {\r\n\tclassName: 'buttons-copy buttons-html5',\r\n\r\n\ttext: function ( dt ) {\r\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\r\n\t},\r\n\r\n\taction: function ( e, dt, button, config ) {\r\n\t\tthis.processing( true );\r\n\r\n\t\tvar that = this;\r\n\t\tvar exportData = _exportData( dt, config );\r\n\t\tvar info = dt.buttons.exportInfo( config );\r\n\t\tvar newline = _newLine(config);\r\n\t\tvar output = exportData.str;\r\n\t\tvar hiddenDiv = $('<div/>')\r\n\t\t\t.css( {\r\n\t\t\t\theight: 1,\r\n\t\t\t\twidth: 1,\r\n\t\t\t\toverflow: 'hidden',\r\n\t\t\t\tposition: 'fixed',\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t} );\r\n\r\n\t\tif ( info.title ) {\r\n\t\t\toutput = info.title + newline + newline + output;\r\n\t\t}\r\n\r\n\t\tif ( info.messageTop ) {\r\n\t\t\toutput = info.messageTop + newline + newline + output;\r\n\t\t}\r\n\r\n\t\tif ( info.messageBottom ) {\r\n\t\t\toutput = output + newline + newline + info.messageBottom;\r\n\t\t}\r\n\r\n\t\tif ( config.customize ) {\r\n\t\t\toutput = config.customize( output, config, dt );\r\n\t\t}\r\n\r\n\t\tvar textarea = $('<textarea readonly/>')\r\n\t\t\t.val( output )\r\n\t\t\t.appendTo( hiddenDiv );\r\n\r\n\t\t// For browsers that support the copy execCommand, try to use it\r\n\t\tif ( document.queryCommandSupported('copy') ) {\r\n\t\t\thiddenDiv.appendTo( dt.table().container() );\r\n\t\t\ttextarea[0].focus();\r\n\t\t\ttextarea[0].select();\r\n\r\n\t\t\ttry {\r\n\t\t\t\tvar successful = document.execCommand( 'copy' );\r\n\t\t\t\thiddenDiv.remove();\r\n\r\n\t\t\t\tif (successful) {\r\n\t\t\t\t\tdt.buttons.info(\r\n\t\t\t\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\r\n\t\t\t\t\t\tdt.i18n( 'buttons.copySuccess', {\r\n\t\t\t\t\t\t\t1: 'Copied one row to clipboard',\r\n\t\t\t\t\t\t\t_: 'Copied %d rows to clipboard'\r\n\t\t\t\t\t\t}, exportData.rows ),\r\n\t\t\t\t\t\t2000\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.processing( false );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (t) {}\r\n\t\t}\r\n\r\n\t\t// Otherwise we show the text box and instruct the user to use it\r\n\t\tvar message = $('<span>'+dt.i18n( 'buttons.copyKeys',\r\n\t\t\t\t'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>'+\r\n\t\t\t\t'To cancel, click this message or press escape.' )+'</span>'\r\n\t\t\t)\r\n\t\t\t.append( hiddenDiv );\r\n\r\n\t\tdt.buttons.info( dt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ), message, 0 );\r\n\r\n\t\t// Select the text so when the user activates their system clipboard\r\n\t\t// it will copy that text\r\n\t\ttextarea[0].focus();\r\n\t\ttextarea[0].select();\r\n\r\n\t\t// Event to hide the message when the user is done\r\n\t\tvar container = $(message).closest('.dt-button-info');\r\n\t\tvar close = function () {\r\n\t\t\tcontainer.off( 'click.buttons-copy' );\r\n\t\t\t$(document).off( '.buttons-copy' );\r\n\t\t\tdt.buttons.info( false );\r\n\t\t};\r\n\r\n\t\tcontainer.on( 'click.buttons-copy', close );\r\n\t\t$(document)\r\n\t\t\t.on( 'keydown.buttons-copy', function (e) {\r\n\t\t\t\tif ( e.keyCode === 27 ) { // esc\r\n\t\t\t\t\tclose();\r\n\t\t\t\t\tthat.processing( false );\r\n\t\t\t\t}\r\n\t\t\t} )\r\n\t\t\t.on( 'copy.buttons-copy cut.buttons-copy', function () {\r\n\t\t\t\tclose();\r\n\t\t\t\tthat.processing( false );\r\n\t\t\t} );\r\n\t},\r\n\r\n\texportOptions: {},\r\n\r\n\tfieldSeparator: '\\t',\r\n\r\n\tfieldBoundary: '',\r\n\r\n\theader: true,\r\n\r\n\tfooter: false,\r\n\r\n\ttitle: '*',\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*'\r\n};\r\n\r\n//\r\n// CSV export\r\n//\r\nDataTable.ext.buttons.csvHtml5 = {\r\n\tbom: false,\r\n\r\n\tclassName: 'buttons-csv buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn window.FileReader !== undefined && window.Blob;\r\n\t},\r\n\r\n\ttext: function ( dt ) {\r\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\r\n\t},\r\n\r\n\taction: function ( e, dt, button, config ) {\r\n\t\tthis.processing( true );\r\n\r\n\t\t// Set the text\r\n\t\tvar output = _exportData( dt, config ).str;\r\n\t\tvar info = dt.buttons.exportInfo(config);\r\n\t\tvar charset = config.charset;\r\n\r\n\t\tif ( config.customize ) {\r\n\t\t\toutput = config.customize( output, config, dt );\r\n\t\t}\r\n\r\n\t\tif ( charset !== false ) {\r\n\t\t\tif ( ! charset ) {\r\n\t\t\t\tcharset = document.characterSet || document.charset;\r\n\t\t\t}\r\n\r\n\t\t\tif ( charset ) {\r\n\t\t\t\tcharset = ';charset='+charset;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcharset = '';\r\n\t\t}\r\n\r\n\t\tif ( config.bom ) {\r\n\t\t\toutput = String.fromCharCode(0xFEFF) + output;\r\n\t\t}\r\n\r\n\t\t_saveAs(\r\n\t\t\tnew Blob( [output], {type: 'text/csv'+charset} ),\r\n\t\t\tinfo.filename,\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\tthis.processing( false );\r\n\t},\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.csv',\r\n\r\n\texportOptions: {},\r\n\r\n\tfieldSeparator: ',',\r\n\r\n\tfieldBoundary: '\"',\r\n\r\n\tescapeChar: '\"',\r\n\r\n\tcharset: null,\r\n\r\n\theader: true,\r\n\r\n\tfooter: false\r\n};\r\n\r\n//\r\n// Excel (xlsx) export\r\n//\r\nDataTable.ext.buttons.excelHtml5 = {\r\n\tclassName: 'buttons-excel buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn window.FileReader !== undefined && _jsZip() !== undefined && ! _isDuffSafari() && _serialiser;\r\n\t},\r\n\r\n\ttext: function ( dt ) {\r\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\r\n\t},\r\n\r\n\taction: function ( e, dt, button, config ) {\r\n\t\tthis.processing( true );\r\n\r\n\t\tvar that = this;\r\n\t\tvar rowPos = 0;\r\n\t\tvar dataStartRow, dataEndRow;\r\n\t\tvar getXml = function ( type ) {\r\n\t\t\tvar str = excelStrings[ type ];\r\n\r\n\t\t\t//str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\r\n\r\n\t\t\treturn $.parseXML( str );\r\n\t\t};\r\n\t\tvar rels = getXml('xl/worksheets/sheet1.xml');\r\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\r\n\r\n\t\tvar xlsx = {\r\n\t\t\t_rels: {\r\n\t\t\t\t\".rels\": getXml('_rels/.rels')\r\n\t\t\t},\r\n\t\t\txl: {\r\n\t\t\t\t_rels: {\r\n\t\t\t\t\t\"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\r\n\t\t\t\t},\r\n\t\t\t\t\"workbook.xml\": getXml('xl/workbook.xml'),\r\n\t\t\t\t\"styles.xml\": getXml('xl/styles.xml'),\r\n\t\t\t\t\"worksheets\": {\r\n\t\t\t\t\t\"sheet1.xml\": rels\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\t\"[Content_Types].xml\": getXml('[Content_Types].xml')\r\n\t\t};\r\n\r\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\r\n\t\tvar currentRow, rowNode;\r\n\t\tvar addRow = function ( row ) {\r\n\t\t\tcurrentRow = rowPos+1;\r\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\r\n\r\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\r\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\r\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\r\n\t\t\t\tvar cell = null;\r\n\r\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\r\n\t\t\t\tif ( row[i] === null || row[i] === undefined || row[i] === '' ) {\r\n\t\t\t\t\tif ( config.createEmptyCells === true ) {\r\n\t\t\t\t\t\trow[i] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar originalContent = row[i];\r\n\t\t\t\trow[i] = typeof row[i].trim === 'function'\r\n\t\t\t\t\t? row[i].trim()\r\n\t\t\t\t\t: row[i];\r\n\r\n\t\t\t\t// Special number formatting options\r\n\t\t\t\tfor ( var j=0, jen=_excelSpecials.length ; j<jen ; j++ ) {\r\n\t\t\t\t\tvar special = _excelSpecials[j];\r\n\r\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\r\n\t\t\t\t\t// if they are returning a string, since at the moment it is\r\n\t\t\t\t\t// assumed to be a number\r\n\t\t\t\t\tif ( row[i].match && ! row[i].match(/^0\\d+/) && row[i].match( special.match ) ) {\r\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\r\n\r\n\t\t\t\t\t\tif ( special.fmt ) {\r\n\t\t\t\t\t\t\tval = special.fmt( val );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tr: cellId,\r\n\t\t\t\t\t\t\t\ts: special.style\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: val } )\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! cell ) {\r\n\t\t\t\t\tif ( typeof row[i] === 'number' || (\r\n\t\t\t\t\t\trow[i].match &&\r\n\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?([eE]\\-?\\d+)?$/) && // Includes exponential format\r\n\t\t\t\t\t\t! row[i].match(/^0\\d+/) )\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\r\n\t\t\t\t\t\t// or a negative anywhere but the start\r\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tt: 'n',\r\n\t\t\t\t\t\t\t\tr: cellId\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// String output - replace non standard characters for text output\r\n\t\t\t\t\t\tvar text = ! originalContent.replace ?\r\n\t\t\t\t\t\t\toriginalContent :\r\n\t\t\t\t\t\t\toriginalContent.replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\r\n\r\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tt: 'inlineStr',\r\n\t\t\t\t\t\t\t\tr: cellId\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren:{\r\n\t\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\r\n\t\t\t\t\t\t\t\t\tchildren: {\r\n\t\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\r\n\t\t\t\t\t\t\t\t\t\t\ttext: text,\r\n\t\t\t\t\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t'xml:space': 'preserve'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\trowNode.appendChild( cell );\r\n\t\t\t}\r\n\r\n\t\t\trelsGet.appendChild(rowNode);\r\n\t\t\trowPos++;\r\n\t\t};\r\n\r\n\t\tif ( config.customizeData ) {\r\n\t\t\tconfig.customizeData( data );\r\n\t\t}\r\n\r\n\t\tvar mergeCells = function ( row, colspan ) {\r\n\t\t\tvar mergeCells = $('mergeCells', rels);\r\n\r\n\t\t\tmergeCells[0].appendChild( _createNode( rels, 'mergeCell', {\r\n\t\t\t\tattr: {\r\n\t\t\t\t\tref: 'A'+row+':'+createCellPos(colspan)+row\r\n\t\t\t\t}\r\n\t\t\t} ) );\r\n\t\t\tmergeCells.attr( 'count', parseFloat(mergeCells.attr( 'count' ))+1 );\r\n\t\t\t$('row:eq('+(row-1)+') c', rels).attr( 's', '51' ); // centre\r\n\t\t};\r\n\r\n\t\t// Title and top messages\r\n\t\tvar exportInfo = dt.buttons.exportInfo( config );\r\n\t\tif ( exportInfo.title ) {\r\n\t\t\taddRow( [exportInfo.title], rowPos );\r\n\t\t\tmergeCells( rowPos, data.header.length-1 );\r\n\t\t}\r\n\r\n\t\tif ( exportInfo.messageTop ) {\r\n\t\t\taddRow( [exportInfo.messageTop], rowPos );\r\n\t\t\tmergeCells( rowPos, data.header.length-1 );\r\n\t\t}\r\n\r\n\r\n\t\t// Table itself\r\n\t\tif ( config.header ) {\r\n\t\t\taddRow( data.header, rowPos );\r\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\r\n\t\t}\r\n\t\r\n\t\tdataStartRow = rowPos;\r\n\r\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\r\n\t\t\taddRow( data.body[n], rowPos );\r\n\t\t}\r\n\t\r\n\t\tdataEndRow = rowPos;\r\n\r\n\t\tif ( config.footer && data.footer ) {\r\n\t\t\taddRow( data.footer, rowPos);\r\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\r\n\t\t}\r\n\r\n\t\t// Below the table\r\n\t\tif ( exportInfo.messageBottom ) {\r\n\t\t\taddRow( [exportInfo.messageBottom], rowPos );\r\n\t\t\tmergeCells( rowPos, data.header.length-1 );\r\n\t\t}\r\n\r\n\t\t// Set column widths\r\n\t\tvar cols = _createNode( rels, 'cols' );\r\n\t\t$('worksheet', rels).prepend( cols );\r\n\r\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\r\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\r\n\t\t\t\tattr: {\r\n\t\t\t\t\tmin: i+1,\r\n\t\t\t\t\tmax: i+1,\r\n\t\t\t\t\twidth: _excelColWidth( data, i ),\r\n\t\t\t\t\tcustomWidth: 1\r\n\t\t\t\t}\r\n\t\t\t} ) );\r\n\t\t}\r\n\r\n\t\t// Workbook modifications\r\n\t\tvar workbook = xlsx.xl['workbook.xml'];\r\n\r\n\t\t$( 'sheets sheet', workbook ).attr( 'name', _sheetname( config ) );\r\n\r\n\t\t// Auto filter for columns\r\n\t\tif ( config.autoFilter ) {\r\n\t\t\t$('mergeCells', rels).before( _createNode( rels, 'autoFilter', {\r\n\t\t\t\tattr: {\r\n\t\t\t\t\tref: 'A'+dataStartRow+':'+createCellPos(data.header.length-1)+dataEndRow\r\n\t\t\t\t}\r\n\t\t\t} ) );\r\n\r\n\t\t\t$('definedNames', workbook).append( _createNode( workbook, 'definedName', {\r\n\t\t\t\tattr: {\r\n\t\t\t\t\tname: '_xlnm._FilterDatabase',\r\n\t\t\t\t\tlocalSheetId: '0',\r\n\t\t\t\t\thidden: 1\r\n\t\t\t\t},\r\n\t\t\t\ttext: _sheetname(config)+'!$A$'+dataStartRow+':'+createCellPos(data.header.length-1)+dataEndRow\r\n\t\t\t} ) );\r\n\t\t}\r\n\r\n\t\t// Let the developer customise the document if they want to\r\n\t\tif ( config.customize ) {\r\n\t\t\tconfig.customize( xlsx, config, dt );\r\n\t\t}\r\n\r\n\t\t// Excel doesn't like an empty mergeCells tag\r\n\t\tif ( $('mergeCells', rels).children().length === 0 ) {\r\n\t\t\t$('mergeCells', rels).remove();\r\n\t\t}\r\n\r\n\t\tvar jszip = _jsZip();\r\n\t\tvar zip = new jszip();\r\n\t\tvar zipConfig = {\r\n\t\t\tcompression: \"DEFLATE\",\r\n\t\t\ttype: 'blob',\r\n\t\t\tmimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n\t\t};\r\n\r\n\t\t_addToZip( zip, xlsx );\r\n\r\n\t\t// Modern Excel has a 218 character limit on the file name + path of the file (why!?)\r\n\t\t// https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\r\n\t\t// So we truncate to allow for this.\r\n\t\tvar filename = exportInfo.filename;\r\n\r\n\t\tif (filename > 175) {\r\n\t\t\tfilename = filename.substr(0, 175);\r\n\t\t}\r\n\r\n\t\tif ( zip.generateAsync ) {\r\n\t\t\t// JSZip 3+\r\n\t\t\tzip\r\n\t\t\t\t.generateAsync( zipConfig )\r\n\t\t\t\t.then( function ( blob ) {\r\n\t\t\t\t\t_saveAs( blob, filename );\r\n\t\t\t\t\tthat.processing( false );\r\n\t\t\t\t} );\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// JSZip 2.5\r\n\t\t\t_saveAs(\r\n\t\t\t\tzip.generate( zipConfig ),\r\n\t\t\t\tfilename\r\n\t\t\t);\r\n\t\t\tthis.processing( false );\r\n\t\t}\r\n\t},\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.xlsx',\r\n\r\n\texportOptions: {},\r\n\r\n\theader: true,\r\n\r\n\tfooter: false,\r\n\r\n\ttitle: '*',\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*',\r\n\r\n\tcreateEmptyCells: false,\r\n\r\n\tautoFilter: false,\r\n\r\n\tsheetName: ''\r\n};\r\n\r\n//\r\n// PDF export - using pdfMake - http://pdfmake.org\r\n//\r\nDataTable.ext.buttons.pdfHtml5 = {\r\n\tclassName: 'buttons-pdf buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn window.FileReader !== undefined && _pdfMake();\r\n\t},\r\n\r\n\ttext: function ( dt ) {\r\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\r\n\t},\r\n\r\n\taction: function ( e, dt, button, config ) {\r\n\t\tthis.processing( true );\r\n\r\n\t\tvar that = this;\r\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\r\n\t\tvar info = dt.buttons.exportInfo( config );\r\n\t\tvar rows = [];\r\n\r\n\t\tif ( config.header ) {\r\n\t\t\trows.push( $.map( data.header, function ( d ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\r\n\t\t\t\t\tstyle: 'tableHeader'\r\n\t\t\t\t};\r\n\t\t\t} ) );\r\n\t\t}\r\n\r\n\t\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\r\n\t\t\trows.push( $.map( data.body[i], function ( d ) {\r\n\t\t\t\tif ( d === null || d === undefined ) {\r\n\t\t\t\t\td = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\r\n\t\t\t\t\tstyle: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\r\n\t\t\t\t};\r\n\t\t\t} ) );\r\n\t\t}\r\n\r\n\t\tif ( config.footer && data.footer) {\r\n\t\t\trows.push( $.map( data.footer, function ( d ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\r\n\t\t\t\t\tstyle: 'tableFooter'\r\n\t\t\t\t};\r\n\t\t\t} ) );\r\n\t\t}\r\n\r\n\t\tvar doc = {\r\n\t\t\tpageSize: config.pageSize,\r\n\t\t\tpageOrientation: config.orientation,\r\n\t\t\tcontent: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttable: {\r\n\t\t\t\t\t\theaderRows: 1,\r\n\t\t\t\t\t\tbody: rows\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlayout: 'noBorders'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tstyles: {\r\n\t\t\t\ttableHeader: {\r\n\t\t\t\t\tbold: true,\r\n\t\t\t\t\tfontSize: 11,\r\n\t\t\t\t\tcolor: 'white',\r\n\t\t\t\t\tfillColor: '#2d4154',\r\n\t\t\t\t\talignment: 'center'\r\n\t\t\t\t},\r\n\t\t\t\ttableBodyEven: {},\r\n\t\t\t\ttableBodyOdd: {\r\n\t\t\t\t\tfillColor: '#f3f3f3'\r\n\t\t\t\t},\r\n\t\t\t\ttableFooter: {\r\n\t\t\t\t\tbold: true,\r\n\t\t\t\t\tfontSize: 11,\r\n\t\t\t\t\tcolor: 'white',\r\n\t\t\t\t\tfillColor: '#2d4154'\r\n\t\t\t\t},\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\talignment: 'center',\r\n\t\t\t\t\tfontSize: 15\r\n\t\t\t\t},\r\n\t\t\t\tmessage: {}\r\n\t\t\t},\r\n\t\t\tdefaultStyle: {\r\n\t\t\t\tfontSize: 10\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif ( info.messageTop ) {\r\n\t\t\tdoc.content.unshift( {\r\n\t\t\t\ttext: info.messageTop,\r\n\t\t\t\tstyle: 'message',\r\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tif ( info.messageBottom ) {\r\n\t\t\tdoc.content.push( {\r\n\t\t\t\ttext: info.messageBottom,\r\n\t\t\t\tstyle: 'message',\r\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tif ( info.title ) {\r\n\t\t\tdoc.content.unshift( {\r\n\t\t\t\ttext: info.title,\r\n\t\t\t\tstyle: 'title',\r\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tif ( config.customize ) {\r\n\t\t\tconfig.customize( doc, config, dt );\r\n\t\t}\r\n\r\n\t\tvar pdf = _pdfMake().createPdf( doc );\r\n\r\n\t\tif ( config.download === 'open' && ! _isDuffSafari() ) {\r\n\t\t\tpdf.open();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpdf.download( info.filename );\r\n\t\t}\r\n\r\n\t\tthis.processing( false );\r\n\t},\r\n\r\n\ttitle: '*',\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.pdf',\r\n\r\n\texportOptions: {},\r\n\r\n\torientation: 'portrait',\r\n\r\n\tpageSize: 'A4',\r\n\r\n\theader: true,\r\n\r\n\tfooter: false,\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*',\r\n\r\n\tcustomize: null,\r\n\r\n\tdownload: 'download'\r\n};\r\n\r\n\r\nexport default DataTable;\r\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAOA,CAAC,MAAM,QAAQ;AACtB,OAAOC,SAAS,MAAM,gBAAgB;AACtC,OAAOC,OAAO,MAAM,wBAAwB;;AAG5C;AACA;AACA,IAAIC,QAAQ;AACZ,IAAIC,UAAU;AAEd,SAASC,MAAM,GAAI;EAClB,OAAOF,QAAQ,IAAIG,MAAM,CAACC,KAAK;AAChC;AACA,SAASC,QAAQ,GAAI;EACpB,OAAOJ,UAAU,IAAIE,MAAM,CAACG,OAAO;AACpC;AAEAR,SAAS,CAACC,OAAO,CAACO,OAAO,GAAG,UAAUC,CAAC,EAAE;EACxC,IAAK,CAAEA,CAAC,EAAG;IACV,OAAOF,QAAQ,EAAE;EAClB;EACAJ,UAAU,GAAGM,CAAC;AACf,CAAC;AAEDT,SAAS,CAACC,OAAO,CAACS,KAAK,GAAG,UAAUD,CAAC,EAAE;EACtC,IAAK,CAAEA,CAAC,EAAG;IACV,OAAOL,MAAM,EAAE;EAChB;EACAF,QAAQ,GAAGO,CAAC;AACb,CAAC;;AAGD;AACA;AACA;;AAEA;;AAEA,IAAIE,OAAO,GAAI,UAASC,IAAI,EAAE;EAC7B,YAAY;;EACZ;EACA,IAAI,OAAOA,IAAI,KAAK,WAAW,IAAI,OAAOC,SAAS,KAAK,WAAW,IAAI,cAAc,CAACC,IAAI,CAACD,SAAS,CAACE,SAAS,CAAC,EAAE;IAChH;EACD;EACA,IACGC,GAAG,GAAGJ,IAAI,CAACK;IACX;IAAA;IACAC,OAAO,GAAG,YAAW;MACtB,OAAON,IAAI,CAACO,GAAG,IAAIP,IAAI,CAACQ,SAAS,IAAIR,IAAI;IAC1C,CAAC;IACCS,SAAS,GAAGL,GAAG,CAACM,eAAe,CAAC,8BAA8B,EAAE,GAAG,CAAC;IACpEC,iBAAiB,IAAG,UAAU,IAAIF,SAAS;IAC3CG,KAAK,GAAG,UAASC,IAAI,EAAE;MACxB,IAAIC,KAAK,GAAG,IAAIC,UAAU,CAAC,OAAO,CAAC;MACnCF,IAAI,CAACG,aAAa,CAACF,KAAK,CAAC;IAC1B,CAAC;IACCG,SAAS,GAAG,cAAc,CAACf,IAAI,CAACF,IAAI,CAACkB,WAAW,CAAC,IAAIlB,IAAI,CAACmB,MAAM;IAChEC,aAAa,GAAE,cAAc,CAAClB,IAAI,CAACD,SAAS,CAACE,SAAS,CAAC;IACvDkB,aAAa,GAAG,UAASC,EAAE,EAAE;MAC9B,CAACtB,IAAI,CAACuB,YAAY,IAAIvB,IAAI,CAACwB,UAAU,EAAE,YAAW;QACjD,MAAMF,EAAE;MACT,CAAC,EAAE,CAAC,CAAC;IACN,CAAC;IACCG,mBAAmB,GAAG;IACxB;IAAA;IACEC,wBAAwB,GAAG,IAAI,GAAG,EAAE,CAAC;IAAA;IACrCC,MAAM,GAAG,UAASC,IAAI,EAAE;MACzB,IAAIC,OAAO,GAAG,YAAW;QACxB,IAAI,OAAOD,IAAI,KAAK,QAAQ,EAAE;UAAE;UAC/BtB,OAAO,EAAE,CAACwB,eAAe,CAACF,IAAI,CAAC;QAChC,CAAC,MAAM;UAAE;UACRA,IAAI,CAACG,MAAM,EAAE;QACd;MACD,CAAC;MACDP,UAAU,CAACK,OAAO,EAAEH,wBAAwB,CAAC;IAC9C,CAAC;IACCM,QAAQ,GAAG,UAASC,SAAS,EAAEC,WAAW,EAAEpB,KAAK,EAAE;MACpDoB,WAAW,GAAG,EAAE,CAACC,MAAM,CAACD,WAAW,CAAC;MACpC,IAAIE,CAAC,GAAGF,WAAW,CAACG,MAAM;MAC1B,OAAOD,CAAC,EAAE,EAAE;QACX,IAAIE,QAAQ,GAAGL,SAAS,CAAC,IAAI,GAAGC,WAAW,CAACE,CAAC,CAAC,CAAC;QAC/C,IAAI,OAAOE,QAAQ,KAAK,UAAU,EAAE;UACnC,IAAI;YACHA,QAAQ,CAACC,IAAI,CAACN,SAAS,EAAEnB,KAAK,IAAImB,SAAS,CAAC;UAC7C,CAAC,CAAC,OAAOX,EAAE,EAAE;YACZD,aAAa,CAACC,EAAE,CAAC;UAClB;QACD;MACD;IACD,CAAC;IACCkB,QAAQ,GAAG,UAASC,IAAI,EAAE;MAC3B;MACA;MACA,IAAI,4EAA4E,CAACvC,IAAI,CAACuC,IAAI,CAACC,IAAI,CAAC,EAAE;QACjG,OAAO,IAAIC,IAAI,CAAC,CAACC,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC,EAAEJ,IAAI,CAAC,EAAE;UAACC,IAAI,EAAED,IAAI,CAACC;QAAI,CAAC,CAAC;MACxE;MACA,OAAOD,IAAI;IACZ,CAAC;IACCK,SAAS,GAAG,UAASL,IAAI,EAAEM,IAAI,EAAEC,WAAW,EAAE;MAC/C,IAAI,CAACA,WAAW,EAAE;QACjBP,IAAI,GAAGD,QAAQ,CAACC,IAAI,CAAC;MACtB;MACA;MACA,IACGR,SAAS,GAAG,IAAI;QAChBS,IAAI,GAAGD,IAAI,CAACC,IAAI;QAChBO,KAAK,GAAGP,IAAI,KAAKjB,mBAAmB;QACpCyB,UAAU;QACVC,YAAY,GAAG,YAAW;UAC3BnB,QAAQ,CAACC,SAAS,EAAE,oCAAoC,CAACmB,KAAK,CAAC,GAAG,CAAC,CAAC;QACrE;QACA;QAAA;QACEC,QAAQ,GAAG,YAAW;UACvB,IAAI,CAACjC,aAAa,IAAK6B,KAAK,IAAIhC,SAAU,KAAKjB,IAAI,CAACsD,UAAU,EAAE;YAC/D;YACA,IAAIC,MAAM,GAAG,IAAID,UAAU,EAAE;YAC7BC,MAAM,CAACC,SAAS,GAAG,YAAW;cAC7B,IAAIC,GAAG,GAAGrC,aAAa,GAAGmC,MAAM,CAACG,MAAM,GAAGH,MAAM,CAACG,MAAM,CAACC,OAAO,CAAC,cAAc,EAAE,uBAAuB,CAAC;cACxG,IAAIC,KAAK,GAAG5D,IAAI,CAAC6D,IAAI,CAACJ,GAAG,EAAE,QAAQ,CAAC;cACpC,IAAG,CAACG,KAAK,EAAE5D,IAAI,CAAC8D,QAAQ,CAACC,IAAI,GAAGN,GAAG;cACnCA,GAAG,GAACO,SAAS,CAAC,CAAC;cACf/B,SAAS,CAACgC,UAAU,GAAGhC,SAAS,CAACiC,IAAI;cACrCf,YAAY,EAAE;YACf,CAAC;YACDI,MAAM,CAACY,aAAa,CAAC1B,IAAI,CAAC;YAC1BR,SAAS,CAACgC,UAAU,GAAGhC,SAAS,CAACmC,IAAI;YACrC;UACD;UACA;UACA,IAAI,CAAClB,UAAU,EAAE;YAChBA,UAAU,GAAG5C,OAAO,EAAE,CAAC+D,eAAe,CAAC5B,IAAI,CAAC;UAC7C;UACA,IAAIQ,KAAK,EAAE;YACVjD,IAAI,CAAC8D,QAAQ,CAACC,IAAI,GAAGb,UAAU;UAChC,CAAC,MAAM;YACN,IAAIoB,MAAM,GAAGtE,IAAI,CAAC6D,IAAI,CAACX,UAAU,EAAE,QAAQ,CAAC;YAC5C,IAAI,CAACoB,MAAM,EAAE;cACZ;cACAtE,IAAI,CAAC8D,QAAQ,CAACC,IAAI,GAAGb,UAAU;YAChC;UACD;UACAjB,SAAS,CAACgC,UAAU,GAAGhC,SAAS,CAACiC,IAAI;UACrCf,YAAY,EAAE;UACdxB,MAAM,CAACuB,UAAU,CAAC;QACnB,CAAC;MAEFjB,SAAS,CAACgC,UAAU,GAAGhC,SAAS,CAACmC,IAAI;MAErC,IAAIzD,iBAAiB,EAAE;QACtBuC,UAAU,GAAG5C,OAAO,EAAE,CAAC+D,eAAe,CAAC5B,IAAI,CAAC;QAC5CjB,UAAU,CAAC,YAAW;UACrBf,SAAS,CAACsD,IAAI,GAAGb,UAAU;UAC3BzC,SAAS,CAAC8D,QAAQ,GAAGxB,IAAI;UACzBnC,KAAK,CAACH,SAAS,CAAC;UAChB0C,YAAY,EAAE;UACdxB,MAAM,CAACuB,UAAU,CAAC;UAClBjB,SAAS,CAACgC,UAAU,GAAGhC,SAAS,CAACiC,IAAI;QACtC,CAAC,CAAC;QACF;MACD;MAEAb,QAAQ,EAAE;IACX,CAAC;IACCmB,QAAQ,GAAG1B,SAAS,CAAC2B,SAAS;IAC9BC,MAAM,GAAG,UAASjC,IAAI,EAAEM,IAAI,EAAEC,WAAW,EAAE;MAC5C,OAAO,IAAIF,SAAS,CAACL,IAAI,EAAEM,IAAI,IAAIN,IAAI,CAACM,IAAI,IAAI,UAAU,EAAEC,WAAW,CAAC;IACzE,CAAC;EAEF;EACA,IAAI,OAAO/C,SAAS,KAAK,WAAW,IAAIA,SAAS,CAAC0E,gBAAgB,EAAE;IACnE,OAAO,UAASlC,IAAI,EAAEM,IAAI,EAAEC,WAAW,EAAE;MACxCD,IAAI,GAAGA,IAAI,IAAIN,IAAI,CAACM,IAAI,IAAI,UAAU;MAEtC,IAAI,CAACC,WAAW,EAAE;QACjBP,IAAI,GAAGD,QAAQ,CAACC,IAAI,CAAC;MACtB;MACA,OAAOxC,SAAS,CAAC0E,gBAAgB,CAAClC,IAAI,EAAEM,IAAI,CAAC;IAC9C,CAAC;EACF;EAEAyB,QAAQ,CAACI,KAAK,GAAG,YAAU,CAAC,CAAC;EAC7BJ,QAAQ,CAACP,UAAU,GAAGO,QAAQ,CAACJ,IAAI,GAAG,CAAC;EACvCI,QAAQ,CAACK,OAAO,GAAG,CAAC;EACpBL,QAAQ,CAACN,IAAI,GAAG,CAAC;EAEjBM,QAAQ,CAACM,KAAK,GACdN,QAAQ,CAACO,YAAY,GACrBP,QAAQ,CAACQ,UAAU,GACnBR,QAAQ,CAACS,OAAO,GAChBT,QAAQ,CAACU,OAAO,GAChBV,QAAQ,CAACW,OAAO,GAChBX,QAAQ,CAACY,UAAU,GAClB,IAAI;EAEL,OAAOV,MAAM;AACd,CAAC,CACG,OAAOW,IAAI,KAAK,WAAW,IAAIA,IAAI,IACnC,OAAO5F,MAAM,KAAK,WAAW,IAAIA,MAAM,IACvC,IAAI,CAAC6F,OAAO,CACd;;AAGF;AACA;AACAlG,SAAS,CAACmG,QAAQ,GAAGxF,OAAO;;AAG5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAIyF,UAAU,GAAG,UAAWC,MAAM,EAClC;EACC,IAAIC,SAAS,GAAG,QAAQ;EAExB,IAAKD,MAAM,CAACC,SAAS,EAAG;IACvBA,SAAS,GAAGD,MAAM,CAACC,SAAS,CAAC/B,OAAO,CAAC,mBAAmB,EAAE,EAAE,CAAC;EAC9D;EAEA,OAAO+B,SAAS;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,QAAQ,GAAG,UAAWF,MAAM,EAChC;EACC,OAAOA,MAAM,CAACG,OAAO,GACpBH,MAAM,CAACG,OAAO,GACd3F,SAAS,CAACE,SAAS,CAAC0F,KAAK,CAAC,SAAS,CAAC,GACnC,MAAM,GACN,IAAI;AACP,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,WAAW,GAAG,UAAWC,EAAE,EAAEN,MAAM,EACvC;EACC,IAAIO,OAAO,GAAGL,QAAQ,CAAEF,MAAM,CAAE;EAChC,IAAIQ,IAAI,GAAGF,EAAE,CAACG,OAAO,CAACC,UAAU,CAAEV,MAAM,CAACW,aAAa,CAAE;EACxD,IAAIC,QAAQ,GAAGZ,MAAM,CAACa,aAAa;EACnC,IAAIC,SAAS,GAAGd,MAAM,CAACe,cAAc;EACrC,IAAIC,UAAU,GAAG,IAAIC,MAAM,CAAEL,QAAQ,EAAE,GAAG,CAAE;EAC5C,IAAIM,UAAU,GAAGlB,MAAM,CAACkB,UAAU,KAAK3C,SAAS,GAC/CyB,MAAM,CAACkB,UAAU,GACjB,IAAI;EACL,IAAIC,IAAI,GAAG,UAAWC,CAAC,EAAG;IACzB,IAAIC,CAAC,GAAG,EAAE;;IAEV;IACA;IACA,KAAM,IAAI1E,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACF,CAAC,CAACxE,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;MAC3C,IAAKA,CAAC,GAAG,CAAC,EAAG;QACZ0E,CAAC,IAAIP,SAAS;MACf;MAEAO,CAAC,IAAIT,QAAQ,GACZA,QAAQ,GAAG,CAAC,EAAE,GAAGQ,CAAC,CAACzE,CAAC,CAAC,EAAEuB,OAAO,CAAE8C,UAAU,EAAEE,UAAU,GAACN,QAAQ,CAAE,GAAGA,QAAQ,GAC5EQ,CAAC,CAACzE,CAAC,CAAC;IACN;IAEA,OAAO0E,CAAC;EACT,CAAC;EAED,IAAIE,MAAM,GAAGvB,MAAM,CAACuB,MAAM,GAAGJ,IAAI,CAAEX,IAAI,CAACe,MAAM,CAAE,GAAChB,OAAO,GAAG,EAAE;EAC7D,IAAIiB,MAAM,GAAGxB,MAAM,CAACwB,MAAM,IAAIhB,IAAI,CAACgB,MAAM,GAAGjB,OAAO,GAACY,IAAI,CAAEX,IAAI,CAACgB,MAAM,CAAE,GAAG,EAAE;EAC5E,IAAIC,IAAI,GAAG,EAAE;EAEb,KAAM,IAAI9E,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACd,IAAI,CAACiB,IAAI,CAAC7E,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;IACnD8E,IAAI,CAACC,IAAI,CAAEP,IAAI,CAAEX,IAAI,CAACiB,IAAI,CAAC9E,CAAC,CAAC,CAAE,CAAE;EAClC;EAEA,OAAO;IACNgF,GAAG,EAAEJ,MAAM,GAAGE,IAAI,CAACN,IAAI,CAAEZ,OAAO,CAAE,GAAGiB,MAAM;IAC3CI,IAAI,EAAEH,IAAI,CAAC7E;EACZ,CAAC;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAIiF,aAAa,GAAG,YACpB;EACC,IAAInG,MAAM,GAAGlB,SAAS,CAACE,SAAS,CAACoH,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IACxDtH,SAAS,CAACE,SAAS,CAACoH,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAC5CtH,SAAS,CAACE,SAAS,CAACoH,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;EAE5C,IAAK,CAAEpG,MAAM,EAAG;IACf,OAAO,KAAK;EACb;EAEA,IAAIqG,OAAO,GAAGvH,SAAS,CAACE,SAAS,CAAC0F,KAAK,CAAE,yBAAyB,CAAE;EACpE,IAAK2B,OAAO,IAAIA,OAAO,CAACnF,MAAM,GAAG,CAAC,IAAImF,OAAO,CAAC,CAAC,CAAC,GAAC,CAAC,GAAG,KAAK,EAAG;IAC5D,OAAO,IAAI;EACZ;EAEA,OAAO,KAAK;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,SAASC,aAAa,CAAEC,CAAC,EAAE;EAC1B,IAAIC,IAAI,GAAG,GAAG,CAACC,UAAU,CAAC,CAAC,CAAC;EAC5B,IAAIC,IAAI,GAAG,GAAG,CAACD,UAAU,CAAC,CAAC,CAAC;EAC5B,IAAIE,GAAG,GAAGD,IAAI,GAAGF,IAAI,GAAG,CAAC;EACzB,IAAIb,CAAC,GAAG,EAAE;EAEV,OAAOY,CAAC,IAAI,CAAC,EAAG;IACfZ,CAAC,GAAGlE,MAAM,CAACC,YAAY,CAAC6E,CAAC,GAAGI,GAAG,GAAGH,IAAI,CAAC,GAAGb,CAAC;IAC3CY,CAAC,GAAGK,IAAI,CAACC,KAAK,CAACN,CAAC,GAAGI,GAAG,CAAC,GAAG,CAAC;EAC5B;EAEA,OAAOhB,CAAC;AACT;AAEA,IAAI;EACH,IAAImB,WAAW,GAAG,IAAIC,aAAa,EAAE;EACrC,IAAIC,QAAQ;AACb,CAAC,CACD,OAAOC,CAAC,EAAE,CAAC;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,SAAS,CAAEC,GAAG,EAAEC,GAAG,EAAG;EAC9B,IAAKJ,QAAQ,KAAKnE,SAAS,EAAG;IAC7B;IACA;IACAmE,QAAQ,GAAGF,WAAW,CACpBO,iBAAiB,CACf,IAAI/I,MAAM,CAACgJ,SAAS,EAAE,CAAGC,eAAe,CAAEC,YAAY,CAAC,0BAA0B,CAAC,EAAE,UAAU,CAAE,CAClG,CACApB,OAAO,CAAE,SAAS,CAAE,KAAK,CAAC,CAAC;EAC9B;EAEApI,CAAC,CAACyJ,IAAI,CAAEL,GAAG,EAAE,UAAWxF,IAAI,EAAE8F,GAAG,EAAG;IACnC,IAAK1J,CAAC,CAAC2J,aAAa,CAAED,GAAG,CAAE,EAAG;MAC7B,IAAIE,MAAM,GAAGT,GAAG,CAACU,MAAM,CAAEjG,IAAI,CAAE;MAC/BsF,SAAS,CAAEU,MAAM,EAAEF,GAAG,CAAE;IACzB,CAAC,MACI;MACJ,IAAKV,QAAQ,EAAG;QACf;QACA;QACA;QACA;QACA;QACA,IAAIc,SAAS,GAAGJ,GAAG,CAACK,UAAU,CAAC,CAAC,CAAC;QACjC,IAAI9G,CAAC,EAAE2E,GAAG;QACV,IAAIoC,KAAK,GAAG,EAAE;QAEd,KAAM/G,CAAC,GAAC6G,SAAS,CAACG,UAAU,CAAC/G,MAAM,GAAC,CAAC,EAAGD,CAAC,IAAE,CAAC,EAAGA,CAAC,EAAE,EAAG;UACpD,IAAIiH,QAAQ,GAAGJ,SAAS,CAACG,UAAU,CAAChH,CAAC,CAAC,CAACkH,QAAQ;UAC/C,IAAIC,SAAS,GAAGN,SAAS,CAACG,UAAU,CAAChH,CAAC,CAAC,CAACoH,SAAS;UAEjD,IAAKH,QAAQ,CAAC9B,OAAO,CAAE,GAAG,CAAE,KAAK,CAAC,CAAC,EAAG;YACrC4B,KAAK,CAAChC,IAAI,CAAE;cAAEpE,IAAI,EAAEsG,QAAQ;cAAEI,KAAK,EAAEF;YAAU,CAAC,CAAE;YAElDN,SAAS,CAACS,eAAe,CAAEL,QAAQ,CAAE;UACtC;QACD;QAEA,KAAMjH,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACoC,KAAK,CAAC9G,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;UAC3C,IAAIuH,IAAI,GAAGd,GAAG,CAACe,eAAe,CAAET,KAAK,CAAC/G,CAAC,CAAC,CAACW,IAAI,CAACY,OAAO,CAAE,GAAG,EAAE,wBAAwB,CAAE,CAAE;UACxFgG,IAAI,CAACF,KAAK,GAAGN,KAAK,CAAC/G,CAAC,CAAC,CAACqH,KAAK;UAC3BR,SAAS,CAACY,gBAAgB,CAAEF,IAAI,CAAE;QACnC;MACD;MAEA,IAAIvC,GAAG,GAAGa,WAAW,CAACO,iBAAiB,CAACK,GAAG,CAAC;;MAE5C;MACA,IAAKV,QAAQ,EAAG;QACf;QACA,IAAKf,GAAG,CAACG,OAAO,CAAE,OAAO,CAAE,KAAK,CAAC,CAAC,EAAG;UACpCH,GAAG,GAAG,yDAAyD,GAACA,GAAG;QACpE;;QAEA;QACAA,GAAG,GAAGA,GAAG,CAACzD,OAAO,CAAE,yBAAyB,EAAE,GAAG,CAAE;;QAEnD;QACAyD,GAAG,GAAGA,GAAG,CAACzD,OAAO,CAAE,4BAA4B,EAAE,EAAE,CAAE;MACtD;;MAEA;MACA;MACAyD,GAAG,GAAGA,GAAG,CAACzD,OAAO,CAAE,gCAAgC,EAAE,SAAS,CAAE;MAEhE2E,GAAG,CAAC1G,IAAI,CAAEmB,IAAI,EAAEqE,GAAG,CAAE;IACtB;EACD,CAAC,CAAE;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS0C,WAAW,CAAE1J,GAAG,EAAEkJ,QAAQ,EAAES,IAAI,EAAG;EAC3C,IAAIC,QAAQ,GAAG5J,GAAG,CAAC6J,aAAa,CAAEX,QAAQ,CAAE;EAE5C,IAAKS,IAAI,EAAG;IACX,IAAKA,IAAI,CAACJ,IAAI,EAAG;MAChBxK,CAAC,CAAC6K,QAAQ,CAAC,CAACL,IAAI,CAAEI,IAAI,CAACJ,IAAI,CAAE;IAC9B;IAEA,IAAKI,IAAI,CAACG,QAAQ,EAAG;MACpB/K,CAAC,CAACyJ,IAAI,CAAEmB,IAAI,CAACG,QAAQ,EAAE,UAAWC,GAAG,EAAEV,KAAK,EAAG;QAC9CO,QAAQ,CAACI,WAAW,CAAEX,KAAK,CAAE;MAC9B,CAAC,CAAE;IACJ;IAEA,IAAKM,IAAI,CAACM,IAAI,KAAK,IAAI,IAAIN,IAAI,CAACM,IAAI,KAAKrG,SAAS,EAAG;MACpDgG,QAAQ,CAACI,WAAW,CAAEhK,GAAG,CAACkK,cAAc,CAAEP,IAAI,CAACM,IAAI,CAAE,CAAE;IACxD;EACD;EAEA,OAAOL,QAAQ;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASO,cAAc,CAAEtE,IAAI,EAAEuE,GAAG,EAAG;EACpC,IAAIC,GAAG,GAAGxE,IAAI,CAACe,MAAM,CAACwD,GAAG,CAAC,CAACnI,MAAM;EACjC,IAAIyF,GAAG,EAAE4C,SAAS,EAAEtD,GAAG;EAEvB,IAAKnB,IAAI,CAACgB,MAAM,IAAIhB,IAAI,CAACgB,MAAM,CAACuD,GAAG,CAAC,CAACnI,MAAM,GAAGoI,GAAG,EAAG;IACnDA,GAAG,GAAGxE,IAAI,CAACgB,MAAM,CAACuD,GAAG,CAAC,CAACnI,MAAM;EAC9B;EAEA,KAAM,IAAID,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACd,IAAI,CAACiB,IAAI,CAAC7E,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;IACnD,IAAIuI,KAAK,GAAG1E,IAAI,CAACiB,IAAI,CAAC9E,CAAC,CAAC,CAACoI,GAAG,CAAC;IAC7BpD,GAAG,GAAGuD,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAK3G,SAAS,GAC1C2G,KAAK,CAACC,QAAQ,EAAE,GAChB,EAAE;;IAEH;IACA;IACA,IAAKxD,GAAG,CAACG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAG;MAC/BmD,SAAS,GAAGtD,GAAG,CAAChE,KAAK,CAAC,IAAI,CAAC;MAC3BsH,SAAS,CAACG,IAAI,CAAE,UAAUhE,CAAC,EAAEiE,CAAC,EAAE;QAC/B,OAAOA,CAAC,CAACzI,MAAM,GAAGwE,CAAC,CAACxE,MAAM;MAC3B,CAAC,CAAE;MAEHyF,GAAG,GAAG4C,SAAS,CAAC,CAAC,CAAC,CAACrI,MAAM;IAC1B,CAAC,MACI;MACJyF,GAAG,GAAGV,GAAG,CAAC/E,MAAM;IACjB;IAEA,IAAKyF,GAAG,GAAG2C,GAAG,EAAG;MAChBA,GAAG,GAAG3C,GAAG;IACV;;IAEA;IACA,IAAK2C,GAAG,GAAG,EAAE,EAAG;MACf,OAAO,EAAE,CAAC,CAAC;IACZ;EACD;;EAEAA,GAAG,IAAI,IAAI;;EAEX;EACA,OAAOA,GAAG,GAAG,CAAC,GAAGA,GAAG,GAAG,CAAC;AACzB;;AAEA;AACA,IAAI9B,YAAY,GAAG;EAClB,aAAa,EACZ,yDAAyD,GACzD,sFAAsF,GACrF,8IAA8I,GAC/I,kBAAkB;EAEnB,4BAA4B,EAC3B,yDAAyD,GACzD,sFAAsF,GACrF,+IAA+I,GAC/I,iIAAiI,GAClI,kBAAkB;EAEnB,qBAAqB,EACpB,yDAAyD,GACzD,8EAA8E,GAC7E,2DAA2D,GAC3D,qGAAqG,GACrG,uDAAuD,GACvD,mIAAmI,GACnI,2IAA2I,GAC3I,6HAA6H,GAC9H,UAAU;EAEX,iBAAiB,EAChB,yDAAyD,GACzD,4JAA4J,GAC3J,8EAA8E,GAC9E,8DAA8D,GAC9D,aAAa,GACZ,iGAAiG,GAClG,cAAc,GACd,UAAU,GACT,gDAAgD,GACjD,WAAW,GACX,iBAAiB,GAClB,aAAa;EAEd,0BAA0B,EACzB,yDAAyD,GACzD,mUAAmU,GAClU,cAAc,GACd,yBAAyB,GAC1B,cAAc;EAEf,eAAe,EACd,wCAAwC,GACxC,sPAAsP,GACrP,qBAAqB,GACpB,4DAA4D,GAC5D,6DAA6D,GAC7D,wDAAwD,GACxD,4CAA4C,GAC5C,qDAAqD,GACrD,2DAA2D,GAC5D,YAAY,GACZ,wCAAwC,GACvC,QAAQ,GACP,iBAAiB,GACjB,wBAAwB,GACzB,SAAS,GACT,QAAQ,GACP,iBAAiB,GACjB,wBAAwB,GACxB,0BAA0B,GAC3B,SAAS,GACT,QAAQ,GACP,iBAAiB,GACjB,wBAAwB,GACxB,OAAO,GACR,SAAS,GACT,QAAQ,GACP,iBAAiB,GACjB,wBAAwB,GACxB,OAAO,GACR,SAAS,GACT,QAAQ,GACP,iBAAiB,GACjB,wBAAwB,GACxB,OAAO,GACR,SAAS,GACV,UAAU,GACV,mBAAmB,GAClB,QAAQ,GACP,oCAAoC,GACrC,SAAS,GACT,QAAQ;EAAE;EACT,oCAAoC;EAAE;EACvC,SAAS,GACT,QAAQ,GACP,mCAAmC,GAClC,4BAA4B,GAC5B,0BAA0B,GAC3B,gBAAgB,GACjB,SAAS,GACT,QAAQ,GACP,mCAAmC,GAClC,4BAA4B,GAC5B,0BAA0B,GAC3B,gBAAgB,GACjB,SAAS,GACT,QAAQ,GACP,mCAAmC,GAClC,4BAA4B,GAC5B,0BAA0B,GAC3B,gBAAgB,GACjB,SAAS,GACT,QAAQ,GACP,mCAAmC,GAClC,4BAA4B,GAC5B,0BAA0B,GAC3B,gBAAgB,GACjB,SAAS,GACV,UAAU,GACV,qBAAqB,GACpB,UAAU,GACT,UAAU,GACV,WAAW,GACX,SAAS,GACT,YAAY,GACZ,cAAc,GACf,WAAW,GACX,kDAAkD,GACjD,qBAAqB,GACpB,oBAAoB,GACrB,SAAS,GACT,sBAAsB,GACrB,oBAAoB,GACrB,UAAU,GACV,oBAAoB,GACnB,oBAAoB,GACrB,QAAQ,GACR,uBAAuB,GACtB,oBAAoB,GACrB,WAAW,GACX,cAAc,GACf,WAAW,GACZ,YAAY,GACZ,0BAA0B,GACzB,wDAAwD,GACzD,iBAAiB,GACjB,sBAAsB,GACrB,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,mGAAmG,GACnG,8HAA8H,GAC7H,gCAAgC,GACjC,OAAO,GACP,8HAA8H,GAC7H,kCAAkC,GACnC,OAAO,GACP,8HAA8H,GAC7H,iCAAiC,GAClC,OAAO,GACP,8HAA8H,GAC7H,gCAAgC,GACjC,OAAO,GACP,8HAA8H,GAC7H,gCAAgC,GACjC,OAAO,GACP,8HAA8H,GAC7H,2BAA2B,GAC5B,OAAO,GACP,oIAAoI,GACpI,oIAAoI,GACpI,oIAAoI,GACpI,oIAAoI,GACpI,oIAAoI,GACpI,oIAAoI,GACpI,oIAAoI,GACpI,kIAAkI,GAClI,kIAAkI,GAClI,kIAAkI,GAClI,kIAAkI,GAClI,mIAAmI,GACpI,YAAY,GACZ,wBAAwB,GACvB,oDAAoD,GACrD,eAAe,GACf,oBAAoB,GACpB,uGAAuG,GACxG;AACF,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAIoC,cAAc,GAAG,CACpB;EAAElF,KAAK,EAAE,eAAe;EAAgBmF,KAAK,EAAE,EAAE;EAAEC,GAAG,EAAE,UAAUC,CAAC,EAAE;IAAE,OAAOA,CAAC,GAAC,GAAG;EAAE;AAAE,CAAC;AAAE;AAC1F;EAAErF,KAAK,EAAE,iBAAiB;EAAcmF,KAAK,EAAE,EAAE;EAAEC,GAAG,EAAE,UAAUC,CAAC,EAAE;IAAE,OAAOA,CAAC,GAAC,GAAG;EAAE;AAAE,CAAC;AAAE;AAC1F;EAAErF,KAAK,EAAE,oBAAoB;EAAWmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,mBAAmB;EAAYmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,mBAAmB;EAAYmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,UAAU;EAAqBmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,iBAAiB;EAAcmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,cAAc;EAAiBmF,KAAK,EAAE,EAAE;EAAEC,GAAG,EAAE,UAAUC,CAAC,EAAE;IAAE,OAAO,CAAC,CAAC,GAAGA,CAAC,CAACvH,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC;EAAE;AAAE,CAAC;AAAG;AACnH;EAAEkC,KAAK,EAAE,qBAAqB;EAAUmF,KAAK,EAAE,EAAE;EAAEC,GAAG,EAAE,UAAUC,CAAC,EAAE;IAAE,OAAO,CAAC,CAAC,GAAGA,CAAC,CAACvH,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC;EAAE;AAAE,CAAC;AAAG;AACnH;EAAEkC,KAAK,EAAE,aAAa;EAAkBmF,KAAK,EAAE;AAAG,CAAC;AAAE;AACrD;EAAEnF,KAAK,EAAE,oBAAoB;EAAWmF,KAAK,EAAE;AAAG,CAAC,EACnD;EAAEnF,KAAK,EAAE,iCAAiC;EAAEmF,KAAK,EAAE,EAAE;EAAEC,GAAG,EAAE,UAAUC,CAAC,EAAE;IAAC,OAAOnD,IAAI,CAACoD,KAAK,CAAC,KAAK,GAAIC,IAAI,CAACC,KAAK,CAACH,CAAC,CAAC,IAAI,KAAK,GAAG,IAAI,CAAE,CAAC;EAAC;AAAC,CAAC,CAAC;AAAA,CACzI;;AAID;AACA;AACA;;AAEA;AACA;AACA;AACA9L,SAAS,CAACkM,GAAG,CAACpF,OAAO,CAACqF,SAAS,GAAG;EACjCC,SAAS,EAAE,4BAA4B;EAEvCnB,IAAI,EAAE,UAAWtE,EAAE,EAAG;IACrB,OAAOA,EAAE,CAAC0F,IAAI,CAAE,cAAc,EAAE,MAAM,CAAE;EACzC,CAAC;EAEDC,MAAM,EAAE,UAAWC,CAAC,EAAE5F,EAAE,EAAE6F,MAAM,EAAEnG,MAAM,EAAG;IAC1C,IAAI,CAACoG,UAAU,CAAE,IAAI,CAAE;IAEvB,IAAIC,IAAI,GAAG,IAAI;IACf,IAAI3F,UAAU,GAAGL,WAAW,CAAEC,EAAE,EAAEN,MAAM,CAAE;IAC1C,IAAIsG,IAAI,GAAGhG,EAAE,CAACG,OAAO,CAAC8F,UAAU,CAAEvG,MAAM,CAAE;IAC1C,IAAIG,OAAO,GAAGD,QAAQ,CAACF,MAAM,CAAC;IAC9B,IAAIwG,MAAM,GAAG9F,UAAU,CAACiB,GAAG;IAC3B,IAAI8E,SAAS,GAAG/M,CAAC,CAAC,QAAQ,CAAC,CACzBgN,GAAG,CAAE;MACLC,MAAM,EAAE,CAAC;MACTC,KAAK,EAAE,CAAC;MACRC,QAAQ,EAAE,QAAQ;MAClBC,QAAQ,EAAE,OAAO;MACjBC,GAAG,EAAE,CAAC;MACNC,IAAI,EAAE;IACP,CAAC,CAAE;IAEJ,IAAKV,IAAI,CAACW,KAAK,EAAG;MACjBT,MAAM,GAAGF,IAAI,CAACW,KAAK,GAAG9G,OAAO,GAAGA,OAAO,GAAGqG,MAAM;IACjD;IAEA,IAAKF,IAAI,CAACY,UAAU,EAAG;MACtBV,MAAM,GAAGF,IAAI,CAACY,UAAU,GAAG/G,OAAO,GAAGA,OAAO,GAAGqG,MAAM;IACtD;IAEA,IAAKF,IAAI,CAACa,aAAa,EAAG;MACzBX,MAAM,GAAGA,MAAM,GAAGrG,OAAO,GAAGA,OAAO,GAAGmG,IAAI,CAACa,aAAa;IACzD;IAEA,IAAKnH,MAAM,CAACoH,SAAS,EAAG;MACvBZ,MAAM,GAAGxG,MAAM,CAACoH,SAAS,CAAEZ,MAAM,EAAExG,MAAM,EAAEM,EAAE,CAAE;IAChD;IAEA,IAAI+G,QAAQ,GAAG3N,CAAC,CAAC,sBAAsB,CAAC,CACtC0J,GAAG,CAAEoD,MAAM,CAAE,CACbc,QAAQ,CAAEb,SAAS,CAAE;;IAEvB;IACA,IAAK7L,QAAQ,CAAC2M,qBAAqB,CAAC,MAAM,CAAC,EAAG;MAC7Cd,SAAS,CAACa,QAAQ,CAAEhH,EAAE,CAACkH,KAAK,EAAE,CAACC,SAAS,EAAE,CAAE;MAC5CJ,QAAQ,CAAC,CAAC,CAAC,CAACK,KAAK,EAAE;MACnBL,QAAQ,CAAC,CAAC,CAAC,CAACM,MAAM,EAAE;MAEpB,IAAI;QACH,IAAIC,UAAU,GAAGhN,QAAQ,CAACiN,WAAW,CAAE,MAAM,CAAE;QAC/CpB,SAAS,CAACnK,MAAM,EAAE;QAElB,IAAIsL,UAAU,EAAE;UACftH,EAAE,CAACG,OAAO,CAAC6F,IAAI,CACdhG,EAAE,CAAC0F,IAAI,CAAE,mBAAmB,EAAE,mBAAmB,CAAE,EACnD1F,EAAE,CAAC0F,IAAI,CAAE,qBAAqB,EAAE;YAC/B,CAAC,EAAE,6BAA6B;YAChC5L,CAAC,EAAE;UACJ,CAAC,EAAEsG,UAAU,CAACkB,IAAI,CAAE,EACpB,IAAI,CACJ;UAED,IAAI,CAACwE,UAAU,CAAE,KAAK,CAAE;UACxB;QACD;MACD,CAAC,CACD,OAAOzD,CAAC,EAAE,CAAC;IACZ;;IAEA;IACA,IAAImF,OAAO,GAAGpO,CAAC,CAAC,QAAQ,GAAC4G,EAAE,CAAC0F,IAAI,CAAE,kBAAkB,EAClD,2GAA2G,GAC3G,gDAAgD,CAAE,GAAC,SAAS,CAC5D,CACA+B,MAAM,CAAEtB,SAAS,CAAE;IAErBnG,EAAE,CAACG,OAAO,CAAC6F,IAAI,CAAEhG,EAAE,CAAC0F,IAAI,CAAE,mBAAmB,EAAE,mBAAmB,CAAE,EAAE8B,OAAO,EAAE,CAAC,CAAE;;IAElF;IACA;IACAT,QAAQ,CAAC,CAAC,CAAC,CAACK,KAAK,EAAE;IACnBL,QAAQ,CAAC,CAAC,CAAC,CAACM,MAAM,EAAE;;IAEpB;IACA,IAAIF,SAAS,GAAG/N,CAAC,CAACoO,OAAO,CAAC,CAACE,OAAO,CAAC,iBAAiB,CAAC;IACrD,IAAIC,KAAK,GAAG,YAAY;MACvBR,SAAS,CAACS,GAAG,CAAE,oBAAoB,CAAE;MACrCxO,CAAC,CAACkB,QAAQ,CAAC,CAACsN,GAAG,CAAE,eAAe,CAAE;MAClC5H,EAAE,CAACG,OAAO,CAAC6F,IAAI,CAAE,KAAK,CAAE;IACzB,CAAC;IAEDmB,SAAS,CAACU,EAAE,CAAE,oBAAoB,EAAEF,KAAK,CAAE;IAC3CvO,CAAC,CAACkB,QAAQ,CAAC,CACTuN,EAAE,CAAE,sBAAsB,EAAE,UAAUjC,CAAC,EAAE;MACzC,IAAKA,CAAC,CAACkC,OAAO,KAAK,EAAE,EAAG;QAAE;QACzBH,KAAK,EAAE;QACP5B,IAAI,CAACD,UAAU,CAAE,KAAK,CAAE;MACzB;IACD,CAAC,CAAE,CACF+B,EAAE,CAAE,oCAAoC,EAAE,YAAY;MACtDF,KAAK,EAAE;MACP5B,IAAI,CAACD,UAAU,CAAE,KAAK,CAAE;IACzB,CAAC,CAAE;EACL,CAAC;EAEDzF,aAAa,EAAE,CAAC,CAAC;EAEjBI,cAAc,EAAE,IAAI;EAEpBF,aAAa,EAAE,EAAE;EAEjBU,MAAM,EAAE,IAAI;EAEZC,MAAM,EAAE,KAAK;EAEbyF,KAAK,EAAE,GAAG;EAEVC,UAAU,EAAE,GAAG;EAEfC,aAAa,EAAE;AAChB,CAAC;;AAED;AACA;AACA;AACAxN,SAAS,CAACkM,GAAG,CAACpF,OAAO,CAAC4H,QAAQ,GAAG;EAChCC,GAAG,EAAE,KAAK;EAEVvC,SAAS,EAAE,2BAA2B;EAEtCwC,SAAS,EAAE,YAAY;IACtB,OAAOvO,MAAM,CAAC6D,UAAU,KAAKU,SAAS,IAAIvE,MAAM,CAACkD,IAAI;EACtD,CAAC;EAED0H,IAAI,EAAE,UAAWtE,EAAE,EAAG;IACrB,OAAOA,EAAE,CAAC0F,IAAI,CAAE,aAAa,EAAE,KAAK,CAAE;EACvC,CAAC;EAEDC,MAAM,EAAE,UAAWC,CAAC,EAAE5F,EAAE,EAAE6F,MAAM,EAAEnG,MAAM,EAAG;IAC1C,IAAI,CAACoG,UAAU,CAAE,IAAI,CAAE;;IAEvB;IACA,IAAII,MAAM,GAAGnG,WAAW,CAAEC,EAAE,EAAEN,MAAM,CAAE,CAAC2B,GAAG;IAC1C,IAAI2E,IAAI,GAAGhG,EAAE,CAACG,OAAO,CAAC8F,UAAU,CAACvG,MAAM,CAAC;IACxC,IAAIwI,OAAO,GAAGxI,MAAM,CAACwI,OAAO;IAE5B,IAAKxI,MAAM,CAACoH,SAAS,EAAG;MACvBZ,MAAM,GAAGxG,MAAM,CAACoH,SAAS,CAAEZ,MAAM,EAAExG,MAAM,EAAEM,EAAE,CAAE;IAChD;IAEA,IAAKkI,OAAO,KAAK,KAAK,EAAG;MACxB,IAAK,CAAEA,OAAO,EAAG;QAChBA,OAAO,GAAG5N,QAAQ,CAAC6N,YAAY,IAAI7N,QAAQ,CAAC4N,OAAO;MACpD;MAEA,IAAKA,OAAO,EAAG;QACdA,OAAO,GAAG,WAAW,GAACA,OAAO;MAC9B;IACD,CAAC,MACI;MACJA,OAAO,GAAG,EAAE;IACb;IAEA,IAAKxI,MAAM,CAACsI,GAAG,EAAG;MACjB9B,MAAM,GAAGrJ,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC,GAAGoJ,MAAM;IAC9C;IAEAlM,OAAO,CACN,IAAI4C,IAAI,CAAE,CAACsJ,MAAM,CAAC,EAAE;MAACvJ,IAAI,EAAE,UAAU,GAACuL;IAAO,CAAC,CAAE,EAChDlC,IAAI,CAACoC,QAAQ,EACb,IAAI,CACJ;IAED,IAAI,CAACtC,UAAU,CAAE,KAAK,CAAE;EACzB,CAAC;EAEDsC,QAAQ,EAAE,GAAG;EAEbC,SAAS,EAAE,MAAM;EAEjBhI,aAAa,EAAE,CAAC,CAAC;EAEjBI,cAAc,EAAE,GAAG;EAEnBF,aAAa,EAAE,GAAG;EAElBK,UAAU,EAAE,GAAG;EAEfsH,OAAO,EAAE,IAAI;EAEbjH,MAAM,EAAE,IAAI;EAEZC,MAAM,EAAE;AACT,CAAC;;AAED;AACA;AACA;AACA7H,SAAS,CAACkM,GAAG,CAACpF,OAAO,CAACmI,UAAU,GAAG;EAClC7C,SAAS,EAAE,6BAA6B;EAExCwC,SAAS,EAAE,YAAY;IACtB,OAAOvO,MAAM,CAAC6D,UAAU,KAAKU,SAAS,IAAIxE,MAAM,EAAE,KAAKwE,SAAS,IAAI,CAAEsD,aAAa,EAAE,IAAIW,WAAW;EACrG,CAAC;EAEDoC,IAAI,EAAE,UAAWtE,EAAE,EAAG;IACrB,OAAOA,EAAE,CAAC0F,IAAI,CAAE,eAAe,EAAE,OAAO,CAAE;EAC3C,CAAC;EAEDC,MAAM,EAAE,UAAWC,CAAC,EAAE5F,EAAE,EAAE6F,MAAM,EAAEnG,MAAM,EAAG;IAC1C,IAAI,CAACoG,UAAU,CAAE,IAAI,CAAE;IAEvB,IAAIC,IAAI,GAAG,IAAI;IACf,IAAIwC,MAAM,GAAG,CAAC;IACd,IAAIC,YAAY,EAAEC,UAAU;IAC5B,IAAIC,MAAM,GAAG,UAAW/L,IAAI,EAAG;MAC9B,IAAI0E,GAAG,GAAGuB,YAAY,CAAEjG,IAAI,CAAE;;MAE9B;;MAEA,OAAOvD,CAAC,CAACuP,QAAQ,CAAEtH,GAAG,CAAE;IACzB,CAAC;IACD,IAAIuH,IAAI,GAAGF,MAAM,CAAC,0BAA0B,CAAC;IAC7C,IAAIG,OAAO,GAAGD,IAAI,CAACE,oBAAoB,CAAE,WAAW,CAAE,CAAC,CAAC,CAAC;IAEzD,IAAIC,IAAI,GAAG;MACVC,KAAK,EAAE;QACN,OAAO,EAAEN,MAAM,CAAC,aAAa;MAC9B,CAAC;MACDO,EAAE,EAAE;QACHD,KAAK,EAAE;UACN,mBAAmB,EAAEN,MAAM,CAAC,4BAA4B;QACzD,CAAC;QACD,cAAc,EAAEA,MAAM,CAAC,iBAAiB,CAAC;QACzC,YAAY,EAAEA,MAAM,CAAC,eAAe,CAAC;QACrC,YAAY,EAAE;UACb,YAAY,EAAEE;QACf;MAED,CAAC;MACD,qBAAqB,EAAEF,MAAM,CAAC,qBAAqB;IACpD,CAAC;IAED,IAAIxI,IAAI,GAAGF,EAAE,CAACG,OAAO,CAACC,UAAU,CAAEV,MAAM,CAACW,aAAa,CAAE;IACxD,IAAI6I,UAAU,EAAEC,OAAO;IACvB,IAAIC,MAAM,GAAG,UAAWC,GAAG,EAAG;MAC7BH,UAAU,GAAGX,MAAM,GAAC,CAAC;MACrBY,OAAO,GAAGpF,WAAW,CAAE6E,IAAI,EAAE,KAAK,EAAE;QAAEhF,IAAI,EAAE;UAAC0F,CAAC,EAACJ;QAAU;MAAE,CAAC,CAAE;MAE9D,KAAM,IAAI7M,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACqI,GAAG,CAAC/M,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;QAC7C;QACA,IAAIkN,MAAM,GAAG7H,aAAa,CAACrF,CAAC,CAAC,GAAG,EAAE,GAAG6M,UAAU;QAC/C,IAAIM,IAAI,GAAG,IAAI;;QAEf;QACA,IAAKH,GAAG,CAAChN,CAAC,CAAC,KAAK,IAAI,IAAIgN,GAAG,CAAChN,CAAC,CAAC,KAAK4B,SAAS,IAAIoL,GAAG,CAAChN,CAAC,CAAC,KAAK,EAAE,EAAG;UAC/D,IAAKqD,MAAM,CAAC+J,gBAAgB,KAAK,IAAI,EAAG;YACvCJ,GAAG,CAAChN,CAAC,CAAC,GAAG,EAAE;UACZ,CAAC,MACI;YACJ;UACD;QACD;QAEA,IAAIqN,eAAe,GAAGL,GAAG,CAAChN,CAAC,CAAC;QAC5BgN,GAAG,CAAChN,CAAC,CAAC,GAAG,OAAOgN,GAAG,CAAChN,CAAC,CAAC,CAACsN,IAAI,KAAK,UAAU,GACvCN,GAAG,CAAChN,CAAC,CAAC,CAACsN,IAAI,EAAE,GACbN,GAAG,CAAChN,CAAC,CAAC;;QAET;QACA,KAAM,IAAIuN,CAAC,GAAC,CAAC,EAAEC,GAAG,GAAC7E,cAAc,CAAC1I,MAAM,EAAGsN,CAAC,GAACC,GAAG,EAAGD,CAAC,EAAE,EAAG;UACxD,IAAIE,OAAO,GAAG9E,cAAc,CAAC4E,CAAC,CAAC;;UAE/B;UACA;UACA;UACA,IAAKP,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,IAAI,CAAEuJ,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,CAAC,OAAO,CAAC,IAAIuJ,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,CAAEgK,OAAO,CAAChK,KAAK,CAAE,EAAG;YAC/E,IAAIgD,GAAG,GAAGuG,GAAG,CAAChN,CAAC,CAAC,CAACuB,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC;YAE1C,IAAKkM,OAAO,CAAC5E,GAAG,EAAG;cAClBpC,GAAG,GAAGgH,OAAO,CAAC5E,GAAG,CAAEpC,GAAG,CAAE;YACzB;YAEA0G,IAAI,GAAGzF,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;cAC9BhF,IAAI,EAAE;gBACL0F,CAAC,EAAEC,MAAM;gBACTxI,CAAC,EAAE+I,OAAO,CAAC7E;cACZ,CAAC;cACDd,QAAQ,EAAE,CACTJ,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;gBAAEtE,IAAI,EAAExB;cAAI,CAAC,CAAE;YAEzC,CAAC,CAAE;YAEH;UACD;QACD;QAEA,IAAK,CAAE0G,IAAI,EAAG;UACb,IAAK,OAAOH,GAAG,CAAChN,CAAC,CAAC,KAAK,QAAQ,IAC9BgN,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,IACZuJ,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,CAAC,8BAA8B,CAAC;UAAI;UAChD,CAAEuJ,GAAG,CAAChN,CAAC,CAAC,CAACyD,KAAK,CAAC,OAAO,CAAG,EACxB;YACD;YACA;YACA0J,IAAI,GAAGzF,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;cAC9BhF,IAAI,EAAE;gBACLvB,CAAC,EAAE,GAAG;gBACNiH,CAAC,EAAEC;cACJ,CAAC;cACDpF,QAAQ,EAAE,CACTJ,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;gBAAEtE,IAAI,EAAE+E,GAAG,CAAChN,CAAC;cAAE,CAAC,CAAE;YAE5C,CAAC,CAAE;UACJ,CAAC,MACI;YACJ;YACA,IAAIiI,IAAI,GAAG,CAAEoF,eAAe,CAAC9L,OAAO,GACnC8L,eAAe,GACfA,eAAe,CAAC9L,OAAO,CAAC,wCAAwC,EAAE,EAAE,CAAC;YAEtE4L,IAAI,GAAGzF,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;cAC9BhF,IAAI,EAAE;gBACLvB,CAAC,EAAE,WAAW;gBACdiH,CAAC,EAAEC;cACJ,CAAC;cACDpF,QAAQ,EAAC;gBACRkF,GAAG,EAAEtF,WAAW,CAAE6E,IAAI,EAAE,IAAI,EAAE;kBAC7BzE,QAAQ,EAAE;oBACTkF,GAAG,EAAEtF,WAAW,CAAE6E,IAAI,EAAE,GAAG,EAAE;sBAC5BtE,IAAI,EAAEA,IAAI;sBACVV,IAAI,EAAE;wBACL,WAAW,EAAE;sBACd;oBACD,CAAC;kBACF;gBACD,CAAC;cACF;YACD,CAAC,CAAE;UACJ;QACD;QAEAuF,OAAO,CAAC9E,WAAW,CAAEmF,IAAI,CAAE;MAC5B;MAEAX,OAAO,CAACxE,WAAW,CAAC8E,OAAO,CAAC;MAC5BZ,MAAM,EAAE;IACT,CAAC;IAED,IAAK7I,MAAM,CAACqK,aAAa,EAAG;MAC3BrK,MAAM,CAACqK,aAAa,CAAE7J,IAAI,CAAE;IAC7B;IAEA,IAAI8J,UAAU,GAAG,UAAWX,GAAG,EAAEY,OAAO,EAAG;MAC1C,IAAID,UAAU,GAAG5Q,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC;MAEtCoB,UAAU,CAAC,CAAC,CAAC,CAAC3F,WAAW,CAAEN,WAAW,CAAE6E,IAAI,EAAE,WAAW,EAAE;QAC1DhF,IAAI,EAAE;UACLsG,GAAG,EAAE,GAAG,GAACb,GAAG,GAAC,GAAG,GAAC3H,aAAa,CAACuI,OAAO,CAAC,GAACZ;QACzC;MACD,CAAC,CAAE,CAAE;MACLW,UAAU,CAACpG,IAAI,CAAE,OAAO,EAAEuG,UAAU,CAACH,UAAU,CAACpG,IAAI,CAAE,OAAO,CAAE,CAAC,GAAC,CAAC,CAAE;MACpExK,CAAC,CAAC,SAAS,IAAEiQ,GAAG,GAAC,CAAC,CAAC,GAAC,KAAK,EAAET,IAAI,CAAC,CAAChF,IAAI,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC,CAAC;IACrD,CAAC;;IAED;IACA,IAAIqC,UAAU,GAAGjG,EAAE,CAACG,OAAO,CAAC8F,UAAU,CAAEvG,MAAM,CAAE;IAChD,IAAKuG,UAAU,CAACU,KAAK,EAAG;MACvByC,MAAM,CAAE,CAACnD,UAAU,CAACU,KAAK,CAAC,EAAE4B,MAAM,CAAE;MACpCyB,UAAU,CAAEzB,MAAM,EAAErI,IAAI,CAACe,MAAM,CAAC3E,MAAM,GAAC,CAAC,CAAE;IAC3C;IAEA,IAAK2J,UAAU,CAACW,UAAU,EAAG;MAC5BwC,MAAM,CAAE,CAACnD,UAAU,CAACW,UAAU,CAAC,EAAE2B,MAAM,CAAE;MACzCyB,UAAU,CAAEzB,MAAM,EAAErI,IAAI,CAACe,MAAM,CAAC3E,MAAM,GAAC,CAAC,CAAE;IAC3C;;IAGA;IACA,IAAKoD,MAAM,CAACuB,MAAM,EAAG;MACpBmI,MAAM,CAAElJ,IAAI,CAACe,MAAM,EAAEsH,MAAM,CAAE;MAC7BnP,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC,CAAChF,IAAI,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC,CAAC;IACzC;;IAEA4E,YAAY,GAAGD,MAAM;IAErB,KAAM,IAAI5G,CAAC,GAAC,CAAC,EAAEyI,EAAE,GAAClK,IAAI,CAACiB,IAAI,CAAC7E,MAAM,EAAGqF,CAAC,GAACyI,EAAE,EAAGzI,CAAC,EAAE,EAAG;MACjDyH,MAAM,CAAElJ,IAAI,CAACiB,IAAI,CAACQ,CAAC,CAAC,EAAE4G,MAAM,CAAE;IAC/B;IAEAE,UAAU,GAAGF,MAAM;IAEnB,IAAK7I,MAAM,CAACwB,MAAM,IAAIhB,IAAI,CAACgB,MAAM,EAAG;MACnCkI,MAAM,CAAElJ,IAAI,CAACgB,MAAM,EAAEqH,MAAM,CAAC;MAC5BnP,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC,CAAChF,IAAI,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC,CAAC;IACzC;;IAEA;IACA,IAAKqC,UAAU,CAACY,aAAa,EAAG;MAC/BuC,MAAM,CAAE,CAACnD,UAAU,CAACY,aAAa,CAAC,EAAE0B,MAAM,CAAE;MAC5CyB,UAAU,CAAEzB,MAAM,EAAErI,IAAI,CAACe,MAAM,CAAC3E,MAAM,GAAC,CAAC,CAAE;IAC3C;;IAEA;IACA,IAAI+N,IAAI,GAAGtG,WAAW,CAAE6E,IAAI,EAAE,MAAM,CAAE;IACtCxP,CAAC,CAAC,WAAW,EAAEwP,IAAI,CAAC,CAAC0B,OAAO,CAAED,IAAI,CAAE;IAEpC,KAAM,IAAIhO,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACd,IAAI,CAACe,MAAM,CAAC3E,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;MACrDgO,IAAI,CAAChG,WAAW,CAAEN,WAAW,CAAE6E,IAAI,EAAE,KAAK,EAAE;QAC3ChF,IAAI,EAAE;UACL2G,GAAG,EAAElO,CAAC,GAAC,CAAC;UACRqI,GAAG,EAAErI,CAAC,GAAC,CAAC;UACRiK,KAAK,EAAE9B,cAAc,CAAEtE,IAAI,EAAE7D,CAAC,CAAE;UAChCmO,WAAW,EAAE;QACd;MACD,CAAC,CAAE,CAAE;IACN;;IAEA;IACA,IAAIC,QAAQ,GAAG1B,IAAI,CAACE,EAAE,CAAC,cAAc,CAAC;IAEtC7P,CAAC,CAAE,cAAc,EAAEqR,QAAQ,CAAE,CAAC7G,IAAI,CAAE,MAAM,EAAEnE,UAAU,CAAEC,MAAM,CAAE,CAAE;;IAElE;IACA,IAAKA,MAAM,CAACgL,UAAU,EAAG;MACxBtR,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC,CAAC+B,MAAM,CAAE5G,WAAW,CAAE6E,IAAI,EAAE,YAAY,EAAE;QAC9DhF,IAAI,EAAE;UACLsG,GAAG,EAAE,GAAG,GAAC1B,YAAY,GAAC,GAAG,GAAC9G,aAAa,CAACxB,IAAI,CAACe,MAAM,CAAC3E,MAAM,GAAC,CAAC,CAAC,GAACmM;QAC/D;MACD,CAAC,CAAE,CAAE;MAELrP,CAAC,CAAC,cAAc,EAAEqR,QAAQ,CAAC,CAAChD,MAAM,CAAE1D,WAAW,CAAE0G,QAAQ,EAAE,aAAa,EAAE;QACzE7G,IAAI,EAAE;UACL5G,IAAI,EAAE,uBAAuB;UAC7B4N,YAAY,EAAE,GAAG;UACjBC,MAAM,EAAE;QACT,CAAC;QACDvG,IAAI,EAAE7E,UAAU,CAACC,MAAM,CAAC,GAAC,MAAM,GAAC8I,YAAY,GAAC,GAAG,GAAC9G,aAAa,CAACxB,IAAI,CAACe,MAAM,CAAC3E,MAAM,GAAC,CAAC,CAAC,GAACmM;MACtF,CAAC,CAAE,CAAE;IACN;;IAEA;IACA,IAAK/I,MAAM,CAACoH,SAAS,EAAG;MACvBpH,MAAM,CAACoH,SAAS,CAAEiC,IAAI,EAAErJ,MAAM,EAAEM,EAAE,CAAE;IACrC;;IAEA;IACA,IAAK5G,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC,CAACzE,QAAQ,EAAE,CAAC7H,MAAM,KAAK,CAAC,EAAG;MACpDlD,CAAC,CAAC,YAAY,EAAEwP,IAAI,CAAC,CAAC5M,MAAM,EAAE;IAC/B;IAEA,IAAIjC,KAAK,GAAGN,MAAM,EAAE;IACpB,IAAI8I,GAAG,GAAG,IAAIxI,KAAK,EAAE;IACrB,IAAI+Q,SAAS,GAAG;MACfC,WAAW,EAAE,SAAS;MACtBpO,IAAI,EAAE,MAAM;MACZqO,QAAQ,EAAE;IACX,CAAC;IAED1I,SAAS,CAAEC,GAAG,EAAEwG,IAAI,CAAE;;IAEtB;IACA;IACA;IACA,IAAIX,QAAQ,GAAGnC,UAAU,CAACmC,QAAQ;IAElC,IAAIA,QAAQ,GAAG,GAAG,EAAE;MACnBA,QAAQ,GAAGA,QAAQ,CAAC6C,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC;IACnC;IAEA,IAAK1I,GAAG,CAAC2I,aAAa,EAAG;MACxB;MACA3I,GAAG,CACD2I,aAAa,CAAEJ,SAAS,CAAE,CAC1BK,IAAI,CAAE,UAAWzO,IAAI,EAAG;QACxB1C,OAAO,CAAE0C,IAAI,EAAE0L,QAAQ,CAAE;QACzBrC,IAAI,CAACD,UAAU,CAAE,KAAK,CAAE;MACzB,CAAC,CAAE;IACL,CAAC,MACI;MACJ;MACA9L,OAAO,CACNuI,GAAG,CAAC6I,QAAQ,CAAEN,SAAS,CAAE,EACzB1C,QAAQ,CACR;MACD,IAAI,CAACtC,UAAU,CAAE,KAAK,CAAE;IACzB;EACD,CAAC;EAEDsC,QAAQ,EAAE,GAAG;EAEbC,SAAS,EAAE,OAAO;EAElBhI,aAAa,EAAE,CAAC,CAAC;EAEjBY,MAAM,EAAE,IAAI;EAEZC,MAAM,EAAE,KAAK;EAEbyF,KAAK,EAAE,GAAG;EAEVC,UAAU,EAAE,GAAG;EAEfC,aAAa,EAAE,GAAG;EAElB4C,gBAAgB,EAAE,KAAK;EAEvBiB,UAAU,EAAE,KAAK;EAEjB/K,SAAS,EAAE;AACZ,CAAC;;AAED;AACA;AACA;AACAtG,SAAS,CAACkM,GAAG,CAACpF,OAAO,CAACkL,QAAQ,GAAG;EAChC5F,SAAS,EAAE,2BAA2B;EAEtCwC,SAAS,EAAE,YAAY;IACtB,OAAOvO,MAAM,CAAC6D,UAAU,KAAKU,SAAS,IAAIrE,QAAQ,EAAE;EACrD,CAAC;EAED0K,IAAI,EAAE,UAAWtE,EAAE,EAAG;IACrB,OAAOA,EAAE,CAAC0F,IAAI,CAAE,aAAa,EAAE,KAAK,CAAE;EACvC,CAAC;EAEDC,MAAM,EAAE,UAAWC,CAAC,EAAE5F,EAAE,EAAE6F,MAAM,EAAEnG,MAAM,EAAG;IAC1C,IAAI,CAACoG,UAAU,CAAE,IAAI,CAAE;IAEvB,IAAIC,IAAI,GAAG,IAAI;IACf,IAAI7F,IAAI,GAAGF,EAAE,CAACG,OAAO,CAACC,UAAU,CAAEV,MAAM,CAACW,aAAa,CAAE;IACxD,IAAI2F,IAAI,GAAGhG,EAAE,CAACG,OAAO,CAAC8F,UAAU,CAAEvG,MAAM,CAAE;IAC1C,IAAI4B,IAAI,GAAG,EAAE;IAEb,IAAK5B,MAAM,CAACuB,MAAM,EAAG;MACpBK,IAAI,CAACF,IAAI,CAAEhI,CAAC,CAACkS,GAAG,CAAEpL,IAAI,CAACe,MAAM,EAAE,UAAWkE,CAAC,EAAG;QAC7C,OAAO;UACNb,IAAI,EAAE,OAAOa,CAAC,KAAK,QAAQ,GAAGA,CAAC,GAAGA,CAAC,GAAC,EAAE;UACtCF,KAAK,EAAE;QACR,CAAC;MACF,CAAC,CAAE,CAAE;IACN;IAEA,KAAM,IAAI5I,CAAC,GAAC,CAAC,EAAE2E,GAAG,GAACd,IAAI,CAACiB,IAAI,CAAC7E,MAAM,EAAGD,CAAC,GAAC2E,GAAG,EAAG3E,CAAC,EAAE,EAAG;MACnDiF,IAAI,CAACF,IAAI,CAAEhI,CAAC,CAACkS,GAAG,CAAEpL,IAAI,CAACiB,IAAI,CAAC9E,CAAC,CAAC,EAAE,UAAW8I,CAAC,EAAG;QAC9C,IAAKA,CAAC,KAAK,IAAI,IAAIA,CAAC,KAAKlH,SAAS,EAAG;UACpCkH,CAAC,GAAG,EAAE;QACP;QACA,OAAO;UACNb,IAAI,EAAE,OAAOa,CAAC,KAAK,QAAQ,GAAGA,CAAC,GAAGA,CAAC,GAAC,EAAE;UACtCF,KAAK,EAAE5I,CAAC,GAAG,CAAC,GAAG,eAAe,GAAG;QAClC,CAAC;MACF,CAAC,CAAE,CAAE;IACN;IAEA,IAAKqD,MAAM,CAACwB,MAAM,IAAIhB,IAAI,CAACgB,MAAM,EAAE;MAClCI,IAAI,CAACF,IAAI,CAAEhI,CAAC,CAACkS,GAAG,CAAEpL,IAAI,CAACgB,MAAM,EAAE,UAAWiE,CAAC,EAAG;QAC7C,OAAO;UACNb,IAAI,EAAE,OAAOa,CAAC,KAAK,QAAQ,GAAGA,CAAC,GAAGA,CAAC,GAAC,EAAE;UACtCF,KAAK,EAAE;QACR,CAAC;MACF,CAAC,CAAE,CAAE;IACN;IAEA,IAAI5K,GAAG,GAAG;MACTkR,QAAQ,EAAE7L,MAAM,CAAC6L,QAAQ;MACzBC,eAAe,EAAE9L,MAAM,CAAC+L,WAAW;MACnClM,OAAO,EAAE,CACR;QACC2H,KAAK,EAAE;UACNwE,UAAU,EAAE,CAAC;UACbvK,IAAI,EAAEG;QACP,CAAC;QACDqK,MAAM,EAAE;MACT,CAAC,CACD;MACDC,MAAM,EAAE;QACPC,WAAW,EAAE;UACZC,IAAI,EAAE,IAAI;UACVC,QAAQ,EAAE,EAAE;UACZC,KAAK,EAAE,OAAO;UACdC,SAAS,EAAE,SAAS;UACpBC,SAAS,EAAE;QACZ,CAAC;QACDC,aAAa,EAAE,CAAC,CAAC;QACjBC,YAAY,EAAE;UACbH,SAAS,EAAE;QACZ,CAAC;QACDI,WAAW,EAAE;UACZP,IAAI,EAAE,IAAI;UACVC,QAAQ,EAAE,EAAE;UACZC,KAAK,EAAE,OAAO;UACdC,SAAS,EAAE;QACZ,CAAC;QACDtF,KAAK,EAAE;UACNuF,SAAS,EAAE,QAAQ;UACnBH,QAAQ,EAAE;QACX,CAAC;QACDvE,OAAO,EAAE,CAAC;MACX,CAAC;MACD8E,YAAY,EAAE;QACbP,QAAQ,EAAE;MACX;IACD,CAAC;IAED,IAAK/F,IAAI,CAACY,UAAU,EAAG;MACtBvM,GAAG,CAACkF,OAAO,CAACgN,OAAO,CAAE;QACpBjI,IAAI,EAAE0B,IAAI,CAACY,UAAU;QACrB3B,KAAK,EAAE,SAAS;QAChBuH,MAAM,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;MACtB,CAAC,CAAE;IACJ;IAEA,IAAKxG,IAAI,CAACa,aAAa,EAAG;MACzBxM,GAAG,CAACkF,OAAO,CAAC6B,IAAI,CAAE;QACjBkD,IAAI,EAAE0B,IAAI,CAACa,aAAa;QACxB5B,KAAK,EAAE,SAAS;QAChBuH,MAAM,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;MACtB,CAAC,CAAE;IACJ;IAEA,IAAKxG,IAAI,CAACW,KAAK,EAAG;MACjBtM,GAAG,CAACkF,OAAO,CAACgN,OAAO,CAAE;QACpBjI,IAAI,EAAE0B,IAAI,CAACW,KAAK;QAChB1B,KAAK,EAAE,OAAO;QACduH,MAAM,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;MACtB,CAAC,CAAE;IACJ;IAEA,IAAK9M,MAAM,CAACoH,SAAS,EAAG;MACvBpH,MAAM,CAACoH,SAAS,CAAEzM,GAAG,EAAEqF,MAAM,EAAEM,EAAE,CAAE;IACpC;IAEA,IAAIyM,GAAG,GAAG7S,QAAQ,EAAE,CAAC8S,SAAS,CAAErS,GAAG,CAAE;IAErC,IAAKqF,MAAM,CAAClB,QAAQ,KAAK,MAAM,IAAI,CAAE+C,aAAa,EAAE,EAAG;MACtDkL,GAAG,CAAC3O,IAAI,EAAE;IACX,CAAC,MACI;MACJ2O,GAAG,CAACjO,QAAQ,CAAEwH,IAAI,CAACoC,QAAQ,CAAE;IAC9B;IAEA,IAAI,CAACtC,UAAU,CAAE,KAAK,CAAE;EACzB,CAAC;EAEDa,KAAK,EAAE,GAAG;EAEVyB,QAAQ,EAAE,GAAG;EAEbC,SAAS,EAAE,MAAM;EAEjBhI,aAAa,EAAE,CAAC,CAAC;EAEjBoL,WAAW,EAAE,UAAU;EAEvBF,QAAQ,EAAE,IAAI;EAEdtK,MAAM,EAAE,IAAI;EAEZC,MAAM,EAAE,KAAK;EAEb0F,UAAU,EAAE,GAAG;EAEfC,aAAa,EAAE,GAAG;EAElBC,SAAS,EAAE,IAAI;EAEftI,QAAQ,EAAE;AACX,CAAC;AAGD,eAAenF,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}