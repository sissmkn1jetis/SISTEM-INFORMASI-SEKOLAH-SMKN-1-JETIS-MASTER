{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\n/*!\n * Flash export buttons for Buttons and DataTables.\n * 2015 SpryMedia Ltd - datatables.net/license\n *\n * ZeroClipbaord - MIT license\n * Copyright (c) 2012 Joseph Huckaby\n */\n\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery', 'datatables.net', 'datatables.net-buttons'], function ($) {\n      return factory($, window, document);\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = function (root, $) {\n      if (!root) {\n        root = window;\n      }\n      if (!$ || !$.fn.dataTable) {\n        $ = require('datatables.net')(root, $).$;\n      }\n      if (!$.fn.dataTable.Buttons) {\n        require('datatables.net-buttons')(root, $);\n      }\n      return factory($, root, root.document);\n    };\n  } else {\n    // Browser\n    factory(jQuery, window, document);\n  }\n})(function ($, window, document, undefined) {\n  'use strict';\n\n  var DataTable = $.fn.dataTable;\n\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * ZeroClipboard dependency\n   */\n\n  /*\n   * ZeroClipboard 1.0.4 with modifications\n   * Author: Joseph Huckaby\n   * License: MIT\n   *\n   * Copyright (c) 2012 Joseph Huckaby\n   */\n  var ZeroClipboard_TableTools = {\n    version: \"1.0.4-TableTools2\",\n    clients: {},\n    // registered upload clients on page, indexed by id\n    moviePath: '',\n    // URL to movie\n    nextId: 1,\n    // ID of next movie\n\n    $: function (thingy) {\n      // simple DOM lookup utility function\n      if (typeof thingy == 'string') {\n        thingy = document.getElementById(thingy);\n      }\n      if (!thingy.addClass) {\n        // extend element with a few useful methods\n        thingy.hide = function () {\n          this.style.display = 'none';\n        };\n        thingy.show = function () {\n          this.style.display = '';\n        };\n        thingy.addClass = function (name) {\n          this.removeClass(name);\n          this.className += ' ' + name;\n        };\n        thingy.removeClass = function (name) {\n          this.className = this.className.replace(new RegExp(\"\\\\s*\" + name + \"\\\\s*\"), \" \").replace(/^\\s+/, '').replace(/\\s+$/, '');\n        };\n        thingy.hasClass = function (name) {\n          return !!this.className.match(new RegExp(\"\\\\s*\" + name + \"\\\\s*\"));\n        };\n      }\n      return thingy;\n    },\n    setMoviePath: function (path) {\n      // set path to ZeroClipboard.swf\n      this.moviePath = path;\n    },\n    dispatch: function (id, eventName, args) {\n      // receive event from flash movie, send to client\n      var client = this.clients[id];\n      if (client) {\n        client.receiveEvent(eventName, args);\n      }\n    },\n    log: function (str) {\n      console.log('Flash: ' + str);\n    },\n    register: function (id, client) {\n      // register new client to receive events\n      this.clients[id] = client;\n    },\n    getDOMObjectPosition: function (obj) {\n      // get absolute coordinates for dom element\n      var info = {\n        left: 0,\n        top: 0,\n        width: obj.width ? obj.width : obj.offsetWidth,\n        height: obj.height ? obj.height : obj.offsetHeight\n      };\n      if (obj.style.width !== \"\") {\n        info.width = obj.style.width.replace(\"px\", \"\");\n      }\n      if (obj.style.height !== \"\") {\n        info.height = obj.style.height.replace(\"px\", \"\");\n      }\n      while (obj) {\n        info.left += obj.offsetLeft;\n        info.top += obj.offsetTop;\n        obj = obj.offsetParent;\n      }\n      return info;\n    },\n    Client: function (elem) {\n      // constructor for new simple upload client\n      this.handlers = {};\n\n      // unique ID\n      this.id = ZeroClipboard_TableTools.nextId++;\n      this.movieId = 'ZeroClipboard_TableToolsMovie_' + this.id;\n\n      // register client with singleton to receive flash events\n      ZeroClipboard_TableTools.register(this.id, this);\n\n      // create movie\n      if (elem) {\n        this.glue(elem);\n      }\n    }\n  };\n  ZeroClipboard_TableTools.Client.prototype = {\n    id: 0,\n    // unique ID for us\n    ready: false,\n    // whether movie is ready to receive events or not\n    movie: null,\n    // reference to movie object\n    clipText: '',\n    // text to copy to clipboard\n    fileName: '',\n    // default file save name\n    action: 'copy',\n    // action to perform\n    handCursorEnabled: true,\n    // whether to show hand cursor, or default pointer cursor\n    cssEffects: true,\n    // enable CSS mouse effects on dom container\n    handlers: null,\n    // user event handlers\n    sized: false,\n    sheetName: '',\n    // default sheet name for excel export\n\n    glue: function (elem, title) {\n      // glue to DOM element\n      // elem can be ID or actual DOM element object\n      this.domElement = ZeroClipboard_TableTools.$(elem);\n\n      // float just above object, or zIndex 99 if dom element isn't set\n      var zIndex = 99;\n      if (this.domElement.style.zIndex) {\n        zIndex = parseInt(this.domElement.style.zIndex, 10) + 1;\n      }\n\n      // find X/Y position of domElement\n      var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\n      // create floating DIV above element\n      this.div = document.createElement('div');\n      var style = this.div.style;\n      style.position = 'absolute';\n      style.left = '0px';\n      style.top = '0px';\n      style.width = box.width + 'px';\n      style.height = box.height + 'px';\n      style.zIndex = zIndex;\n      if (typeof title != \"undefined\" && title !== \"\") {\n        this.div.title = title;\n      }\n      if (box.width !== 0 && box.height !== 0) {\n        this.sized = true;\n      }\n\n      // style.backgroundColor = '#f00'; // debug\n      if (this.domElement) {\n        this.domElement.appendChild(this.div);\n        this.div.innerHTML = this.getHTML(box.width, box.height).replace(/&/g, '&amp;');\n      }\n    },\n    positionElement: function () {\n      var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n      var style = this.div.style;\n      style.position = 'absolute';\n      //style.left = (this.domElement.offsetLeft)+'px';\n      //style.top = this.domElement.offsetTop+'px';\n      style.width = box.width + 'px';\n      style.height = box.height + 'px';\n      if (box.width !== 0 && box.height !== 0) {\n        this.sized = true;\n      } else {\n        return;\n      }\n      var flash = this.div.childNodes[0];\n      flash.width = box.width;\n      flash.height = box.height;\n    },\n    getHTML: function (width, height) {\n      // return HTML for movie\n      var html = '';\n      var flashvars = 'id=' + this.id + '&width=' + width + '&height=' + height;\n      if (navigator.userAgent.match(/MSIE/)) {\n        // IE gets an OBJECT tag\n        var protocol = location.href.match(/^https/i) ? 'https://' : 'http://';\n        html += '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"' + protocol + 'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0\" width=\"' + width + '\" height=\"' + height + '\" id=\"' + this.movieId + '\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"' + ZeroClipboard_TableTools.moviePath + '\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"' + flashvars + '\"/><param name=\"wmode\" value=\"transparent\"/></object>';\n      } else {\n        // all other browsers get an EMBED tag\n        html += '<embed id=\"' + this.movieId + '\" src=\"' + ZeroClipboard_TableTools.moviePath + '\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"' + width + '\" height=\"' + height + '\" name=\"' + this.movieId + '\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"' + flashvars + '\" wmode=\"transparent\" />';\n      }\n      return html;\n    },\n    hide: function () {\n      // temporarily hide floater offscreen\n      if (this.div) {\n        this.div.style.left = '-2000px';\n      }\n    },\n    show: function () {\n      // show ourselves after a call to hide()\n      this.reposition();\n    },\n    destroy: function () {\n      // destroy control and floater\n      var that = this;\n      if (this.domElement && this.div) {\n        $(this.div).remove();\n        this.domElement = null;\n        this.div = null;\n        $.each(ZeroClipboard_TableTools.clients, function (id, client) {\n          if (client === that) {\n            delete ZeroClipboard_TableTools.clients[id];\n          }\n        });\n      }\n    },\n    reposition: function (elem) {\n      // reposition our floating div, optionally to new container\n      // warning: container CANNOT change size, only position\n      if (elem) {\n        this.domElement = ZeroClipboard_TableTools.$(elem);\n        if (!this.domElement) {\n          this.hide();\n        }\n      }\n      if (this.domElement && this.div) {\n        var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n        var style = this.div.style;\n        style.left = '' + box.left + 'px';\n        style.top = '' + box.top + 'px';\n      }\n    },\n    clearText: function () {\n      // clear the text to be copy / saved\n      this.clipText = '';\n      if (this.ready) {\n        this.movie.clearText();\n      }\n    },\n    appendText: function (newText) {\n      // append text to that which is to be copied / saved\n      this.clipText += newText;\n      if (this.ready) {\n        this.movie.appendText(newText);\n      }\n    },\n    setText: function (newText) {\n      // set text to be copied to be copied / saved\n      this.clipText = newText;\n      if (this.ready) {\n        this.movie.setText(newText);\n      }\n    },\n    setFileName: function (newText) {\n      // set the file name\n      this.fileName = newText;\n      if (this.ready) {\n        this.movie.setFileName(newText);\n      }\n    },\n    setSheetData: function (data) {\n      // set the xlsx sheet data\n      if (this.ready) {\n        this.movie.setSheetData(JSON.stringify(data));\n      }\n    },\n    setAction: function (newText) {\n      // set action (save or copy)\n      this.action = newText;\n      if (this.ready) {\n        this.movie.setAction(newText);\n      }\n    },\n    addEventListener: function (eventName, func) {\n      // add user event listener for event\n      // event types: load, queueStart, fileStart, fileComplete, queueComplete, progress, error, cancel\n      eventName = eventName.toString().toLowerCase().replace(/^on/, '');\n      if (!this.handlers[eventName]) {\n        this.handlers[eventName] = [];\n      }\n      this.handlers[eventName].push(func);\n    },\n    setHandCursor: function (enabled) {\n      // enable hand cursor (true), or default arrow cursor (false)\n      this.handCursorEnabled = enabled;\n      if (this.ready) {\n        this.movie.setHandCursor(enabled);\n      }\n    },\n    setCSSEffects: function (enabled) {\n      // enable or disable CSS effects on DOM container\n      this.cssEffects = !!enabled;\n    },\n    receiveEvent: function (eventName, args) {\n      var self;\n\n      // receive event from flash\n      eventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\n      // special behavior for certain events\n      switch (eventName) {\n        case 'load':\n          // movie claims it is ready, but in IE this isn't always the case...\n          // bug fix: Cannot extend EMBED DOM elements in Firefox, must use traditional function\n          this.movie = document.getElementById(this.movieId);\n          if (!this.movie) {\n            self = this;\n            setTimeout(function () {\n              self.receiveEvent('load', null);\n            }, 1);\n            return;\n          }\n\n          // firefox on pc needs a \"kick\" in order to set these in certain cases\n          if (!this.ready && navigator.userAgent.match(/Firefox/) && navigator.userAgent.match(/Windows/)) {\n            self = this;\n            setTimeout(function () {\n              self.receiveEvent('load', null);\n            }, 100);\n            this.ready = true;\n            return;\n          }\n          this.ready = true;\n          this.movie.clearText();\n          this.movie.appendText(this.clipText);\n          this.movie.setFileName(this.fileName);\n          this.movie.setAction(this.action);\n          this.movie.setHandCursor(this.handCursorEnabled);\n          break;\n        case 'mouseover':\n          if (this.domElement && this.cssEffects) {\n            //this.domElement.addClass('hover');\n            if (this.recoverActive) {\n              this.domElement.addClass('active');\n            }\n          }\n          break;\n        case 'mouseout':\n          if (this.domElement && this.cssEffects) {\n            this.recoverActive = false;\n            if (this.domElement.hasClass('active')) {\n              this.domElement.removeClass('active');\n              this.recoverActive = true;\n            }\n            //this.domElement.removeClass('hover');\n          }\n\n          break;\n        case 'mousedown':\n          if (this.domElement && this.cssEffects) {\n            this.domElement.addClass('active');\n          }\n          break;\n        case 'mouseup':\n          if (this.domElement && this.cssEffects) {\n            this.domElement.removeClass('active');\n            this.recoverActive = false;\n          }\n          break;\n      } // switch eventName\n\n      if (this.handlers[eventName]) {\n        for (var idx = 0, len = this.handlers[eventName].length; idx < len; idx++) {\n          var func = this.handlers[eventName][idx];\n          if (typeof func == 'function') {\n            // actual function reference\n            func(this, args);\n          } else if (typeof func == 'object' && func.length == 2) {\n            // PHP style object + method, i.e. [myObject, 'myMethod']\n            func[0][func[1]](this, args);\n          } else if (typeof func == 'string') {\n            // name of function\n            window[func](this, args);\n          }\n        } // foreach event handler defined\n      } // user defined handler for event\n    }\n  };\n\n  ZeroClipboard_TableTools.hasFlash = function () {\n    try {\n      var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n      if (fo) {\n        return true;\n      }\n    } catch (e) {\n      if (navigator.mimeTypes && navigator.mimeTypes['application/x-shockwave-flash'] !== undefined && navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  // For the Flash binding to work, ZeroClipboard_TableTools must be on the global\n  // object list\n  window.ZeroClipboard_TableTools = ZeroClipboard_TableTools;\n\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Local (private) functions\n   */\n\n  /**\n   * If a Buttons instance is initlaised before it is placed into the DOM, Flash\n   * won't be able to bind to it, so we need to wait until it is available, this\n   * method abstracts that out.\n   *\n   * @param {ZeroClipboard} flash ZeroClipboard instance\n   * @param {jQuery} node  Button\n   */\n  var _glue = function (flash, node) {\n    var id = node.attr('id');\n    if (node.parents('html').length) {\n      flash.glue(node[0], '');\n    } else {\n      setTimeout(function () {\n        _glue(flash, node);\n      }, 500);\n    }\n  };\n\n  /**\n   * Get the file name for an exported file.\n   *\n   * @param {object}  config       Button configuration\n   * @param {boolean} incExtension Include the file name extension\n   */\n  var _filename = function (config, incExtension) {\n    // Backwards compatibility\n    var filename = config.filename === '*' && config.title !== '*' && config.title !== undefined ? config.title : config.filename;\n    if (typeof filename === 'function') {\n      filename = filename();\n    }\n    if (filename.indexOf('*') !== -1) {\n      filename = $.trim(filename.replace('*', $('title').text()));\n    }\n\n    // Strip characters which the OS will object to\n    filename = filename.replace(/[^a-zA-Z0-9_\\u00A1-\\uFFFF\\.,\\-_ !\\(\\)]/g, \"\");\n    return incExtension === undefined || incExtension === true ? filename + config.extension : filename;\n  };\n\n  /**\n   * Get the sheet name for Excel exports.\n   *\n   * @param {object}  config       Button configuration\n   */\n  var _sheetname = function (config) {\n    var sheetName = 'Sheet1';\n    if (config.sheetName) {\n      sheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n    }\n    return sheetName;\n  };\n\n  /**\n   * Get the title for an exported file.\n   *\n   * @param {object}  config  Button configuration\n   */\n  var _title = function (config) {\n    var title = config.title;\n    if (typeof title === 'function') {\n      title = title();\n    }\n    return title.indexOf('*') !== -1 ? title.replace('*', $('title').text() || 'Exported data') : title;\n  };\n\n  /**\n   * Set the flash text. This has to be broken up into chunks as the Javascript /\n   * Flash bridge has a size limit. There is no indication in the Flash\n   * documentation what this is, and it probably depends upon the browser.\n   * Experimentation shows that the point is around 50k when data starts to get\n   * lost, so an 8K limit used here is safe.\n   *\n   * @param {ZeroClipboard} flash ZeroClipboard instance\n   * @param {string}        data  Data to send to Flash\n   */\n  var _setText = function (flash, data) {\n    var parts = data.match(/[\\s\\S]{1,8192}/g) || [];\n    flash.clearText();\n    for (var i = 0, len = parts.length; i < len; i++) {\n      flash.appendText(parts[i]);\n    }\n  };\n\n  /**\n   * Get the newline character(s)\n   *\n   * @param {object}  config Button configuration\n   * @return {string}        Newline character\n   */\n  var _newLine = function (config) {\n    return config.newline ? config.newline : navigator.userAgent.match(/Windows/) ? '\\r\\n' : '\\n';\n  };\n\n  /**\n   * Combine the data from the `buttons.exportData` method into a string that\n   * will be used in the export file.\n   *\n   * @param  {DataTable.Api} dt     DataTables API instance\n   * @param  {object}        config Button configuration\n   * @return {object}               The data to export\n   */\n  var _exportData = function (dt, config) {\n    var newLine = _newLine(config);\n    var data = dt.buttons.exportData(config.exportOptions);\n    var boundary = config.fieldBoundary;\n    var separator = config.fieldSeparator;\n    var reBoundary = new RegExp(boundary, 'g');\n    var escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\n    var join = function (a) {\n      var s = '';\n\n      // If there is a field boundary, then we might need to escape it in\n      // the source data\n      for (var i = 0, ien = a.length; i < ien; i++) {\n        if (i > 0) {\n          s += separator;\n        }\n        s += boundary ? boundary + ('' + a[i]).replace(reBoundary, escapeChar + boundary) + boundary : a[i];\n      }\n      return s;\n    };\n    var header = config.header ? join(data.header) + newLine : '';\n    var footer = config.footer && data.footer ? newLine + join(data.footer) : '';\n    var body = [];\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      body.push(join(data.body[i]));\n    }\n    return {\n      str: header + body.join(newLine) + footer,\n      rows: body.length\n    };\n  };\n\n  // Basic initialisation for the buttons is common between them\n  var flashButton = {\n    available: function () {\n      return ZeroClipboard_TableTools.hasFlash();\n    },\n    init: function (dt, button, config) {\n      // Insert the Flash movie\n      ZeroClipboard_TableTools.moviePath = DataTable.Buttons.swfPath;\n      var flash = new ZeroClipboard_TableTools.Client();\n      flash.setHandCursor(true);\n      flash.addEventListener('mouseDown', function (client) {\n        config._fromFlash = true;\n        dt.button(button[0]).trigger();\n        config._fromFlash = false;\n      });\n      _glue(flash, button);\n      config._flash = flash;\n    },\n    destroy: function (dt, button, config) {\n      config._flash.destroy();\n    },\n    fieldSeparator: ',',\n    fieldBoundary: '\"',\n    exportOptions: {},\n    title: '*',\n    filename: '*',\n    extension: '.csv',\n    header: true,\n    footer: false\n  };\n\n  /**\n   * Convert from numeric position to letter for column names in Excel\n   * @param  {int} n Column number\n   * @return {string} Column letter(s) name\n   */\n  function createCellPos(n) {\n    var ordA = 'A'.charCodeAt(0);\n    var ordZ = 'Z'.charCodeAt(0);\n    var len = ordZ - ordA + 1;\n    var s = \"\";\n    while (n >= 0) {\n      s = String.fromCharCode(n % len + ordA) + s;\n      n = Math.floor(n / len) - 1;\n    }\n    return s;\n  }\n\n  /**\n   * Create an XML node and add any children, attributes, etc without needing to\n   * be verbose in the DOM.\n   *\n   * @param  {object} doc      XML document\n   * @param  {string} nodeName Node name\n   * @param  {object} opts     Options - can be `attr` (attributes), `children`\n   *   (child nodes) and `text` (text content)\n   * @return {node}            Created node\n   */\n  function _createNode(doc, nodeName, opts) {\n    var tempNode = doc.createElement(nodeName);\n    if (opts) {\n      if (opts.attr) {\n        $(tempNode).attr(opts.attr);\n      }\n      if (opts.children) {\n        $.each(opts.children, function (key, value) {\n          tempNode.appendChild(value);\n        });\n      }\n      if (opts.text) {\n        tempNode.appendChild(doc.createTextNode(opts.text));\n      }\n    }\n    return tempNode;\n  }\n\n  /**\n   * Get the width for an Excel column based on the contents of that column\n   * @param  {object} data Data for export\n   * @param  {int}    col  Column index\n   * @return {int}         Column width\n   */\n  function _excelColWidth(data, col) {\n    var max = data.header[col].length;\n    var len, lineSplit, str;\n    if (data.footer && data.footer[col].length > max) {\n      max = data.footer[col].length;\n    }\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      var point = data.body[i][col];\n      str = point !== null && point !== undefined ? point.toString() : '';\n\n      // If there is a newline character, workout the width of the column\n      // based on the longest line in the string\n      if (str.indexOf('\\n') !== -1) {\n        lineSplit = str.split('\\n');\n        lineSplit.sort(function (a, b) {\n          return b.length - a.length;\n        });\n        len = lineSplit[0].length;\n      } else {\n        len = str.length;\n      }\n      if (len > max) {\n        max = len;\n      }\n\n      // Max width rather than having potentially massive column widths\n      if (max > 40) {\n        return 52; // 40 * 1.3\n      }\n    }\n\n    max *= 1.3;\n\n    // And a min width\n    return max > 6 ? max : 6;\n  }\n  var _serialiser = \"\";\n  if (typeof window.XMLSerializer === 'undefined') {\n    _serialiser = new function () {\n      this.serializeToString = function (input) {\n        return input.xml;\n      };\n    }();\n  } else {\n    _serialiser = new XMLSerializer();\n  }\n  var _ieExcel;\n\n  /**\n   * Convert XML documents in an object to strings\n   * @param  {object} obj XLSX document object\n   */\n  function _xlsxToStrings(obj) {\n    if (_ieExcel === undefined) {\n      // Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n      // drop attributes\n      _ieExcel = _serialiser.serializeToString($.parseXML(excelStrings['xl/worksheets/sheet1.xml'])).indexOf('xmlns:r') === -1;\n    }\n    $.each(obj, function (name, val) {\n      if ($.isPlainObject(val)) {\n        _xlsxToStrings(val);\n      } else {\n        if (_ieExcel) {\n          // IE's XML serialiser will drop some name space attributes from\n          // from the root node, so we need to save them. Do this by\n          // replacing the namespace nodes with a regular attribute that\n          // we convert back when serialised. Edge does not have this\n          // issue\n          var worksheet = val.childNodes[0];\n          var i, ien;\n          var attrs = [];\n          for (i = worksheet.attributes.length - 1; i >= 0; i--) {\n            var attrName = worksheet.attributes[i].nodeName;\n            var attrValue = worksheet.attributes[i].nodeValue;\n            if (attrName.indexOf(':') !== -1) {\n              attrs.push({\n                name: attrName,\n                value: attrValue\n              });\n              worksheet.removeAttribute(attrName);\n            }\n          }\n          for (i = 0, ien = attrs.length; i < ien; i++) {\n            var attr = val.createAttribute(attrs[i].name.replace(':', '_dt_b_namespace_token_'));\n            attr.value = attrs[i].value;\n            worksheet.setAttributeNode(attr);\n          }\n        }\n        var str = _serialiser.serializeToString(val);\n\n        // Fix IE's XML\n        if (_ieExcel) {\n          // IE doesn't include the XML declaration\n          if (str.indexOf('<?xml') === -1) {\n            str = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + str;\n          }\n\n          // Return namespace attributes to being as such\n          str = str.replace(/_dt_b_namespace_token_/g, ':');\n        }\n\n        // Safari, IE and Edge will put empty name space attributes onto\n        // various elements making them useless. This strips them out\n        str = str.replace(/<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>');\n        obj[name] = str;\n      }\n    });\n  }\n\n  // Excel - Pre-defined strings to build a basic XLSX file\n  var excelStrings = {\n    \"_rels/.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' + '</Relationships>',\n    \"xl/_rels/workbook.xml.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' + '</Relationships>',\n    \"[Content_Types].xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' + '<Default Extension=\"xml\" ContentType=\"application/xml\" />' + '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' + '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' + '<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' + '<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' + '<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' + '</Types>',\n    \"xl/workbook.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' + '<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' + '<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' + '<bookViews>' + '<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' + '</bookViews>' + '<sheets>' + '<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>' + '</sheets>' + '</workbook>',\n    \"xl/worksheets/sheet1.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<sheetData/>' + '</worksheet>',\n    \"xl/styles.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<numFmts count=\"6\">' + '<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>' + '<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>' + '<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>' + '<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>' + '<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>' + '<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>' + '</numFmts>' + '<fonts count=\"5\" x14ac:knownFonts=\"1\">' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<color rgb=\"FFFFFFFF\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<b />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<i />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<u />' + '</font>' + '</fonts>' + '<fills count=\"6\">' + '<fill>' + '<patternFill patternType=\"none\" />' + '</fill>' + '<fill/>' +\n    // Excel appears to use this as a dotted background regardless of values\n    '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD9D9D9\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD99795\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6efce\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6cfef\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '</fills>' + '<borders count=\"2\">' + '<border>' + '<left />' + '<right />' + '<top />' + '<bottom />' + '<diagonal />' + '</border>' + '<border diagonalUp=\"false\" diagonalDown=\"false\">' + '<left style=\"thin\">' + '<color auto=\"1\" />' + '</left>' + '<right style=\"thin\">' + '<color auto=\"1\" />' + '</right>' + '<top style=\"thin\">' + '<color auto=\"1\" />' + '</top>' + '<bottom style=\"thin\">' + '<color auto=\"1\" />' + '</bottom>' + '<diagonal />' + '</border>' + '</borders>' + '<cellStyleXfs count=\"1\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' + '</cellStyleXfs>' + '<cellXfs count=\"61\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"left\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"center\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"right\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"fill\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment textRotation=\"90\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment wrapText=\"1\"/>' + '</xf>' + '<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '</cellXfs>' + '<cellStyles count=\"1\">' + '<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' + '</cellStyles>' + '<dxfs count=\"0\" />' + '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' + '</styleSheet>'\n  };\n  // Note we could use 3 `for` loops for the styles, but when gzipped there is\n  // virtually no difference in size, since the above can be easily compressed\n\n  // Pattern matching for special number formats. Perhaps this should be exposed\n  // via an API in future?\n  var _excelSpecials = [{\n    match: /^\\-?\\d+\\.\\d%$/,\n    style: 60,\n    fmt: function (d) {\n      return d / 100;\n    }\n  },\n  // Precent with d.p.\n  {\n    match: /^\\-?\\d+\\.?\\d*%$/,\n    style: 56,\n    fmt: function (d) {\n      return d / 100;\n    }\n  },\n  // Percent\n  {\n    match: /^\\-?\\$[\\d,]+.?\\d*$/,\n    style: 57\n  },\n  // Dollars\n  {\n    match: /^\\-?£[\\d,]+.?\\d*$/,\n    style: 58\n  },\n  // Pounds\n  {\n    match: /^\\-?€[\\d,]+.?\\d*$/,\n    style: 59\n  },\n  // Euros\n  {\n    match: /^\\([\\d,]+\\)$/,\n    style: 61,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  },\n  // Negative numbers indicated by brackets\n  {\n    match: /^\\([\\d,]+\\.\\d{2}\\)$/,\n    style: 62,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  },\n  // Negative numbers indicated by brackets - 2d.p.\n  {\n    match: /^[\\d,]+$/,\n    style: 63\n  },\n  // Numbers with thousand separators\n  {\n    match: /^[\\d,]+\\.\\d{2}$/,\n    style: 64\n  } // Numbers with 2d.p. and thousands separators\n  ];\n\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * DataTables options and methods\n   */\n\n  // Set the default SWF path\n  DataTable.Buttons.swfPath = '//cdn.datatables.net/buttons/1.2.4/swf/flashExport.swf';\n\n  // Method to allow Flash buttons to be resized when made visible - as they are\n  // of zero height and width if initialised hidden\n  DataTable.Api.register('buttons.resize()', function () {\n    $.each(ZeroClipboard_TableTools.clients, function (i, client) {\n      if (client.domElement !== undefined && client.domElement.parentNode) {\n        client.positionElement();\n      }\n    });\n  });\n\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Button definitions\n   */\n\n  // Copy to clipboard\n  DataTable.ext.buttons.copyFlash = $.extend({}, flashButton, {\n    className: 'buttons-copy buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.copy', 'Copy');\n    },\n    action: function (e, dt, button, config) {\n      // Check that the trigger did actually occur due to a Flash activation\n      if (!config._fromFlash) {\n        return;\n      }\n      this.processing(true);\n      var flash = config._flash;\n      var data = _exportData(dt, config);\n      var output = config.customize ? config.customize(data.str, config) : data.str;\n      flash.setAction('copy');\n      _setText(flash, output);\n      this.processing(false);\n      dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), dt.i18n('buttons.copySuccess', {\n        _: 'Copied %d rows to clipboard',\n        1: 'Copied 1 row to clipboard'\n      }, data.rows), 3000);\n    },\n    fieldSeparator: '\\t',\n    fieldBoundary: ''\n  });\n\n  // CSV save file\n  DataTable.ext.buttons.csvFlash = $.extend({}, flashButton, {\n    className: 'buttons-csv buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.csv', 'CSV');\n    },\n    action: function (e, dt, button, config) {\n      // Set the text\n      var flash = config._flash;\n      var data = _exportData(dt, config);\n      var output = config.customize ? config.customize(data.str, config) : data.str;\n      flash.setAction('csv');\n      flash.setFileName(_filename(config));\n      _setText(flash, output);\n    },\n    escapeChar: '\"'\n  });\n\n  // Excel save file - this is really a CSV file using UTF-8 that Excel can read\n  DataTable.ext.buttons.excelFlash = $.extend({}, flashButton, {\n    className: 'buttons-excel buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.excel', 'Excel');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n      var flash = config._flash;\n      var rowPos = 0;\n      var rels = $.parseXML(excelStrings['xl/worksheets/sheet1.xml']); //Parses xml\n      var relsGet = rels.getElementsByTagName(\"sheetData\")[0];\n      var xlsx = {\n        _rels: {\n          \".rels\": $.parseXML(excelStrings['_rels/.rels'])\n        },\n        xl: {\n          _rels: {\n            \"workbook.xml.rels\": $.parseXML(excelStrings['xl/_rels/workbook.xml.rels'])\n          },\n          \"workbook.xml\": $.parseXML(excelStrings['xl/workbook.xml']),\n          \"styles.xml\": $.parseXML(excelStrings['xl/styles.xml']),\n          \"worksheets\": {\n            \"sheet1.xml\": rels\n          }\n        },\n        \"[Content_Types].xml\": $.parseXML(excelStrings['[Content_Types].xml'])\n      };\n      var data = dt.buttons.exportData(config.exportOptions);\n      var currentRow, rowNode;\n      var addRow = function (row) {\n        currentRow = rowPos + 1;\n        rowNode = _createNode(rels, \"row\", {\n          attr: {\n            r: currentRow\n          }\n        });\n        for (var i = 0, ien = row.length; i < ien; i++) {\n          // Concat both the Cell Columns as a letter and the Row of the cell.\n          var cellId = createCellPos(i) + '' + currentRow;\n          var cell = null;\n\n          // For null, undefined of blank cell, continue so it doesn't create the _createNode\n          if (row[i] === null || row[i] === undefined || row[i] === '') {\n            continue;\n          }\n          row[i] = $.trim(row[i]);\n\n          // Special number formatting options\n          for (var j = 0, jen = _excelSpecials.length; j < jen; j++) {\n            var special = _excelSpecials[j];\n\n            // TODO Need to provide the ability for the specials to say\n            // if they are returning a string, since at the moment it is\n            // assumed to be a number\n            if (row[i].match && !row[i].match(/^0\\d+/) && row[i].match(special.match)) {\n              var val = row[i].replace(/[^\\d\\.\\-]/g, '');\n              if (special.fmt) {\n                val = special.fmt(val);\n              }\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  r: cellId,\n                  s: special.style\n                },\n                children: [_createNode(rels, 'v', {\n                  text: val\n                })]\n              });\n              break;\n            }\n          }\n          if (!cell) {\n            if (typeof row[i] === 'number' || row[i].match && row[i].match(/^-?\\d+(\\.\\d+)?$/) && !row[i].match(/^0\\d+/)) {\n              // Detect numbers - don't match numbers with leading zeros\n              // or a negative anywhere but the start\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'n',\n                  r: cellId\n                },\n                children: [_createNode(rels, 'v', {\n                  text: row[i]\n                })]\n              });\n            } else {\n              // String output - replace non standard characters for text output\n              var text = !row[i].replace ? row[i] : row[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'inlineStr',\n                  r: cellId\n                },\n                children: {\n                  row: _createNode(rels, 'is', {\n                    children: {\n                      row: _createNode(rels, 't', {\n                        text: text\n                      })\n                    }\n                  })\n                }\n              });\n            }\n          }\n          rowNode.appendChild(cell);\n        }\n        relsGet.appendChild(rowNode);\n        rowPos++;\n      };\n      $('sheets sheet', xlsx.xl['workbook.xml']).attr('name', _sheetname(config));\n      if (config.customizeData) {\n        config.customizeData(data);\n      }\n      if (config.header) {\n        addRow(data.header, rowPos);\n        $('row c', rels).attr('s', '2'); // bold\n      }\n\n      for (var n = 0, ie = data.body.length; n < ie; n++) {\n        addRow(data.body[n], rowPos);\n      }\n      if (config.footer && data.footer) {\n        addRow(data.footer, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      }\n\n      // Set column widths\n      var cols = _createNode(rels, 'cols');\n      $('worksheet', rels).prepend(cols);\n      for (var i = 0, ien = data.header.length; i < ien; i++) {\n        cols.appendChild(_createNode(rels, 'col', {\n          attr: {\n            min: i + 1,\n            max: i + 1,\n            width: _excelColWidth(data, i),\n            customWidth: 1\n          }\n        }));\n      }\n\n      // Let the developer customise the document if they want to\n      if (config.customize) {\n        config.customize(xlsx);\n      }\n      _xlsxToStrings(xlsx);\n      flash.setAction('excel');\n      flash.setFileName(_filename(config));\n      flash.setSheetData(xlsx);\n      _setText(flash, '');\n      this.processing(false);\n    },\n    extension: '.xlsx'\n  });\n\n  // PDF export\n  DataTable.ext.buttons.pdfFlash = $.extend({}, flashButton, {\n    className: 'buttons-pdf buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.pdf', 'PDF');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n\n      // Set the text\n      var flash = config._flash;\n      var data = dt.buttons.exportData(config.exportOptions);\n      var totalWidth = dt.table().node().offsetWidth;\n\n      // Calculate the column width ratios for layout of the table in the PDF\n      var ratios = dt.columns(config.columns).indexes().map(function (idx) {\n        return dt.column(idx).header().offsetWidth / totalWidth;\n      });\n      flash.setAction('pdf');\n      flash.setFileName(_filename(config));\n      _setText(flash, JSON.stringify({\n        title: _filename(config, false),\n        message: typeof config.message == 'function' ? config.message(dt, button, config) : config.message,\n        colWidth: ratios.toArray(),\n        orientation: config.orientation,\n        size: config.pageSize,\n        header: config.header ? data.header : null,\n        footer: config.footer ? data.footer : null,\n        body: data.body\n      }));\n      this.processing(false);\n    },\n    extension: '.pdf',\n    orientation: 'portrait',\n    pageSize: 'A4',\n    message: '',\n    newline: '\\n'\n  });\n  return DataTable.Buttons;\n});","map":{"version":3,"names":["factory","define","amd","$","window","document","exports","module","root","fn","dataTable","require","Buttons","jQuery","undefined","DataTable","ZeroClipboard_TableTools","version","clients","moviePath","nextId","thingy","getElementById","addClass","hide","style","display","show","name","removeClass","className","replace","RegExp","hasClass","match","setMoviePath","path","dispatch","id","eventName","args","client","receiveEvent","log","str","console","register","getDOMObjectPosition","obj","info","left","top","width","offsetWidth","height","offsetHeight","offsetLeft","offsetTop","offsetParent","Client","elem","handlers","movieId","glue","prototype","ready","movie","clipText","fileName","action","handCursorEnabled","cssEffects","sized","sheetName","title","domElement","zIndex","parseInt","box","div","createElement","position","appendChild","innerHTML","getHTML","positionElement","flash","childNodes","html","flashvars","navigator","userAgent","protocol","location","href","reposition","destroy","that","remove","each","clearText","appendText","newText","setText","setFileName","setSheetData","data","JSON","stringify","setAction","addEventListener","func","toString","toLowerCase","push","setHandCursor","enabled","setCSSEffects","self","setTimeout","recoverActive","idx","len","length","hasFlash","fo","ActiveXObject","e","mimeTypes","enabledPlugin","_glue","node","attr","parents","_filename","config","incExtension","filename","indexOf","trim","text","extension","_sheetname","_title","_setText","parts","i","_newLine","newline","_exportData","dt","newLine","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","escapeChar","join","a","s","ien","header","footer","body","rows","flashButton","available","init","button","swfPath","_fromFlash","trigger","_flash","createCellPos","n","ordA","charCodeAt","ordZ","String","fromCharCode","Math","floor","_createNode","doc","nodeName","opts","tempNode","children","key","value","createTextNode","_excelColWidth","col","max","lineSplit","point","split","sort","b","_serialiser","XMLSerializer","serializeToString","input","xml","_ieExcel","_xlsxToStrings","parseXML","excelStrings","val","isPlainObject","worksheet","attrs","attributes","attrName","attrValue","nodeValue","removeAttribute","createAttribute","setAttributeNode","_excelSpecials","fmt","d","Api","parentNode","ext","copyFlash","extend","i18n","processing","output","customize","_","csvFlash","excelFlash","rowPos","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","j","jen","special","t","customizeData","ie","cols","prepend","min","customWidth","pdfFlash","totalWidth","table","ratios","columns","indexes","map","column","message","colWidth","toArray","orientation","size","pageSize"],"sources":["D:/Coding/SISTEM-INFORMASI-SEKOLAH-SMKN-1-JETIS-MASTER/frontend/node_modules/datatables.net-buttons/js/buttons.flash.js"],"sourcesContent":["/*!\n * Flash export buttons for Buttons and DataTables.\n * 2015 SpryMedia Ltd - datatables.net/license\n *\n * ZeroClipbaord - MIT license\n * Copyright (c) 2012 Joseph Huckaby\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'datatables.net', 'datatables.net-buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('datatables.net')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('datatables.net-buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * ZeroClipboard dependency\n */\n\n/*\n * ZeroClipboard 1.0.4 with modifications\n * Author: Joseph Huckaby\n * License: MIT\n *\n * Copyright (c) 2012 Joseph Huckaby\n */\nvar ZeroClipboard_TableTools = {\n\tversion: \"1.0.4-TableTools2\",\n\tclients: {}, // registered upload clients on page, indexed by id\n\tmoviePath: '', // URL to movie\n\tnextId: 1, // ID of next movie\n\n\t$: function(thingy) {\n\t\t// simple DOM lookup utility function\n\t\tif (typeof(thingy) == 'string') {\n\t\t\tthingy = document.getElementById(thingy);\n\t\t}\n\t\tif (!thingy.addClass) {\n\t\t\t// extend element with a few useful methods\n\t\t\tthingy.hide = function() { this.style.display = 'none'; };\n\t\t\tthingy.show = function() { this.style.display = ''; };\n\t\t\tthingy.addClass = function(name) { this.removeClass(name); this.className += ' ' + name; };\n\t\t\tthingy.removeClass = function(name) {\n\t\t\t\tthis.className = this.className.replace( new RegExp(\"\\\\s*\" + name + \"\\\\s*\"), \" \").replace(/^\\s+/, '').replace(/\\s+$/, '');\n\t\t\t};\n\t\t\tthingy.hasClass = function(name) {\n\t\t\t\treturn !!this.className.match( new RegExp(\"\\\\s*\" + name + \"\\\\s*\") );\n\t\t\t};\n\t\t}\n\t\treturn thingy;\n\t},\n\n\tsetMoviePath: function(path) {\n\t\t// set path to ZeroClipboard.swf\n\t\tthis.moviePath = path;\n\t},\n\n\tdispatch: function(id, eventName, args) {\n\t\t// receive event from flash movie, send to client\n\t\tvar client = this.clients[id];\n\t\tif (client) {\n\t\t\tclient.receiveEvent(eventName, args);\n\t\t}\n\t},\n\n\tlog: function ( str ) {\n\t\tconsole.log( 'Flash: '+str );\n\t},\n\n\tregister: function(id, client) {\n\t\t// register new client to receive events\n\t\tthis.clients[id] = client;\n\t},\n\n\tgetDOMObjectPosition: function(obj) {\n\t\t// get absolute coordinates for dom element\n\t\tvar info = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: obj.width ? obj.width : obj.offsetWidth,\n\t\t\theight: obj.height ? obj.height : obj.offsetHeight\n\t\t};\n\n\t\tif ( obj.style.width !== \"\" ) {\n\t\t\tinfo.width = obj.style.width.replace(\"px\",\"\");\n\t\t}\n\n\t\tif ( obj.style.height !== \"\" ) {\n\t\t\tinfo.height = obj.style.height.replace(\"px\",\"\");\n\t\t}\n\n\t\twhile (obj) {\n\t\t\tinfo.left += obj.offsetLeft;\n\t\t\tinfo.top += obj.offsetTop;\n\t\t\tobj = obj.offsetParent;\n\t\t}\n\n\t\treturn info;\n\t},\n\n\tClient: function(elem) {\n\t\t// constructor for new simple upload client\n\t\tthis.handlers = {};\n\n\t\t// unique ID\n\t\tthis.id = ZeroClipboard_TableTools.nextId++;\n\t\tthis.movieId = 'ZeroClipboard_TableToolsMovie_' + this.id;\n\n\t\t// register client with singleton to receive flash events\n\t\tZeroClipboard_TableTools.register(this.id, this);\n\n\t\t// create movie\n\t\tif (elem) {\n\t\t\tthis.glue(elem);\n\t\t}\n\t}\n};\n\nZeroClipboard_TableTools.Client.prototype = {\n\n\tid: 0, // unique ID for us\n\tready: false, // whether movie is ready to receive events or not\n\tmovie: null, // reference to movie object\n\tclipText: '', // text to copy to clipboard\n\tfileName: '', // default file save name\n\taction: 'copy', // action to perform\n\thandCursorEnabled: true, // whether to show hand cursor, or default pointer cursor\n\tcssEffects: true, // enable CSS mouse effects on dom container\n\thandlers: null, // user event handlers\n\tsized: false,\n\tsheetName: '', // default sheet name for excel export\n\n\tglue: function(elem, title) {\n\t\t// glue to DOM element\n\t\t// elem can be ID or actual DOM element object\n\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\n\t\t// float just above object, or zIndex 99 if dom element isn't set\n\t\tvar zIndex = 99;\n\t\tif (this.domElement.style.zIndex) {\n\t\t\tzIndex = parseInt(this.domElement.style.zIndex, 10) + 1;\n\t\t}\n\n\t\t// find X/Y position of domElement\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\n\t\t// create floating DIV above element\n\t\tthis.div = document.createElement('div');\n\t\tvar style = this.div.style;\n\t\tstyle.position = 'absolute';\n\t\tstyle.left = '0px';\n\t\tstyle.top = '0px';\n\t\tstyle.width = (box.width) + 'px';\n\t\tstyle.height = box.height + 'px';\n\t\tstyle.zIndex = zIndex;\n\n\t\tif ( typeof title != \"undefined\" && title !== \"\" ) {\n\t\t\tthis.div.title = title;\n\t\t}\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t}\n\n\t\t// style.backgroundColor = '#f00'; // debug\n\t\tif ( this.domElement ) {\n\t\t\tthis.domElement.appendChild(this.div);\n\t\t\tthis.div.innerHTML = this.getHTML( box.width, box.height ).replace(/&/g, '&amp;');\n\t\t}\n\t},\n\n\tpositionElement: function() {\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\tvar style = this.div.style;\n\n\t\tstyle.position = 'absolute';\n\t\t//style.left = (this.domElement.offsetLeft)+'px';\n\t\t//style.top = this.domElement.offsetTop+'px';\n\t\tstyle.width = box.width + 'px';\n\t\tstyle.height = box.height + 'px';\n\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tvar flash = this.div.childNodes[0];\n\t\tflash.width = box.width;\n\t\tflash.height = box.height;\n\t},\n\n\tgetHTML: function(width, height) {\n\t\t// return HTML for movie\n\t\tvar html = '';\n\t\tvar flashvars = 'id=' + this.id +\n\t\t\t'&width=' + width +\n\t\t\t'&height=' + height;\n\n\t\tif (navigator.userAgent.match(/MSIE/)) {\n\t\t\t// IE gets an OBJECT tag\n\t\t\tvar protocol = location.href.match(/^https/i) ? 'https://' : 'http://';\n\t\t\thtml += '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"'+protocol+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0\" width=\"'+width+'\" height=\"'+height+'\" id=\"'+this.movieId+'\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"'+ZeroClipboard_TableTools.moviePath+'\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"'+flashvars+'\"/><param name=\"wmode\" value=\"transparent\"/></object>';\n\t\t}\n\t\telse {\n\t\t\t// all other browsers get an EMBED tag\n\t\t\thtml += '<embed id=\"'+this.movieId+'\" src=\"'+ZeroClipboard_TableTools.moviePath+'\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"'+width+'\" height=\"'+height+'\" name=\"'+this.movieId+'\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"'+flashvars+'\" wmode=\"transparent\" />';\n\t\t}\n\t\treturn html;\n\t},\n\n\thide: function() {\n\t\t// temporarily hide floater offscreen\n\t\tif (this.div) {\n\t\t\tthis.div.style.left = '-2000px';\n\t\t}\n\t},\n\n\tshow: function() {\n\t\t// show ourselves after a call to hide()\n\t\tthis.reposition();\n\t},\n\n\tdestroy: function() {\n\t\t// destroy control and floater\n\t\tvar that = this;\n\n\t\tif (this.domElement && this.div) {\n\t\t\t$(this.div).remove();\n\n\t\t\tthis.domElement = null;\n\t\t\tthis.div = null;\n\n\t\t\t$.each( ZeroClipboard_TableTools.clients, function ( id, client ) {\n\t\t\t\tif ( client === that ) {\n\t\t\t\t\tdelete ZeroClipboard_TableTools.clients[ id ];\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t},\n\n\treposition: function(elem) {\n\t\t// reposition our floating div, optionally to new container\n\t\t// warning: container CANNOT change size, only position\n\t\tif (elem) {\n\t\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\t\t\tif (!this.domElement) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\n\t\tif (this.domElement && this.div) {\n\t\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\t\tvar style = this.div.style;\n\t\t\tstyle.left = '' + box.left + 'px';\n\t\t\tstyle.top = '' + box.top + 'px';\n\t\t}\n\t},\n\n\tclearText: function() {\n\t\t// clear the text to be copy / saved\n\t\tthis.clipText = '';\n\t\tif (this.ready) {\n\t\t\tthis.movie.clearText();\n\t\t}\n\t},\n\n\tappendText: function(newText) {\n\t\t// append text to that which is to be copied / saved\n\t\tthis.clipText += newText;\n\t\tif (this.ready) { this.movie.appendText(newText) ;}\n\t},\n\n\tsetText: function(newText) {\n\t\t// set text to be copied to be copied / saved\n\t\tthis.clipText = newText;\n\t\tif (this.ready) { this.movie.setText(newText) ;}\n\t},\n\n\tsetFileName: function(newText) {\n\t\t// set the file name\n\t\tthis.fileName = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setFileName(newText);\n\t\t}\n\t},\n\n\tsetSheetData: function(data) {\n\t\t// set the xlsx sheet data\n\t\tif (this.ready) {\n\t\t\tthis.movie.setSheetData( JSON.stringify( data ) );\n\t\t}\n\t},\n\n\tsetAction: function(newText) {\n\t\t// set action (save or copy)\n\t\tthis.action = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setAction(newText);\n\t\t}\n\t},\n\n\taddEventListener: function(eventName, func) {\n\t\t// add user event listener for event\n\t\t// event types: load, queueStart, fileStart, fileComplete, queueComplete, progress, error, cancel\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\t\tif (!this.handlers[eventName]) {\n\t\t\tthis.handlers[eventName] = [];\n\t\t}\n\t\tthis.handlers[eventName].push(func);\n\t},\n\n\tsetHandCursor: function(enabled) {\n\t\t// enable hand cursor (true), or default arrow cursor (false)\n\t\tthis.handCursorEnabled = enabled;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setHandCursor(enabled);\n\t\t}\n\t},\n\n\tsetCSSEffects: function(enabled) {\n\t\t// enable or disable CSS effects on DOM container\n\t\tthis.cssEffects = !!enabled;\n\t},\n\n\treceiveEvent: function(eventName, args) {\n\t\tvar self;\n\n\t\t// receive event from flash\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\n\t\t// special behavior for certain events\n\t\tswitch (eventName) {\n\t\t\tcase 'load':\n\t\t\t\t// movie claims it is ready, but in IE this isn't always the case...\n\t\t\t\t// bug fix: Cannot extend EMBED DOM elements in Firefox, must use traditional function\n\t\t\t\tthis.movie = document.getElementById(this.movieId);\n\t\t\t\tif (!this.movie) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 1 );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// firefox on pc needs a \"kick\" in order to set these in certain cases\n\t\t\t\tif (!this.ready && navigator.userAgent.match(/Firefox/) && navigator.userAgent.match(/Windows/)) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 100 );\n\t\t\t\t\tthis.ready = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.ready = true;\n\t\t\t\tthis.movie.clearText();\n\t\t\t\tthis.movie.appendText( this.clipText );\n\t\t\t\tthis.movie.setFileName( this.fileName );\n\t\t\t\tthis.movie.setAction( this.action );\n\t\t\t\tthis.movie.setHandCursor( this.handCursorEnabled );\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseover':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\t//this.domElement.addClass('hover');\n\t\t\t\t\tif (this.recoverActive) {\n\t\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseout':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t\tif (this.domElement.hasClass('active')) {\n\t\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\t\tthis.recoverActive = true;\n\t\t\t\t\t}\n\t\t\t\t\t//this.domElement.removeClass('hover');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mousedown':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseup':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t} // switch eventName\n\n\t\tif (this.handlers[eventName]) {\n\t\t\tfor (var idx = 0, len = this.handlers[eventName].length; idx < len; idx++) {\n\t\t\t\tvar func = this.handlers[eventName][idx];\n\n\t\t\t\tif (typeof(func) == 'function') {\n\t\t\t\t\t// actual function reference\n\t\t\t\t\tfunc(this, args);\n\t\t\t\t}\n\t\t\t\telse if ((typeof(func) == 'object') && (func.length == 2)) {\n\t\t\t\t\t// PHP style object + method, i.e. [myObject, 'myMethod']\n\t\t\t\t\tfunc[0][ func[1] ](this, args);\n\t\t\t\t}\n\t\t\t\telse if (typeof(func) == 'string') {\n\t\t\t\t\t// name of function\n\t\t\t\t\twindow[func](this, args);\n\t\t\t\t}\n\t\t\t} // foreach event handler defined\n\t\t} // user defined handler for event\n\t}\n};\n\nZeroClipboard_TableTools.hasFlash = function ()\n{\n\ttry {\n\t\tvar fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n\t\tif (fo) {\n\t\t\treturn true;\n\t\t}\n\t}\n\tcatch (e) {\n\t\tif (\n\t\t\tnavigator.mimeTypes &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'] !== undefined &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n// For the Flash binding to work, ZeroClipboard_TableTools must be on the global\n// object list\nwindow.ZeroClipboard_TableTools = ZeroClipboard_TableTools;\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Local (private) functions\n */\n\n/**\n * If a Buttons instance is initlaised before it is placed into the DOM, Flash\n * won't be able to bind to it, so we need to wait until it is available, this\n * method abstracts that out.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {jQuery} node  Button\n */\nvar _glue = function ( flash, node )\n{\n\tvar id = node.attr('id');\n\n\tif ( node.parents('html').length ) {\n\t\tflash.glue( node[0], '' );\n\t}\n\telse {\n\t\tsetTimeout( function () {\n\t\t\t_glue( flash, node );\n\t\t}, 500 );\n\t}\n};\n\n/**\n * Get the file name for an exported file.\n *\n * @param {object}  config       Button configuration\n * @param {boolean} incExtension Include the file name extension\n */\nvar _filename = function ( config, incExtension )\n{\n\t// Backwards compatibility\n\tvar filename = config.filename === '*' && config.title !== '*' && config.title !== undefined ?\n\t\tconfig.title :\n\t\tconfig.filename;\n\n\tif ( typeof filename === 'function' ) {\n\t\tfilename = filename();\n\t}\n\n\tif ( filename.indexOf( '*' ) !== -1 ) {\n\t\tfilename = $.trim( filename.replace( '*', $('title').text() ) );\n\t}\n\n\t// Strip characters which the OS will object to\n\tfilename = filename.replace(/[^a-zA-Z0-9_\\u00A1-\\uFFFF\\.,\\-_ !\\(\\)]/g, \"\");\n\n\treturn incExtension === undefined || incExtension === true ?\n\t\tfilename+config.extension :\n\t\tfilename;\n};\n\n/**\n * Get the sheet name for Excel exports.\n *\n * @param {object}  config       Button configuration\n */\nvar _sheetname = function ( config )\n{\n\tvar sheetName = 'Sheet1';\n\n\tif ( config.sheetName ) {\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n\t}\n\n\treturn sheetName;\n};\n\n/**\n * Get the title for an exported file.\n *\n * @param {object}  config  Button configuration\n */\nvar _title = function ( config )\n{\n\tvar title = config.title;\n\n\tif ( typeof title === 'function' ) {\n\t\ttitle = title();\n\t}\n\n\treturn title.indexOf( '*' ) !== -1 ?\n\t\ttitle.replace( '*', $('title').text() || 'Exported data' ) :\n\t\ttitle;\n};\n\n/**\n * Set the flash text. This has to be broken up into chunks as the Javascript /\n * Flash bridge has a size limit. There is no indication in the Flash\n * documentation what this is, and it probably depends upon the browser.\n * Experimentation shows that the point is around 50k when data starts to get\n * lost, so an 8K limit used here is safe.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {string}        data  Data to send to Flash\n */\nvar _setText = function ( flash, data )\n{\n\tvar parts = data.match(/[\\s\\S]{1,8192}/g) || [];\n\n\tflash.clearText();\n\tfor ( var i=0, len=parts.length ; i<len ; i++ )\n\t{\n\t\tflash.appendText( parts[i] );\n\t}\n};\n\n/**\n * Get the newline character(s)\n *\n * @param {object}  config Button configuration\n * @return {string}        Newline character\n */\nvar _newLine = function ( config )\n{\n\treturn config.newline ?\n\t\tconfig.newline :\n\t\tnavigator.userAgent.match(/Windows/) ?\n\t\t\t'\\r\\n' :\n\t\t\t'\\n';\n};\n\n/**\n * Combine the data from the `buttons.exportData` method into a string that\n * will be used in the export file.\n *\n * @param  {DataTable.Api} dt     DataTables API instance\n * @param  {object}        config Button configuration\n * @return {object}               The data to export\n */\nvar _exportData = function ( dt, config )\n{\n\tvar newLine = _newLine( config );\n\tvar data = dt.buttons.exportData( config.exportOptions );\n\tvar boundary = config.fieldBoundary;\n\tvar separator = config.fieldSeparator;\n\tvar reBoundary = new RegExp( boundary, 'g' );\n\tvar escapeChar = config.escapeChar !== undefined ?\n\t\tconfig.escapeChar :\n\t\t'\\\\';\n\tvar join = function ( a ) {\n\t\tvar s = '';\n\n\t\t// If there is a field boundary, then we might need to escape it in\n\t\t// the source data\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\n\t\t\tif ( i > 0 ) {\n\t\t\t\ts += separator;\n\t\t\t}\n\n\t\t\ts += boundary ?\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\n\t\t\t\ta[i];\n\t\t}\n\n\t\treturn s;\n\t};\n\n\tvar header = config.header ? join( data.header )+newLine : '';\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\n\tvar body = [];\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tbody.push( join( data.body[i] ) );\n\t}\n\n\treturn {\n\t\tstr: header + body.join( newLine ) + footer,\n\t\trows: body.length\n\t};\n};\n\n\n// Basic initialisation for the buttons is common between them\nvar flashButton = {\n\tavailable: function () {\n\t\treturn ZeroClipboard_TableTools.hasFlash();\n\t},\n\n\tinit: function ( dt, button, config ) {\n\t\t// Insert the Flash movie\n\t\tZeroClipboard_TableTools.moviePath = DataTable.Buttons.swfPath;\n\t\tvar flash = new ZeroClipboard_TableTools.Client();\n\n\t\tflash.setHandCursor( true );\n\t\tflash.addEventListener('mouseDown', function(client) {\n\t\t\tconfig._fromFlash = true;\n\t\t\tdt.button( button[0] ).trigger();\n\t\t\tconfig._fromFlash = false;\n\t\t} );\n\n\t\t_glue( flash, button );\n\n\t\tconfig._flash = flash;\n\t},\n\n\tdestroy: function ( dt, button, config ) {\n\t\tconfig._flash.destroy();\n\t},\n\n\tfieldSeparator: ',',\n\n\tfieldBoundary: '\"',\n\n\texportOptions: {},\n\n\ttitle: '*',\n\n\tfilename: '*',\n\n\textension: '.csv',\n\n\theader: true,\n\n\tfooter: false\n};\n\n\n/**\n * Convert from numeric position to letter for column names in Excel\n * @param  {int} n Column number\n * @return {string} Column letter(s) name\n */\nfunction createCellPos( n ){\n\tvar ordA = 'A'.charCodeAt(0);\n\tvar ordZ = 'Z'.charCodeAt(0);\n\tvar len = ordZ - ordA + 1;\n\tvar s = \"\";\n\n\twhile( n >= 0 ) {\n\t\ts = String.fromCharCode(n % len + ordA) + s;\n\t\tn = Math.floor(n / len) - 1;\n\t}\n\n\treturn s;\n}\n\n/**\n * Create an XML node and add any children, attributes, etc without needing to\n * be verbose in the DOM.\n *\n * @param  {object} doc      XML document\n * @param  {string} nodeName Node name\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\n *   (child nodes) and `text` (text content)\n * @return {node}            Created node\n */\nfunction _createNode( doc, nodeName, opts ){\n\tvar tempNode = doc.createElement( nodeName );\n\n\tif ( opts ) {\n\t\tif ( opts.attr ) {\n\t\t\t$(tempNode).attr( opts.attr );\n\t\t}\n\n\t\tif( opts.children ) {\n\t\t\t$.each( opts.children, function ( key, value ) {\n\t\t\t\ttempNode.appendChild( value );\n\t\t\t});\n\t\t}\n\n\t\tif( opts.text ) {\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\n\t\t}\n\t}\n\n\treturn tempNode;\n}\n\n/**\n * Get the width for an Excel column based on the contents of that column\n * @param  {object} data Data for export\n * @param  {int}    col  Column index\n * @return {int}         Column width\n */\nfunction _excelColWidth( data, col ) {\n\tvar max = data.header[col].length;\n\tvar len, lineSplit, str;\n\n\tif ( data.footer && data.footer[col].length > max ) {\n\t\tmax = data.footer[col].length;\n\t}\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tvar point = data.body[i][col];\n\t\tstr = point !== null && point !== undefined ?\n\t\t\tpoint.toString() :\n\t\t\t'';\n\n\t\t// If there is a newline character, workout the width of the column\n\t\t// based on the longest line in the string\n\t\tif ( str.indexOf('\\n') !== -1 ) {\n\t\t\tlineSplit = str.split('\\n');\n\t\t\tlineSplit.sort( function (a, b) {\n\t\t\t\treturn b.length - a.length;\n\t\t\t} );\n\n\t\t\tlen = lineSplit[0].length;\n\t\t}\n\t\telse {\n\t\t\tlen = str.length;\n\t\t}\n\n\t\tif ( len > max ) {\n\t\t\tmax = len;\n\t\t}\n\n\t\t// Max width rather than having potentially massive column widths\n\t\tif ( max > 40 ) {\n\t\t\treturn 52; // 40 * 1.3\n\t\t}\n\t}\n\n\tmax *= 1.3;\n\n\t// And a min width\n\treturn max > 6 ? max : 6;\n}\n\n  var _serialiser = \"\";\n    if (typeof window.XMLSerializer === 'undefined') {\n        _serialiser = new function () {\n            this.serializeToString = function (input) {\n                return input.xml\n            }\n        };\n    } else {\n        _serialiser =  new XMLSerializer();\n    }\n\n    var _ieExcel;\n\n\n/**\n * Convert XML documents in an object to strings\n * @param  {object} obj XLSX document object\n */\nfunction _xlsxToStrings( obj ) {\n\tif ( _ieExcel === undefined ) {\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n\t\t// drop attributes\n\t\t_ieExcel = _serialiser\n\t\t\t.serializeToString(\n\t\t\t\t$.parseXML( excelStrings['xl/worksheets/sheet1.xml'] )\n\t\t\t)\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\n\t}\n\n\t$.each( obj, function ( name, val ) {\n\t\tif ( $.isPlainObject( val ) ) {\n\t\t\t_xlsxToStrings( val );\n\t\t}\n\t\telse {\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\n\t\t\t\t// from the root node, so we need to save them. Do this by\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\n\t\t\t\t// we convert back when serialised. Edge does not have this\n\t\t\t\t// issue\n\t\t\t\tvar worksheet = val.childNodes[0];\n\t\t\t\tvar i, ien;\n\t\t\t\tvar attrs = [];\n\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\n\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\n\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\n\t\t\t\t\tattr.value = attrs[i].value;\n\t\t\t\t\tworksheet.setAttributeNode( attr );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar str = _serialiser.serializeToString(val);\n\n\t\t\t// Fix IE's XML\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE doesn't include the XML declaration\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\n\t\t\t\t}\n\n\t\t\t\t// Return namespace attributes to being as such\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\n\t\t\t}\n\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\n\t\t\t// various elements making them useless. This strips them out\n\t\t\tstr = str.replace( /<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>' );\n\n\t\t\tobj[ name ] = str;\n\t\t}\n\t} );\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n\t\"_rels/.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"xl/_rels/workbook.xml.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"[Content_Types].xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\n\t\t'</Types>',\n\n\t\"xl/workbook.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\n\t\t\t'<bookViews>'+\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\n\t\t\t'</bookViews>'+\n\t\t\t'<sheets>'+\n\t\t\t\t'<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>'+\n\t\t\t'</sheets>'+\n\t\t'</workbook>',\n\n\t\"xl/worksheets/sheet1.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<sheetData/>'+\n\t\t'</worksheet>',\n\n\t\"xl/styles.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<numFmts count=\"6\">'+\n\t\t\t\t'<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>'+\n\t\t\t'</numFmts>'+\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<b />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<i />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<u />'+\n\t\t\t\t'</font>'+\n\t\t\t'</fonts>'+\n\t\t\t'<fills count=\"6\">'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill/>'+ // Excel appears to use this as a dotted background regardless of values\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t'</fills>'+\n\t\t\t'<borders count=\"2\">'+\n\t\t\t\t'<border>'+\n\t\t\t\t\t'<left />'+\n\t\t\t\t\t'<right />'+\n\t\t\t\t\t'<top />'+\n\t\t\t\t\t'<bottom />'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\n\t\t\t\t\t'<left style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</left>'+\n\t\t\t\t\t'<right style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</right>'+\n\t\t\t\t\t'<top style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</top>'+\n\t\t\t\t\t'<bottom style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</bottom>'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t'</borders>'+\n\t\t\t'<cellStyleXfs count=\"1\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\n\t\t\t'</cellStyleXfs>'+\n\t\t\t'<cellXfs count=\"61\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t'</cellXfs>'+\n\t\t\t'<cellStyles count=\"1\">'+\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\n\t\t\t'</cellStyles>'+\n\t\t\t'<dxfs count=\"0\" />'+\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\n\t\t'</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n// Pattern matching for special number formats. Perhaps this should be exposed\n// via an API in future?\nvar _excelSpecials = [\n\t{ match: /^\\-?\\d+\\.\\d%$/,       style: 60, fmt: function (d) { return d/100; } }, // Precent with d.p.\n\t{ match: /^\\-?\\d+\\.?\\d*%$/,     style: 56, fmt: function (d) { return d/100; } }, // Percent\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/,  style: 57 }, // Dollars\n\t{ match: /^\\-?£[\\d,]+.?\\d*$/,   style: 58 }, // Pounds\n\t{ match: /^\\-?€[\\d,]+.?\\d*$/,   style: 59 }, // Euros\n\t{ match: /^\\([\\d,]+\\)$/,        style: 61, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets\n\t{ match: /^\\([\\d,]+\\.\\d{2}\\)$/, style: 62, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets - 2d.p.\n\t{ match: /^[\\d,]+$/,            style: 63 }, // Numbers with thousand separators\n\t{ match: /^[\\d,]+\\.\\d{2}$/,     style: 64 }  // Numbers with 2d.p. and thousands separators\n];\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * DataTables options and methods\n */\n\n// Set the default SWF path\nDataTable.Buttons.swfPath = '//cdn.datatables.net/buttons/1.2.4/swf/flashExport.swf';\n\n// Method to allow Flash buttons to be resized when made visible - as they are\n// of zero height and width if initialised hidden\nDataTable.Api.register( 'buttons.resize()', function () {\n\t$.each( ZeroClipboard_TableTools.clients, function ( i, client ) {\n\t\tif ( client.domElement !== undefined && client.domElement.parentNode ) {\n\t\t\tclient.positionElement();\n\t\t}\n\t} );\n} );\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Button definitions\n */\n\n// Copy to clipboard\nDataTable.ext.buttons.copyFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-copy buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Check that the trigger did actually occur due to a Flash activation\n\t\tif ( ! config._fromFlash ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar data = _exportData( dt, config );\n\t\tvar output = config.customize ?\n\t\t\tconfig.customize( data.str, config ) :\n\t\t\tdata.str;\n\n\t\tflash.setAction( 'copy' );\n\t\t_setText( flash, output );\n\n\t\tthis.processing( false );\n\n\t\tdt.buttons.info(\n\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\n\t\t\tdt.i18n( 'buttons.copySuccess', {\n\t\t\t\t_: 'Copied %d rows to clipboard',\n\t\t\t\t1: 'Copied 1 row to clipboard'\n\t\t\t}, data.rows ),\n\t\t\t3000\n\t\t);\n\t},\n\n\tfieldSeparator: '\\t',\n\n\tfieldBoundary: ''\n} );\n\n// CSV save file\nDataTable.ext.buttons.csvFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-csv buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = _exportData( dt, config );\n\t\tvar output = config.customize ?\n\t\t\tconfig.customize( data.str, config ) :\n\t\t\tdata.str;\n\n\t\tflash.setAction( 'csv' );\n\t\tflash.setFileName( _filename( config ) );\n\t\t_setText( flash, output );\n\t},\n\n\tescapeChar: '\"'\n} );\n\n// Excel save file - this is really a CSV file using UTF-8 that Excel can read\nDataTable.ext.buttons.excelFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-excel buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar rowPos = 0;\n\t\tvar rels = $.parseXML( excelStrings['xl/worksheets/sheet1.xml'] ) ; //Parses xml\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\n\n\t\tvar xlsx = {\n\t\t\t_rels: {\n\t\t\t\t\".rels\": $.parseXML( excelStrings['_rels/.rels'] )\n\t\t\t},\n\t\t\txl: {\n\t\t\t\t_rels: {\n\t\t\t\t\t\"workbook.xml.rels\": $.parseXML( excelStrings['xl/_rels/workbook.xml.rels'] )\n\t\t\t\t},\n\t\t\t\t\"workbook.xml\": $.parseXML( excelStrings['xl/workbook.xml'] ),\n\t\t\t\t\"styles.xml\": $.parseXML( excelStrings['xl/styles.xml'] ),\n\t\t\t\t\"worksheets\": {\n\t\t\t\t\t\"sheet1.xml\": rels\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"[Content_Types].xml\": $.parseXML( excelStrings['[Content_Types].xml'])\n\t\t};\n\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar currentRow, rowNode;\n\t\tvar addRow = function ( row ) {\n\t\t\tcurrentRow = rowPos+1;\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\n\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\n\t\t\t\tvar cell = null;\n\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\n\t\t\t\tif ( row[i] === null || row[i] === undefined || row[i] === '' ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\trow[i] = $.trim( row[i] );\n\n\t\t\t\t// Special number formatting options\n\t\t\t\tfor ( var j=0, jen=_excelSpecials.length ; j<jen ; j++ ) {\n\t\t\t\t\tvar special = _excelSpecials[j];\n\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\n\t\t\t\t\t// if they are returning a string, since at the moment it is\n\t\t\t\t\t// assumed to be a number\n\t\t\t\t\tif ( row[i].match && ! row[i].match(/^0\\d+/) && row[i].match( special.match ) ) {\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n\t\t\t\t\t\tif ( special.fmt ) {\n\t\t\t\t\t\t\tval = special.fmt( val );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tr: cellId,\n\t\t\t\t\t\t\t\ts: special.style\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: val } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( ! cell ) {\n\t\t\t\t\tif ( typeof row[i] === 'number' || (\n\t\t\t\t\t\trow[i].match &&\n\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?$/) &&\n\t\t\t\t\t\t! row[i].match(/^0\\d+/) )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\n\t\t\t\t\t\t// or a negative anywhere but the start\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'n',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// String output - replace non standard characters for text output\n\t\t\t\t\t\tvar text = ! row[i].replace ?\n\t\t\t\t\t\t\trow[i] :\n\t\t\t\t\t\t\trow[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'inlineStr',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren:{\n\t\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\n\t\t\t\t\t\t\t\t\tchildren: {\n\t\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\n\t\t\t\t\t\t\t\t\t\t\ttext: text\n\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowNode.appendChild( cell );\n\t\t\t}\n\n\t\t\trelsGet.appendChild(rowNode);\n\t\t\trowPos++;\n\t\t};\n\n\t\t$( 'sheets sheet', xlsx.xl['workbook.xml'] ).attr( 'name', _sheetname( config ) );\n\n\t\tif ( config.customizeData ) {\n\t\t\tconfig.customizeData( data );\n\t\t}\n\n\t\tif ( config.header ) {\n\t\t\taddRow( data.header, rowPos );\n\t\t\t$('row c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\n\t\t\taddRow( data.body[n], rowPos );\n\t\t}\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\taddRow( data.footer, rowPos);\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\t// Set column widths\n\t\tvar cols = _createNode( rels, 'cols' );\n\t\t$('worksheet', rels).prepend( cols );\n\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\n\t\t\t\tattr: {\n\t\t\t\t\tmin: i+1,\n\t\t\t\t\tmax: i+1,\n\t\t\t\t\twidth: _excelColWidth( data, i ),\n\t\t\t\t\tcustomWidth: 1\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\t// Let the developer customise the document if they want to\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( xlsx );\n\t\t}\n\n\t\t_xlsxToStrings( xlsx );\n\n\t\tflash.setAction( 'excel' );\n\t\tflash.setFileName( _filename( config ) );\n\t\tflash.setSheetData( xlsx );\n\t\t_setText( flash, '' );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.xlsx'\n} );\n\n\n\n// PDF export\nDataTable.ext.buttons.pdfFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-pdf buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar totalWidth = dt.table().node().offsetWidth;\n\n\t\t// Calculate the column width ratios for layout of the table in the PDF\n\t\tvar ratios = dt.columns( config.columns ).indexes().map( function ( idx ) {\n\t\t\treturn dt.column( idx ).header().offsetWidth / totalWidth;\n\t\t} );\n\n\t\tflash.setAction( 'pdf' );\n\t\tflash.setFileName( _filename( config ) );\n\n\t\t_setText( flash, JSON.stringify( {\n\t\t\ttitle:       _filename(config, false),\n\t\t\tmessage: typeof config.message == 'function' ? config.message(dt, button, config) : config.message,\n\t\t\tcolWidth:    ratios.toArray(),\n\t\t\torientation: config.orientation,\n\t\t\tsize:        config.pageSize,\n\t\t\theader:      config.header ? data.header : null,\n\t\t\tfooter:      config.footer ? data.footer : null,\n\t\t\tbody:        data.body\n\t\t} ) );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.pdf',\n\n\torientation: 'portrait',\n\n\tpageSize: 'A4',\n\n\tmessage: '',\n\n\tnewline: '\\n'\n} );\n\n\nreturn DataTable.Buttons;\n}));\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}